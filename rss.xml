<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[Merricx personal blog RSS Feed]]></title><description><![CDATA[My personal blog]]></description><link>https://merricx.github.io</link><generator>GatsbyJS</generator><lastBuildDate>Sun, 03 Mar 2024 00:11:51 GMT</lastBuildDate><item><title><![CDATA[The Adventure of Attacking AES]]></title><description><![CDATA[How to practically break reduced-round AES from 1 round until 3 round]]></description><link>https://merricx.github.io/adventure-of-aes/</link><guid isPermaLink="false">https://merricx.github.io/adventure-of-aes/</guid><pubDate>Sun, 16 Apr 2023 16:58:00 GMT</pubDate><content:encoded>&lt;p&gt;In this article, I want to share my personal learning journey and experience on how I practiced to do cryptanalysis on reduced round AES step by step from the easiest one which is 1-round AES until 3-round AES. &lt;/p&gt;
&lt;p&gt;The attack that we will described here just mainly focus on the differential cryptanalysis of AES S-Box. According to the AES proposal &lt;sup&gt;&lt;a href=&quot;#references&quot;&gt;[1]&lt;/a&gt;&lt;/sup&gt;, it is claimed that AES is resistant against differential cryptanalysis above 4-round. So, how about round below it? Lets find out!&lt;/p&gt;
&lt;h1 id=&quot;preliminaries&quot;&gt;&lt;a href=&quot;#preliminaries&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Preliminaries&lt;/h1&gt;
&lt;p&gt;Before we dive into the attack, it’s good idea to refresh our reference on short preliminaries about AES operations and basic of the attack that we gonna use.&lt;/p&gt;
&lt;h2 id=&quot;aes&quot;&gt;&lt;a href=&quot;#aes&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;AES&lt;/h2&gt;
&lt;p&gt;Advanced Encryption Standard (AES) is the algorithm that was selected by NIST that originally named Rijndael. AES use &lt;em&gt;Substitution-Permutation Network&lt;/em&gt; (SPN) as its main design. &lt;/p&gt;
&lt;p&gt;AES is 128-bit block cipher which its state represented as byte matrix of size 4x4. It consist of 4 main operations in single round which are &lt;code class=&quot;language-text&quot;&gt;SubBytes&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;ShiftRows&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;MixColumns&lt;/code&gt;, and &lt;code class=&quot;language-text&quot;&gt;AddRoundKey&lt;/code&gt;. &lt;/p&gt;
&lt;p&gt;The number of rounds used in AES depends on the key size, where 128-bit use 10 rounds, 192-bit use 12 rounds, and 256-bit use 14 rounds. In the first round, an additional &lt;code class=&quot;language-text&quot;&gt;AddRoundKey&lt;/code&gt; is used, and in the last round, &lt;code class=&quot;language-text&quot;&gt;MixColumns&lt;/code&gt; operation is omitted.&lt;/p&gt;
&lt;p&gt;This is how AES encryption works in nutshell:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;AES&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;plaintext&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; master_key&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; n_rounds&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;

    round_key &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; key_schedule&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;master_key&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    state &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; add_round_key&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;plaintext&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; round_key&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; i &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; n_rounds&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        state &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; sub_bytes&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;state&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        state &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; shift_rows&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;state&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        state &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; mix_columns&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;state&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        state &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; add_round_key&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;state&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; round_key&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;i&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;# last round without MixColumns&lt;/span&gt;
    state &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; sub_bytes&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;state&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    state &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; shift_rows&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;state&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    state &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; add_round_key&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;state&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; round_key&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;n_rounds&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; state&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;subbytes&quot;&gt;&lt;a href=&quot;#subbytes&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;SubBytes&lt;/h3&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;SubBytes&lt;/code&gt; will apply substitution mapping on each byte of the state against S-Box. This operation is the only operation in AES that is not linear.&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;https://merricx.github.io/static/db12ff41e9da9ba552916974fcb5ed3f/34e70/subbytes.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 33.108108108108105%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABEElEQVR42n1R2W6DQAzk//8rfeoDNIQzBZblEDci4SVKmO44ouqlWhqtd+0Z22urCkOUZQmV56iqSvx1XUHbtu0T+53W9RO8sESmCmj95GmtMU0TrPxwgEpTxOcz0iQRwXmefwl+FVa6xcurhusZTvpukCIx3GEYYL3ZNqIowul0guM44nddh7/s8Xg8OzTxwEwWxzGUUiJGUenQdV2EJng2HQZBAM/zUBQFlmWRTq/Xq5xMJinLMpmChcnxfV/45HFs63g8SgUmMoHn3uH9fpeudtxuN3mv61o4FCXoU5TvFitQiNiDTdN8W8JPY5x55HJswjZfJ4J938tn7svgaJfL5d+ljOMoohQgyGnbVs4PLAQLv4DQ5Y0AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;subbytes&quot;
        title=&quot;&quot;
        src=&quot;https://merricx.github.io/static/db12ff41e9da9ba552916974fcb5ed3f/fcda8/subbytes.png&quot;
        srcset=&quot;https://merricx.github.io/static/db12ff41e9da9ba552916974fcb5ed3f/12f09/subbytes.png 148w,https://merricx.github.io/static/db12ff41e9da9ba552916974fcb5ed3f/e4a3f/subbytes.png 295w,https://merricx.github.io/static/db12ff41e9da9ba552916974fcb5ed3f/fcda8/subbytes.png 590w,https://merricx.github.io/static/db12ff41e9da9ba552916974fcb5ed3f/efc66/subbytes.png 885w,https://merricx.github.io/static/db12ff41e9da9ba552916974fcb5ed3f/34e70/subbytes.png 1053w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;h3 id=&quot;shiftrows&quot;&gt;&lt;a href=&quot;#shiftrows&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;ShiftRows&lt;/h3&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;ShiftRows&lt;/code&gt; is the operation that will shift byte position each row to the left depending on the row. Second row will be shifted 1 to the left, third row shifted 2 to the left, and fourth row shifted 3 to the left (first row stay the same).&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;https://merricx.github.io/static/ba452bab160938260c333bedeea4b8ce/34e70/shiftrows.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 33.108108108108105%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABNklEQVR42n1RaWvCQBDN//9Jban0wBa1SKwJSfZI1lzmTj2+iPq6OxLpRQeGnZ3jzXuM5bEMaZpitVLIsku83+9h7Hw+X334G6vqDq6fIlIJ4nhFc0kSo+87WM8ThTBU4IxBypAA+77/BfgVWMUlxrMYS5cjlILmhJCo6wbW7chGEARwHAe2fYmrqsJfdjqdLgx13fd9ME1CqQgqkhhPJQLZwroZLanIOYfneXBdV9NPsNlsiOlut6O36zqtJEQURaTCLBaCYfHuYfLGMJtzcJkahgsIKanRgJp3YHg8HonV4IfDgfJ5npNExgLM7QCPLwKMSzR1CevuwSEg42ar1OBFUXw7wk8ry4L67p9cvE41U85IWVlWsAJZoWma6zGMtO12++9R2ralpR7LtcwMH/q66/Wa8p+LPQnLA7oQ2QAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;shiftrows&quot;
        title=&quot;&quot;
        src=&quot;https://merricx.github.io/static/ba452bab160938260c333bedeea4b8ce/fcda8/shiftrows.png&quot;
        srcset=&quot;https://merricx.github.io/static/ba452bab160938260c333bedeea4b8ce/12f09/shiftrows.png 148w,https://merricx.github.io/static/ba452bab160938260c333bedeea4b8ce/e4a3f/shiftrows.png 295w,https://merricx.github.io/static/ba452bab160938260c333bedeea4b8ce/fcda8/shiftrows.png 590w,https://merricx.github.io/static/ba452bab160938260c333bedeea4b8ce/efc66/shiftrows.png 885w,https://merricx.github.io/static/ba452bab160938260c333bedeea4b8ce/34e70/shiftrows.png 1053w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;h3 id=&quot;mixcolumns&quot;&gt;&lt;a href=&quot;#mixcolumns&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;MixColumns&lt;/h3&gt;
&lt;p&gt;The third operation which is &lt;code class=&quot;language-text&quot;&gt;MixColumns&lt;/code&gt; will transform all bytes in the same column by multiply them with the constant 4x4 Matrix over the field $GF(2^8)$.&lt;/p&gt;
$$
\begin{bmatrix}
2 &amp;3 &amp;1 &amp;1\\
1 &amp;2 &amp;3 &amp;1\\
1 &amp;1 &amp;2 &amp;3\\
3 &amp;1 &amp;1 &amp;2
\end{bmatrix}
\begin{bmatrix}
a0\\
a1\\
a2\\
a3
\end{bmatrix}
=
\begin{bmatrix}
b0\\
b1\\
b2\\
b3
\end{bmatrix}
$$
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;https://merricx.github.io/static/90437da687b0642041d3b8804ee9459f/34e70/mixcolumns.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 33.108108108108105%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABJUlEQVR42m2R3W6CQBCFef/XEdA2aWqbtvdQBAQK+ANFDUhUbgxwumeaNWnqJJNhlz3fntkxFn6AoiiwXq9RlqV8d10HxjiOt9RrRl038BY+8nyFzWYjOtbj8Qjj6XmOfLVCHMdI00yAbdv+AzKHYZD9OElgT2cIl0ulSZFlmdS6rmG8vX8gUQc8z4PjOIiiCIfDAfdCA1MFmL+8Koe5JIFMccibCCE0DEP4vo/tdovT6SROL5eLVB6mCz5NpLqZmLbogiAQHfVs3ZiYltB5EzdZtcO+78WVzuv1+utQPc3s4RGBAhGq297v9zAseyobhOmfu93uzxB06HWSfMG0bDiuKzq+PzujEYNTbprmNgy2dj6f7w5FA8vyG+6nJ5qqqkTDSs4P6BUHS4QAkesAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;mixcolumns&quot;
        title=&quot;&quot;
        src=&quot;https://merricx.github.io/static/90437da687b0642041d3b8804ee9459f/fcda8/mixcolumns.png&quot;
        srcset=&quot;https://merricx.github.io/static/90437da687b0642041d3b8804ee9459f/12f09/mixcolumns.png 148w,https://merricx.github.io/static/90437da687b0642041d3b8804ee9459f/e4a3f/mixcolumns.png 295w,https://merricx.github.io/static/90437da687b0642041d3b8804ee9459f/fcda8/mixcolumns.png 590w,https://merricx.github.io/static/90437da687b0642041d3b8804ee9459f/efc66/mixcolumns.png 885w,https://merricx.github.io/static/90437da687b0642041d3b8804ee9459f/34e70/mixcolumns.png 1053w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;NOTE&lt;/strong&gt;: we can treat this operation as black box function that transform 4-byte input into another 4-byte output.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;addroundkey&quot;&gt;&lt;a href=&quot;#addroundkey&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;AddRoundKey&lt;/h3&gt;
&lt;p&gt;The last operation is &lt;code class=&quot;language-text&quot;&gt;AddRoundKey&lt;/code&gt; which simply XOR the state with the &lt;code class=&quot;language-text&quot;&gt;RoundKey&lt;/code&gt;. &lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;https://merricx.github.io/static/3ba8192fe1d16a4d4a37008151a31ff6/82c1e/addroundkey.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 53.37837837837838%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABWUlEQVR42p1SXW+DMAzM//81e93btMdpmqYBCpQA5XNQtYBoS8toucWuMqFu1aRaOpGE+Hw+R7y8F4giBaUCFEWB0+kEimmaGCbM3pwNX0e8qUf4kYNlFCMMAzRNA/H2QRsF27aRpinO5zPmcTgcGNdxHI54dZ4QZ6EWtEQQBGjbFkIpD4kmklJqlQrb7Zax3+8ZcRzD8zw+67qOUZYlYxklKPICvu9r0gjr9RrC0srCMGSFi8UCwzCwStM6tVFVFa/HcWTQv77vIV3JOY7jMFarFQRdJu+yLONEQ2SCCHa73a+WqTCpN7m0rusaYm723HRSOY4XJdQuFTL+/pVjIK4rT9MlqW9TlPIBVfmpqyfItM9mOPPpX8dNhV1TwbeekSSxRsKm05DuUHgh3GxqONJn04mQXsCc8KbCW4Q0Mduyfp6T67rs5d2E9N5ognmea7Ub/tKA/iP8BnlOTcrsxjw+AAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;addroundkey&quot;
        title=&quot;&quot;
        src=&quot;https://merricx.github.io/static/3ba8192fe1d16a4d4a37008151a31ff6/fcda8/addroundkey.png&quot;
        srcset=&quot;https://merricx.github.io/static/3ba8192fe1d16a4d4a37008151a31ff6/12f09/addroundkey.png 148w,https://merricx.github.io/static/3ba8192fe1d16a4d4a37008151a31ff6/e4a3f/addroundkey.png 295w,https://merricx.github.io/static/3ba8192fe1d16a4d4a37008151a31ff6/fcda8/addroundkey.png 590w,https://merricx.github.io/static/3ba8192fe1d16a4d4a37008151a31ff6/efc66/addroundkey.png 885w,https://merricx.github.io/static/3ba8192fe1d16a4d4a37008151a31ff6/c83ae/addroundkey.png 1180w,https://merricx.github.io/static/3ba8192fe1d16a4d4a37008151a31ff6/82c1e/addroundkey.png 1398w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;RoundKey&lt;/code&gt; is the subkey that expanded from &lt;code class=&quot;language-text&quot;&gt;MasterKey&lt;/code&gt; using the Key Schedule function, so it will generate different &lt;code class=&quot;language-text&quot;&gt;RoundKey&lt;/code&gt; on each round of AES. &lt;/p&gt;
&lt;p&gt;We can ignore how the Key Schedule function works since this is irrelevant with our attack. The only thing we must remember here is with any known &lt;code class=&quot;language-text&quot;&gt;RoundKey&lt;/code&gt;, we can recover its &lt;code class=&quot;language-text&quot;&gt;MasterKey&lt;/code&gt; since Key Schedule function is invertible.&lt;/p&gt;
&lt;h2 id=&quot;differential-cryptanalysis&quot;&gt;&lt;a href=&quot;#differential-cryptanalysis&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Differential Cryptanalysis&lt;/h2&gt;
&lt;p&gt;Differential Cryptanalysis is one of the most powerful method to attack block cipher and together with the Linear Cryptanalysis become two &lt;em&gt;de facto&lt;/em&gt; standard of cryptanalysis against block cipher.&lt;/p&gt;
&lt;p&gt;Differential cryptanalysis usually uses bitwise XOR to define the “difference”. XOR operation is very useful given the fact that it can “bypass” or skip linear operation on block cipher.&lt;/p&gt;
&lt;p&gt;In the context of AES, assume we have the following equation:&lt;/p&gt;
$$
c_1 = ARK(MC(SR(p_1))) \\
c_2 = ARK(MC(SR(p_2))) \\
$$
&lt;p&gt;where $ARK$, $MC$, and $SR$ denote &lt;code class=&quot;language-text&quot;&gt;AddRoundKey&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;MixColumns&lt;/code&gt;, and &lt;code class=&quot;language-text&quot;&gt;ShifRows&lt;/code&gt; operation respectively. &lt;/p&gt;
&lt;p&gt;Then, lets assume differential of two plaintext and ciphertext is XOR between these pair that denoted by $p_1 \oplus p_2$ and $c_1 \oplus c_2$ respectively, then the equation become:&lt;/p&gt;
$$
c_1 \oplus c_2 = ARK(MC(SR(p_1 \oplus p_2)))
$$
&lt;p&gt;Since $ARK$ is just XOR state with the &lt;code class=&quot;language-text&quot;&gt;RoundKey&lt;/code&gt; and both of $p_1$ and $p_2$ XORed with the same &lt;code class=&quot;language-text&quot;&gt;RoundKey&lt;/code&gt;, we can simplify the equation by removing $ARK$ at all.&lt;/p&gt;
$$
\begin{equation}
\begin{aligned}
c_1 &amp; = MC(SR(p_1)) \oplus RoundKey \\
c_2 &amp; = MC(SR(p_2)) \oplus RoundKey \\
c_1 \oplus c_2 &amp; = MC(SR(p_1 \oplus p_2)) \oplus RoundKey \oplus RoundKey \\
c_1 \oplus c_2 &amp; = MC(SR(p_1 \oplus p_2))
\end{aligned}
\end{equation}
$$
&lt;p&gt;And that’s it, we basically already bypass all linear operation even without the knowledge of &lt;code class=&quot;language-text&quot;&gt;RoundKey&lt;/code&gt;. &lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Imagine AES without &lt;code class=&quot;language-text&quot;&gt;SubBytes&lt;/code&gt; operation, then if you know &lt;code class=&quot;language-text&quot;&gt;c1&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;c2&lt;/code&gt;, and &lt;code class=&quot;language-text&quot;&gt;p1&lt;/code&gt;, it is become trivial to recover &lt;code class=&quot;language-text&quot;&gt;p2&lt;/code&gt;, just like what happen in simple XOR cipher.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;This way, we only need to focus on one operation that is non-linear which is &lt;code class=&quot;language-text&quot;&gt;SubBytes&lt;/code&gt;. &lt;/p&gt;
&lt;p&gt;Consider $(x, y)$ for every possible byte values. Then, let $\alpha = x \oplus y$ and $\beta = SB(x) \oplus SB(y)$ where $SB$ denotes &lt;code class=&quot;language-text&quot;&gt;SubBytes&lt;/code&gt; operation. We are trying to analyze how many times $\alpha$ and $\beta$ hold.&lt;/p&gt;
&lt;p&gt;For example, let $\alpha = 8$ and $\beta = 125$. Over all 256 possible bytes, there are two possible byte pair $(x, y)$ that satisfy the condition which are $(1, 9)$ and $(9, 1)$. &lt;/p&gt;
$$
\begin{equation}
\begin{aligned}
8 &amp; = 1 \oplus 9 = 9 \oplus 1 \\
125 &amp; = SB(1) \oplus SB(9) = SB(9) \oplus SB(1)
\end{aligned}
\end{equation}
$$
&lt;p&gt;So, the probability of ($\alpha$, $\beta$) being $(1, 8)$ are 2/256. &lt;/p&gt;
&lt;p&gt;And that is what Differential Cryptanalysis is all about, we find the probability of input differential ($\alpha$) that will resulting to the specific output differential ($\beta$) through S-BOX.&lt;/p&gt;
&lt;h2 id=&quot;differential-in-aes-s-box&quot;&gt;&lt;a href=&quot;#differential-in-aes-s-box&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Differential in AES S-box&lt;/h2&gt;
&lt;p&gt;In order to find differential property of S-Box, we must first find the distribution of the differences between pairs of input and pairs of output values. This can be achieved from S-Box &lt;strong&gt;Differential Distribution Table&lt;/strong&gt; (DDT), which is the table that shows the number of occurences every possible input difference that results in coresponding output difference.&lt;/p&gt;
&lt;p&gt;S-Box DDT can be quickly built with the following Python code:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;SBOX &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# 1D list of AES S-Box&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;generate_sbox_ddt&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    table &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;256&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; i &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; j &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            diff_input &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; i &lt;span class=&quot;token operator&quot;&gt;^&lt;/span&gt; j
            diff_output &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; SBOX&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;i&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;^&lt;/span&gt; SBOX&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;j&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

            &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;table&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;diff_input&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
                table&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;diff_input&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;diff_output&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
                table&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;diff_input&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;256&lt;/span&gt;
                table&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;diff_input&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;diff_output&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; table&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;If we look closely on the S-Box DDT result, each row of table have kind of similar occurence distribution where it contains either 0 or 2 and one time occurence of 4 (except the first row where input equal to zero).&lt;/p&gt;
&lt;p&gt;Below is the sample of the result showing 2nd and 65th row:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;[0, 2, 0, 0, 2, 0, 2, 0, 2, 2, 2, 2, 2, 2, 2, 2, 0, 2, 0, 0, 2, 2, 0, 0, 2, 2, 2, 0, 0, 0, 2, 4, 0, 2, 2, 0, 2, 0, 0, 0, 0, 2, 2, 0, 0, 2, 0, 2, 2, 2, 0, 0, 0, 2, 2, 2, 2, 2, 2, 2, 0, 0, 0, 2, 0, 0, 0, 2, 0, 0, 0, 2, 2, 0, 2, 2, 2, 0, 2, 2, 0, 2, 0, 2, 2, 0, 0, 0, 2, 2, 2, 0, 0, 0, 0, 0, 0, 0, 2, 2, 0, 2, 0, 0, 0, 2, 2, 2, 2, 0, 2, 0, 0, 0, 2, 0, 0, 2, 0, 0, 2, 2, 0, 0, 0, 2, 0, 0, 2, 0, 2, 2, 2, 2, 0, 2, 0, 2, 2, 0, 0, 0, 2, 0, 0, 2, 0, 2, 0, 0, 0, 2, 0, 2, 0, 2, 0, 2, 0, 2, 0, 2, 0, 2, 0, 0, 2, 0, 2, 2, 2, 2, 2, 2, 0, 0, 2, 0, 2, 0, 2, 2, 2, 2, 0, 0, 2, 0, 2, 0, 0, 0, 0, 2, 2, 2, 0, 0, 0, 2, 2, 0, 2, 0, 2, 2, 2, 2, 2, 0, 2, 2, 0, 0, 0, 0, 2, 0, 0, 0, 2, 2, 0, 0, 2, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 2, 2, 2, 0, 0, 2, 0, 0, 0, 2, 2, 2, 0, 2, 2, 0, 0, 0, 2]

[0, 2, 0, 0, 0, 2, 0, 0, 0, 0, 2, 2, 2, 0, 0, 2, 2, 0, 2, 0, 0, 2, 2, 0, 0, 0, 0, 2, 2, 0, 2, 2, 2, 2, 2, 0, 0, 0, 0, 2, 0, 2, 2, 2, 2, 2, 2, 2, 0, 2, 2, 2, 2, 2, 2, 0, 0, 2, 2, 0, 0, 2, 0, 0, 0, 2, 0, 2, 0, 2, 0, 0, 0, 2, 0, 0, 2, 0, 0, 0, 0, 0, 0, 2, 0, 2, 0, 0, 2, 2, 2, 2, 2, 0, 0, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0, 2, 4, 2, 0, 0, 0, 2, 0, 2, 2, 0, 2, 2, 0, 2, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 2, 0, 0, 0, 2, 2, 0, 0, 2, 0, 2, 0, 2, 0, 0, 0, 2, 0, 2, 2, 0, 0, 0, 0, 0, 2, 0, 0, 2, 0, 2, 2, 2, 2, 0, 0, 2, 2, 0, 2, 2, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 2, 2, 0, 2, 2, 2, 2, 2, 2, 2, 2, 0, 0, 2, 2, 2, 2, 0, 2, 2, 0, 2, 0, 2, 0, 0, 0, 2, 2, 2, 2, 2, 2, 2, 0, 2, 0, 2, 2, 0, 0, 0, 2, 2, 0, 2, 2, 2, 0, 0, 0, 0, 0, 2, 2, 0, 2, 0, 0, 0, 2, 0, 0, 2, 2, 2, 0, 0, 0, 2]&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;If we try to count those, we will find that on each row (except 1st row), 0 appears 129 times, 2 appears 126 times, and 4 appears 1 time.&lt;/p&gt;
&lt;p&gt;Lets consider $(\alpha, \beta)$ as input and output difference pairs of single AES S-box and $\alpha \neq 0$. Then we have following observation based from the S-Box DDT:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;For 129/256 of possible pairs $(\alpha, \beta)$, there is no such pair $(x, y)$ that $x \oplus y = \alpha$ and $SB(x) \oplus SB(y) = \beta$&lt;/li&gt;
&lt;li&gt;For 126/256 of possible pairs $(\alpha, \beta)$, there exist two pairs $(x, y)$ such that $x \oplus y = \alpha$ and $SB(x) \oplus SB(y) = \beta$&lt;/li&gt;
&lt;li&gt;For 1/256 of possible pairs $(\alpha, \beta)$, there exist four pairs $(x, y)$ such that $x \oplus y = \alpha$ and $SB(x) \oplus SB(y) = \beta$&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;From the above observation, can be implied that if we know a pair of $(\alpha, \beta)$ then we can quickly recover $(x, y)$ which is the actual input/output value of the S-Box &lt;sup&gt;&lt;a href=&quot;#references&quot;&gt;[2]&lt;/a&gt;&lt;/sup&gt;.&lt;/p&gt;
&lt;h1 id=&quot;1-round-aes&quot;&gt;&lt;a href=&quot;#1-round-aes&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1 Round AES&lt;/h1&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;https://merricx.github.io/static/bb8d15f8bce519db63e888cd02422327/0ec65/round1-0.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 39.86486486486486%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA/UlEQVR42p2RR27FQAxD5/7nM/B37r33bit5AibINjFAa4pMUrS571vatpW6rhV938swDHJdl5znqWBtYfdN00hRFBIEgSRJIlVVyXEcYp7nkXmeFXmey77v2rwsi2Jd1x9s26aVc9d1VRhSjGAKYsMmyzLxfV88z9NKo3UKpmlSwXEcdQ0gx0CapoqyLKXrOjFxHCs7SlxAEIahqkZRpI3cUXGOOBUyzuhlTb+OzCHz44hLlD+fj47OCKjSTB/O+JjKHcSYQAQj5Gvk+/mdDc3kavOjQo66XVP5MYiRpeM4Svi+rxhe/3kgJFMbCeLkrIR/hSVkZOKg4pBJvwCCrWUPdayDWwAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;round1 0&quot;
        title=&quot;&quot;
        src=&quot;https://merricx.github.io/static/bb8d15f8bce519db63e888cd02422327/fcda8/round1-0.png&quot;
        srcset=&quot;https://merricx.github.io/static/bb8d15f8bce519db63e888cd02422327/12f09/round1-0.png 148w,https://merricx.github.io/static/bb8d15f8bce519db63e888cd02422327/e4a3f/round1-0.png 295w,https://merricx.github.io/static/bb8d15f8bce519db63e888cd02422327/fcda8/round1-0.png 590w,https://merricx.github.io/static/bb8d15f8bce519db63e888cd02422327/efc66/round1-0.png 885w,https://merricx.github.io/static/bb8d15f8bce519db63e888cd02422327/c83ae/round1-0.png 1180w,https://merricx.github.io/static/bb8d15f8bce519db63e888cd02422327/0ec65/round1-0.png 2009w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;Let’s start breaking 1 round AES with the differential cryptanalysis!&lt;/p&gt;
&lt;p&gt;Consider $(p_1, c_1)$ and $(p_2, c_2)$ are plaintext-ciphertext pairs of 1-round AES, where all these values are known to us and we want to find the &lt;code class=&quot;language-text&quot;&gt;MasterKey&lt;/code&gt; (known-plaintext scenario). &lt;/p&gt;
&lt;p&gt;Let differential of $(p_1, p_2)$ denoted by $\alpha$ and differential of $(c_1, c_2)$ denoted by $\beta$.&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;https://merricx.github.io/static/24978624e42f668e8563e771d7f0fd22/b5cea/round1-1.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 52.02702702702703%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABMElEQVR42oWS64qDQAyF5/0fr79UlGqtWotWbb2gVbN8gSxuKeyBYGaSHM8kceu6StM00ve9vF4veT6fMk2T+suyyPV6lTzPJY5jCYJAQNd1Gjeb51nattWvowgywCUJVsT5fr9LlmWSpqkkSaKkRVFoDgTkATjGcRSHwrquNUDx7XZTImzbNvkEAkwhL3s8HkqGT8wdkwlUVaW+ke37/sfsDqAIwiMcqggg/3K5SBRFX4m+EZN/Op2077wS36FoGAY165XhP0JqIeXMIBHnrJAnopTecX6/3/INlkvvEWG9thY5HCSb0XCI6Sd/5cw9q8PAbAOIY/gQ89WhoIQLwKTKsvyd5vl8Fs/zxPd9XRcsDENtja0NPzJf1waFEJl8mstK2Dp8AtXkkI/y49pA+gOjQQRRYnFWYQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;round1 1&quot;
        title=&quot;&quot;
        src=&quot;https://merricx.github.io/static/24978624e42f668e8563e771d7f0fd22/fcda8/round1-1.png&quot;
        srcset=&quot;https://merricx.github.io/static/24978624e42f668e8563e771d7f0fd22/12f09/round1-1.png 148w,https://merricx.github.io/static/24978624e42f668e8563e771d7f0fd22/e4a3f/round1-1.png 295w,https://merricx.github.io/static/24978624e42f668e8563e771d7f0fd22/fcda8/round1-1.png 590w,https://merricx.github.io/static/24978624e42f668e8563e771d7f0fd22/efc66/round1-1.png 885w,https://merricx.github.io/static/24978624e42f668e8563e771d7f0fd22/b5cea/round1-1.png 1140w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;We then apply $MC^{-1}$ and $SR^{-1}$ to $\beta$. Now we have one-on-one byte relation of $\alpha$ and $\beta$ through S-Box.&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;https://merricx.github.io/static/291436cf178e716bfc221df34125211d/772aa/round1-2.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 21.62162162162162%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA7UlEQVR42lWPuXKDQBBE9f8f4NixyrEDO5UDH5EPCiQBYjkEC8hoYQvQCp7xOnJXzdQcPV09K5hR6swwDPzHbPO3GgjDkKIobK9USxLH5PLEaP6Yfd9T1ydbrzavMUEQIYSgbVvmecYYY+Um07N7W+N57sIJ6LqOPD/y6WzZvz9Qi2d0b/BcD8f9YOOsWd3e+ex9wTFLaZozWmuklKhWo1VJ9HKzOBIkSWrnUhYEh4zMeyT+ukd1IyKKCKMdT+4imCWBdeD7vhX7xTRNS1wx14lDXNqXo+VoHEeqqmK/2xKnklZfuFxGArsXlHnDD04cKmPUbTJvAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;round1 2&quot;
        title=&quot;&quot;
        src=&quot;https://merricx.github.io/static/291436cf178e716bfc221df34125211d/fcda8/round1-2.png&quot;
        srcset=&quot;https://merricx.github.io/static/291436cf178e716bfc221df34125211d/12f09/round1-2.png 148w,https://merricx.github.io/static/291436cf178e716bfc221df34125211d/e4a3f/round1-2.png 295w,https://merricx.github.io/static/291436cf178e716bfc221df34125211d/fcda8/round1-2.png 590w,https://merricx.github.io/static/291436cf178e716bfc221df34125211d/efc66/round1-2.png 885w,https://merricx.github.io/static/291436cf178e716bfc221df34125211d/c83ae/round1-2.png 1180w,https://merricx.github.io/static/291436cf178e716bfc221df34125211d/772aa/round1-2.png 2042w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;Then, consider $x$ and $y$ where we try all possible values until they satisfy following conditions:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;$x \oplus y \neq 0$&lt;/li&gt;
&lt;li&gt;$x \oplus y = \alpha$&lt;/li&gt;
&lt;li&gt;$SB(x) \oplus SB(y) = \beta$. &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;According to the differential observation that explained before, it should exist two possible pairs $(x, y)$ that satisfy those conditions.&lt;/p&gt;
&lt;p&gt;Alternatively, we can optimize our finding of possible $(x, y)$ value using S-Box DDT that we built previously. This way, we can just do table lookup of $\alpha$ and $\beta$ to quickly find possible $(x, y)$ instead of using brute-force. But, we need to slightly modify our S-Box DDT to store the actual value of $(x, y)$ instead of the number of occurence.&lt;/p&gt;
&lt;p&gt;Below is the Python implementation that generate S-Box DDT lookup:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;SBOX &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# 1D list of AES S-Box&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;generate_sbox_ddt&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    table &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;256&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; i &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; j &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            diff_input &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; i &lt;span class=&quot;token operator&quot;&gt;^&lt;/span&gt; j
            diff_output &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; SBOX&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;i&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;^&lt;/span&gt; SBOX&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;j&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

            &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;table&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;diff_input&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
                table&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;diff_input&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;diff_output&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;update&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;i&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; j&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
                table&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;diff_input&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; _ &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
                table&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;diff_input&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;diff_output&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;i&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; j&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; table

ddt &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; generate_sbox_ddt&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# Lookup the table&lt;/span&gt;
alpha &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt; 
beta &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
possible_xy &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; ddt&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;alpha&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;beta&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Okay, so what’s next after we found the value of $(x, y)$ ?&lt;/p&gt;
&lt;p&gt;Remember that before round 1, there is additional &lt;code class=&quot;language-text&quot;&gt;AddRoundKey&lt;/code&gt; before the very first &lt;code class=&quot;language-text&quot;&gt;SubBytes&lt;/code&gt; operation. So, the value of $(x, y)$ is the value of either $ARK(p_1)$ or $ARK(p_2)$. Thus, we can find possible $RK_0$ by simply XORing $x$ or $y$ with the respective byte of $p_1$ or $p_2$. &lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;https://merricx.github.io/static/1369b8cf4afd28c1a866806e7571c150/2fb55/round1-3.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 83.1081081081081%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsTAAALEwEAmpwYAAACUElEQVR42oVUWXPaMBD2//8bfWuf+9ZjOpMe6UGTEEjMaTDG+OIQxtiW7a+7AqlA6HQ9OzpW++nbQ7ZwlIa/plHzzW6N4XCEoiwOtuZoI5W0Hk0nmHseqqoydi2WAawPm8vpBo8fbIynI4RBaA43da3G8LYD5/sDHM+F2Gz+D7hyBdrvbTjuGAt/gfoIpAH938/ofvmJ3nCA1Wp1HdCERFLIAvPQw3QyRRzHxqbtGdmjZYKEbPv9Hpf+llpolsfNSlbmMPD3dr2UZYmS9JIdzw1DnWAWDrMoCjPP81ypdpZSKtVSUbr02mKgMAjgui7SNDWH9AHOk23b6Ha72O12BwDy0blFLREHc4wdR0Vl9QYrvH47gj+fIKCqMlBKjnEUqPNJ5xW853dwvQjpViiWG6puHCfK/m2Q4M1ND4E3wYKIWctkjR+tDp6eunBnMxXadrtFslyiKiXcfgcP97/Qbj8iSRKVCgZUFW4qOP4SX++eMRz0MZ/7sMpdChFHWNONGQFVrFRBcE6J7T7LIcSWVJhCnEotS6RijYh8OGUWdLsci8CARRietcJZkU/aSHdITWNBkZk+5ARnWXa4kVhUx+IoOCKaE0sO0TT5RW/ymJ8C8obuu5pGuV5TLx7C+zi4waf2Z4z7Iwgqyr8ANSHr8gZmKDmPRa4otib3aNl3cEaOKtY1wNMIDaBpZAKWQpicZSJD6AeY0d9FO11jqCO0LikzYCXE2bPi39g+2794aqeFepFDBuSXsONRz0n55oAaNooi1Ta81k+Ro2LlPf10/wBmvifKbjfb+AAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;round1 3&quot;
        title=&quot;&quot;
        src=&quot;https://merricx.github.io/static/1369b8cf4afd28c1a866806e7571c150/fcda8/round1-3.png&quot;
        srcset=&quot;https://merricx.github.io/static/1369b8cf4afd28c1a866806e7571c150/12f09/round1-3.png 148w,https://merricx.github.io/static/1369b8cf4afd28c1a866806e7571c150/e4a3f/round1-3.png 295w,https://merricx.github.io/static/1369b8cf4afd28c1a866806e7571c150/fcda8/round1-3.png 590w,https://merricx.github.io/static/1369b8cf4afd28c1a866806e7571c150/efc66/round1-3.png 885w,https://merricx.github.io/static/1369b8cf4afd28c1a866806e7571c150/c83ae/round1-3.png 1180w,https://merricx.github.io/static/1369b8cf4afd28c1a866806e7571c150/2fb55/round1-3.png 2201w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;Thats it! We can iterate this process for all byte position of $RK_0$. Note that there will always be 2 possible values for each byte position of $RK_0$ (except the differential is zero), so we can do trial encryption/decryption with the obtained possible key to get the correct key with only $2^{16}$ trials.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt; Because we already found &lt;code class=&quot;language-text&quot;&gt;RoundKey&lt;/code&gt; of round 0, we don’t need to reverse the key expansion since this &lt;code class=&quot;language-text&quot;&gt;RoundKey&lt;/code&gt; is already equal to the AES &lt;code class=&quot;language-text&quot;&gt;MasterKey&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&quot;2-round-aes&quot;&gt;&lt;a href=&quot;#2-round-aes&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2 Round AES&lt;/h1&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;https://merricx.github.io/static/fcc0f132337f377ec225cac5ba1d2b2a/cdaca/round2-0.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 54.72972972972974%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABT0lEQVR42p3S125EMQgEUP//5+3bStt7703b2BwkR8ljciWE7wDDgF2ez2dsNptYrVaxXq9jt9vF4XCIx+MR9/s9zfmnweTP5/Po9XoxmUzyX6y8Xq84nU5ps9ksrtdrNjifz2mXyyUNXk1up9OJ/X6fNYQwxAXzdDqNbrebpqPE7XabatnxeEyDU++sGYLxeJx+uVxmrIxGoywGIJY8HA5TpZiGi8UiPcyYPEyNHGeYSQrJtUO73U4VjUYju1FciygxljMvRoCJBoNBjt5sNqPUbhIR9/v97EYlTDIyBWIwXiOxVquVQuCwAqyLr7KtwOj25wyjymUY3f4Uy68XYjK3X/zYC8DNIaJIAVUMkRE1MEXNUVcv5nuH8fVhtjNPAugp3W63PPNwOfUpIfR+4cisQFNYeb/f8Z9PA1NRaX+/FCL9i1VCK7Aal2rXFH8AG9BEsHEfp7QAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;round2 0&quot;
        title=&quot;&quot;
        src=&quot;https://merricx.github.io/static/fcc0f132337f377ec225cac5ba1d2b2a/fcda8/round2-0.png&quot;
        srcset=&quot;https://merricx.github.io/static/fcc0f132337f377ec225cac5ba1d2b2a/12f09/round2-0.png 148w,https://merricx.github.io/static/fcc0f132337f377ec225cac5ba1d2b2a/e4a3f/round2-0.png 295w,https://merricx.github.io/static/fcc0f132337f377ec225cac5ba1d2b2a/fcda8/round2-0.png 590w,https://merricx.github.io/static/fcc0f132337f377ec225cac5ba1d2b2a/efc66/round2-0.png 885w,https://merricx.github.io/static/fcc0f132337f377ec225cac5ba1d2b2a/c83ae/round2-0.png 1180w,https://merricx.github.io/static/fcc0f132337f377ec225cac5ba1d2b2a/cdaca/round2-0.png 2021w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;Can we extend our previous attack to make it works against 2 round AES?&lt;/p&gt;
&lt;p&gt;Consider $(p_1, c_1)$ and $(p_2, c_2)$ are plaintext-ciphertext pairs of 2-round AES and $(\alpha, \beta)$ are input-output difference pairs of $(p_1, p_2)$ and $(c_1, c_2)$ respectively.&lt;/p&gt;
&lt;p&gt;If we illustrate this scenario into 2-round AES, we can bypass first &lt;code class=&quot;language-text&quot;&gt;AddRoundKey&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;ShiftRows&lt;/code&gt; by swapping operation order with &lt;code class=&quot;language-text&quot;&gt;SubBytes&lt;/code&gt;. Then, in the last round, we can bypass &lt;code class=&quot;language-text&quot;&gt;ShiftRows&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;MixColumns&lt;/code&gt;, and &lt;code class=&quot;language-text&quot;&gt;AddRoundKey&lt;/code&gt;. So, the view become $\alpha \circ SB \circ MC \circ ARK \circ SB \circ \beta$.&lt;/p&gt;
&lt;p&gt;Unfortunately, there are already too many operation between &lt;code class=&quot;language-text&quot;&gt;SubBytes&lt;/code&gt; that will significantly mess our differential distribution. Moreover, &lt;code class=&quot;language-text&quot;&gt;MixColumns&lt;/code&gt; will also prevent us to work on one-on-one byte relation, since this operation works on 4-bytes at once. This is already too much and too complex. Thus, we need different strategy that much more simple. &lt;/p&gt;
&lt;p&gt;The key point here is that we can only “bypass” &lt;code class=&quot;language-text&quot;&gt;SubBytes&lt;/code&gt; with differential &lt;strong&gt;once&lt;/strong&gt; at a time. But then, there are two &lt;code class=&quot;language-text&quot;&gt;SubBytes&lt;/code&gt; in 2-round AES, how can we bypass the other one?&lt;/p&gt;
&lt;h3 id=&quot;half-last-round&quot;&gt;&lt;a href=&quot;#half-last-round&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Half Last Round&lt;/h3&gt;
&lt;p&gt;To simplify our understanding of the attack, lets first assume that last round does not make use of &lt;code class=&quot;language-text&quot;&gt;MixColumns&lt;/code&gt; (usually called half round). So, in the round 2, the operation flow is only $SB \circ SR \circ ARK$.&lt;/p&gt;
&lt;p&gt;Let $\alpha$ be differential of plaintext $(p_1, p_2)$ where only the first column has &lt;strong&gt;active&lt;/strong&gt; byte, which is byte with non-zero differential. Any other value should be zero differential or &lt;strong&gt;inactive&lt;/strong&gt; byte. Since we need this spesific plaintext value, so this attack only applicable in chosen-plaintext scenario.&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;https://merricx.github.io/static/2a62cd934ac006b24cd5bf13a4aa0993/8b936/round2-1.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAACWElEQVR42p2VzW7TQBDH/RYceAQ4ceAVeAsOPAAHTnxItOUAR6QUCXGtVFQJkBCIC1CQohQuCCGaREnqz43tOLFjO07i2o7tP95NHMhHU5eRRrsae3+emZ0Zc5hJu02Qpinb0zXfX1Q4V/wASz6CqpuwLBOe5y2ALwwUD65C+Hwbmhmi1axD0zQkSfL/QOn1dQhf76JjheBPmjAMoxBwXXroykmvrqH58Q54YuP49y9IkoQ4js8ELoPSf+wMqLy/AVJ5CMOOQBQRqqpuBk4fsDWdvZNHxEKOJ6dI4gij0QhRFK2EsMbFOYiK7/vzNFFHuPwINYZhuBjOGs298QIft77s4bD2E32jB03XYZpmBpx9qdFoYDweF75Nyx/i8v4DvPx2CFPVIckS9AzK0Yfdbhflchm1Wg2O46DX6zGldqrUe6qdToeVVb9nwhx7uPLmMd7+qGBg9qEQws4w4GQyQb1eh23bLCSay7M0oGmJE+bhpf372Dv6BCcLWRBF9nEunuWEwii4qPhRiO3v71BpHsMxLRgZzHXdqYdToDMHbrqUdX2epMncxhHdh0RcDD2X9fFwONxYNrktiifQXIuliGle2PeeatjZPYFjKeB5CbIsL3i6LMnMRjLYzYMSu1l6hud5dqHc1jMdT17IGNgkazvCaqlI61Gv/OB0dThs7erYLjXQ1VtonQiFezkIAlSr1WyOtkGykqFe0j336HkHO6V6VlsiFEWFIAiFgPSdwWAwLyfaZXTl9G7Wi+YY/Wy40nCp8bzxtWmscX9/AW2W4PN+ASvja0n/ALZD/sn4zibPAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;round2 1&quot;
        title=&quot;&quot;
        src=&quot;https://merricx.github.io/static/2a62cd934ac006b24cd5bf13a4aa0993/fcda8/round2-1.png&quot;
        srcset=&quot;https://merricx.github.io/static/2a62cd934ac006b24cd5bf13a4aa0993/12f09/round2-1.png 148w,https://merricx.github.io/static/2a62cd934ac006b24cd5bf13a4aa0993/e4a3f/round2-1.png 295w,https://merricx.github.io/static/2a62cd934ac006b24cd5bf13a4aa0993/fcda8/round2-1.png 590w,https://merricx.github.io/static/2a62cd934ac006b24cd5bf13a4aa0993/efc66/round2-1.png 885w,https://merricx.github.io/static/2a62cd934ac006b24cd5bf13a4aa0993/c83ae/round2-1.png 1180w,https://merricx.github.io/static/2a62cd934ac006b24cd5bf13a4aa0993/8b936/round2-1.png 1368w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;Then, send $(p_1, p_2)$ to the encryption oracle which will give us corresponding $(c_1, c_2)$.&lt;/p&gt;
&lt;p&gt;If we remember our previous differential observation, there are 129/256 probability that differential input/output is impossible. Instead of using possible pair of differential, we will use the opposite which is the impossible pair. We can use this property as distinguisher whether our state is in correct state or not.&lt;/p&gt;
&lt;p&gt;So, the main idea here is to generate all &lt;em&gt;impossible&lt;/em&gt; state at the start of round 2 just before second &lt;code class=&quot;language-text&quot;&gt;SubBytes&lt;/code&gt; using $\alpha$. First, we want to bypass &lt;code class=&quot;language-text&quot;&gt;SubBytes&lt;/code&gt; using S-Box DDT like our previous attack on 1-round. But here, instead of finding possible S-Box output differential, we want to find impossible S-Box output differential. This will result in 129 impossible byte for each $\alpha$ denoted by $\mathbf{S} = (S_1, \ldots, S_{129})$. Then, for each $S_i$ we apply $SR$, $MC$ and store this state to the list of impossible state.&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;https://merricx.github.io/static/27af0c1a9bc34b1f1767e158088dbe39/c4cb0/round2-2.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 66.21621621621621%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAACu0lEQVR42lVTW2sTQRTeP+LP8M0n/4Eg+CT4A/RR8El8EykoPggWFREsaBEK1rZqrZeisaba1qRtmnu32SZ7n83u7G72ls8zk6Tggclkz5z5zne+c0YZj8eYLWFa4EIzdERhKL+FP8/zs3NhaZbJ/VDV8aO2D9swwTmXPkXEFfSTFYV03NlZw4e/ZTDTQjwayUDf9+F5HlRVlXuSJDK2WrewW6mh3W7BpPgpYC54IM1z6ZirbOBrbQ+By1BQkozYjAg4JMaWZckEwldMCWRZIu+LJXyKaUdodH0q0UeapPDjCDyK5KWZZVl+Jou4lKYTQLHCKEHf8KGbATFPoZQrHh69bKOvNWE7DDGBhTwAY0yWlyYxASTEMEZEZ/9bgb4+xNuPdax9biDgIyj7DR+LKz1Y5gmCgJNuCXTDhq7ryAjIsEI0W12MIg9C777uotkZwA9iWabthvj28xjfyyolTaCI0vJClDLp4lHbx/wrkaAnAX9XHZT/NFDacWCzBNdu1XHhaherm4zwIiRpDnG1KKYa5vmkKUInYZWajfvP6uidNOG6HkxjgPmFQ2z+6sG0fFy+UcX5K10srdNocQcj0k3qO9VUEUCC4Qw44Am0AafORhRYgIcp2uoQRR5THFXQCbFb41TqSGo4YzZbiuWmeP5GRf90ouG4EMAZ/Q/OpA98D3mWTL9oH4szKpViRSNK2ypKvzUwL4IysFLcfdxAs1EjkKHMvPxJRYeGNUtj7B4wbO/U0eoakv2T1z3cnDvGly1TJnZZhHfrR1jZoOG2ORRRUrXuwjBEVyPUWg5uP9inBIfT16FhabWKxdVTGKaDS9cPcO5iHQ9fdBCHDiWJcaIxqJonZ1IJQw4eMHS7x8TQwzDIsFEy6Cnp8olxHuL9Zp+Y+HIeF5ZN3Hs6wNYekwLEcQzXseAxR87pP0dSyzdpKv1xAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;round2 2&quot;
        title=&quot;&quot;
        src=&quot;https://merricx.github.io/static/27af0c1a9bc34b1f1767e158088dbe39/fcda8/round2-2.png&quot;
        srcset=&quot;https://merricx.github.io/static/27af0c1a9bc34b1f1767e158088dbe39/12f09/round2-2.png 148w,https://merricx.github.io/static/27af0c1a9bc34b1f1767e158088dbe39/e4a3f/round2-2.png 295w,https://merricx.github.io/static/27af0c1a9bc34b1f1767e158088dbe39/fcda8/round2-2.png 590w,https://merricx.github.io/static/27af0c1a9bc34b1f1767e158088dbe39/efc66/round2-2.png 885w,https://merricx.github.io/static/27af0c1a9bc34b1f1767e158088dbe39/c83ae/round2-2.png 1180w,https://merricx.github.io/static/27af0c1a9bc34b1f1767e158088dbe39/c4cb0/round2-2.png 2638w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;If we look at the image above, our impossible state is spreaded to all byte position despite only using 4-bytes. That is the main reason why we put active byte only on the same column.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Then, we will guess one byte of $RK_2$ for every possible values and inverse the pair of ciphertext $(c_1, c_2)$ through $ARK$, $SR^{-1}$, and $SB^{-1}$ independently. Finally, we create differential of inversed $(c_1, c_2)$ denoted by $\beta$ and compare with our generated impossible state. If $\beta$ exist in the impossible state, then we know that our guess key is incorrect and we add it to the list of impossible key.&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;https://merricx.github.io/static/d0bfe0f7c8835cfa903e20ee9249fa7a/7edcf/round2-3.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 52.70270270270271%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACBUlEQVR42lVT6W6bQBDm/Z+i6t9IfYC2UQ9ZidTErdrYZrENDsTlMCz3mpuvs4txk0ErhmX5jplBS7MCSVqibVuM4wgZ6n7Js6IC51zlVTMgDCP0fYe6rhGcQtS0J+N8rugbQHv/YYevdzaqqpVQmLAmsL6O4Ww+wjy8oCxLuMZn2Ic94iShlcFYLxE7d8hzAbZdY+V8g/bp+wH3S/cV4DiLQ98KOLslTPOAKIoof4D9bMF1XZxInb7+De5tkaY5dLaBddShSYBhGMlG/x+oq4mgmmzWHYoiV3ndDhBCoOs6Wi2YsUUiKqVeEnZND20YBqVM1nDoW3hBgR+//sLzpE2BPMsQx/HEhAsjRZrn2Osb+I8PSOmMFCRD6/tBKTuTIlEWcP0IK93G88GiZsRkLUAQBOqwJJ8EAJxItroOj9a8J91qM+PcCBltU1HXzldNs/3XIUF2exNJeUbTNFSWYlLoksUgElSr5k1DFBiVwDdXcBwHJRGUJxvu0VFdlrU09DW4rasampaFlWtDe3ezw+3CJgvFValaMm8EXh5pbEwLJ54gYQuYbA3X8+l8AmvHEG4WSIiAMYYv2z/Qfj75eGKcJF8sjm8H++iHBGiSxR6ZaGg8DGRZqhQywwDPStWQMAzRUBM1ziPqIleTP9udFcqNkYDkmKjHSy7rJ99LIPnXXEtE1z+QoUgAdPvlmAAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;round2 3&quot;
        title=&quot;&quot;
        src=&quot;https://merricx.github.io/static/d0bfe0f7c8835cfa903e20ee9249fa7a/fcda8/round2-3.png&quot;
        srcset=&quot;https://merricx.github.io/static/d0bfe0f7c8835cfa903e20ee9249fa7a/12f09/round2-3.png 148w,https://merricx.github.io/static/d0bfe0f7c8835cfa903e20ee9249fa7a/e4a3f/round2-3.png 295w,https://merricx.github.io/static/d0bfe0f7c8835cfa903e20ee9249fa7a/fcda8/round2-3.png 590w,https://merricx.github.io/static/d0bfe0f7c8835cfa903e20ee9249fa7a/efc66/round2-3.png 885w,https://merricx.github.io/static/d0bfe0f7c8835cfa903e20ee9249fa7a/c83ae/round2-3.png 1180w,https://merricx.github.io/static/d0bfe0f7c8835cfa903e20ee9249fa7a/7edcf/round2-3.png 2995w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;The remaining key that is not discarded to the list of impossible key should be the correct possible key. We just need to repeat this process to the other byte position.&lt;/p&gt;
&lt;p&gt;But, there is still one problem, that is if we only use one $\alpha$, it is not enough to discard most of the impossible key. From my experiment, single $\alpha$ will only find about 110-140 impossible keys. So, we need more $\alpha$ which means more chosen-plaintext pairs. The ideal number of $\alpha$ required would be about ~10 to discard almost all of the impossible keys.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;NOTE&lt;/strong&gt;: using two $\alpha$ doesn’t mean we will find ~250 impossible keys, since most keys found will be duplicate to each other.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;After we discard almost all of the impossible keys, we still need to inverse the key from $RK_2$ to $RK_0$ which is the &lt;code class=&quot;language-text&quot;&gt;MasterKey&lt;/code&gt;. How we perform inverse Key Schedule is outside this article scope and will not be explained here. If you want to learn how to do it, you can take a look on my &lt;a href=&quot;https://github.com/Merricx/aes-attack/blob/main/utils.py#L134&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;source code&lt;/a&gt; or probably implement yourself :D&lt;/p&gt;
&lt;p&gt;Finally, we can enumerate the remaining possible key using trial encryption/decryption like our previous attack. This should only take less than $2^{6}$ trials if we use ~10 $\alpha$.&lt;/p&gt;
&lt;h3 id=&quot;full-last-round&quot;&gt;&lt;a href=&quot;#full-last-round&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Full Last Round&lt;/h3&gt;
&lt;p&gt;Now, as we successfully broke 2-round AES with half last round, how will we do it in the full last round?&lt;/p&gt;
&lt;p&gt;If we re-illustrate the attack flow into full round scenario, we need 4-byte guess at once to bypass &lt;code class=&quot;language-text&quot;&gt;InvMixColumns&lt;/code&gt; operation and this alone already significantly increase time complexity from $2^{8}$ to $2^{32}$.&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;https://merricx.github.io/static/3265c240bb56f05bf40545ba9ce35e79/5f652/round2-4.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 66.89189189189189%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAACWUlEQVR42pVT3WoTURDep/DeB+ibWOiNiPQFvPBCeql3ig+gXhUEQYvSG6HSQKuEQpXW9iLGpiTZ/7/k7HY3u0l2N81umu3nnGMSDCjFgWE5zMw338x8KxVFgSiK0O/3Eccx0jQFt+vra/Hlb9u2RQ7zQ+RXWIpPJhMkaYK5SWEYotFooNVqCdc1GRNqMi/iYGdnPyGrBupHO2CN9yI2nV6JJnEcIfAj1PR91N3Kb8AguIDbYfBcFYmyhSzpLbqrqgrWdWF1+jAOn6KzfVvE8nyMZrMJWWnD0S/w+vABXh3dgeS6Ls4bZ8TAglL/DOvdLUqoY0oTZVkKy7LgsQ688BLd788R7KyADzspchiGQUQcBN0B3nx9iM3je5A8z4Msy1A1A4bagF17C1NrYZwXYhy+Bk2VYbMhlOoTsI8rKAmwKMbQdR3M6yLyM2ydPMLmyV1IjDEB2G4raJ7/AGvtIr/sz/Y0FUUcUDEu0Ko+Q/hpRcQKGpnXOY4FW/Px4fgxMbwPaTQaYTgcIkkSunSErO/SOOMFYJZlSCm2t/8FtlpDbH1DNhqL6/OjcNc0HYMsQJR2IOEfNpcFNw5aqezCdGi8vEQQBujRMQeDgXAut4VseOGylwswzpAzCYMAOh0vJnkNXr7AdCarP60UdeXfGc4B56I3aY8OMWIHB/BXVzHq9cRhuKx4Dm88r7sR0Pd9qIoCmQRuVatw19fR63Zh0tt1HNqfJoD/C1Am6dTbbeh7e+isrSEjhjyjJGZlWS7V3AjI/ySDRm6bJvzTUzgbGxiTKmaJS/n8+wtP/cVhbJNP/QAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;round2 4&quot;
        title=&quot;&quot;
        src=&quot;https://merricx.github.io/static/3265c240bb56f05bf40545ba9ce35e79/fcda8/round2-4.png&quot;
        srcset=&quot;https://merricx.github.io/static/3265c240bb56f05bf40545ba9ce35e79/12f09/round2-4.png 148w,https://merricx.github.io/static/3265c240bb56f05bf40545ba9ce35e79/e4a3f/round2-4.png 295w,https://merricx.github.io/static/3265c240bb56f05bf40545ba9ce35e79/fcda8/round2-4.png 590w,https://merricx.github.io/static/3265c240bb56f05bf40545ba9ce35e79/efc66/round2-4.png 885w,https://merricx.github.io/static/3265c240bb56f05bf40545ba9ce35e79/c83ae/round2-4.png 1180w,https://merricx.github.io/static/3265c240bb56f05bf40545ba9ce35e79/5f652/round2-4.png 1302w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;Fortunately, there is one property in AES to overcome this problem. Remember that both of &lt;code class=&quot;language-text&quot;&gt;MixColumns&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;AddRoundKey&lt;/code&gt; are linear operation and these operation hold the following equation:&lt;/p&gt;
$$
\begin{equation}
\begin{aligned}
ARK(MC(p)) &amp; = MC(p) \oplus RoundKey \\
&amp; = MC(p) \oplus MC(MC^{-1}(RoundKey)) \\
&amp; = MC(p \oplus MC^{-1}(RoundKey)) \\
\end{aligned}
\end{equation}
$$
&lt;p&gt;Which means we can swap the order operation of &lt;code class=&quot;language-text&quot;&gt;MixColumns&lt;/code&gt; with &lt;code class=&quot;language-text&quot;&gt;AddRoundKey&lt;/code&gt; as well as &lt;code class=&quot;language-text&quot;&gt;AddRoundKey&lt;/code&gt; with &lt;code class=&quot;language-text&quot;&gt;InvMixColumns&lt;/code&gt;.&lt;/p&gt;
$$
\begin{equation}
\begin{aligned}
MC^{-1}(ARK(c)) = MC^{-1}(c) \oplus MC^{-1}(RoundKey)
\end{aligned}
\end{equation}
$$
&lt;p&gt;So, we can apply $MC^{-1}$ on our $c$ before $ARK$ as long as we also apply $MC^{-1}$ to the $RK_2$. But, we don’t really care about updating $RK_2$ right now. We just need to apply $MC$ later when we got all bytes of the possible keys.&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;https://merricx.github.io/static/3de192a96ca7edecdee7444096225c50/f7171/round2-5.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 45.94594594594595%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABzklEQVR42k2SW2+cMBCF+fd96J/oc/vQl1bqe5S2SZWqTTbZkIWFBRYvNjdzv5+ODY0yEhoP4PF3ztjI8hans4QsGizLQg90VlEWORgLdZ1lCYQQGMYR58BHXUkURQl2CTFOA8qyBJcnGDszw4dPD3g+RLrJPK/NVDDrGtZhjywV8M0rOI6DKBKwXx6Q+He0TnFv/gCLXRxtB1/+vodRVUQYZMhlSy3WZuPYa9KCCBVV13XIiTBNU7RtC8uyEKcJOBekgGEYBr22ozsYyzJvPAs1GpBmDfZmoCV2XU85w9tQkl3LRvi0R5Ik6Pse8zQhocNSj8GYqJimGSo3dYULyXjcOwjDM6QkQs7X4+ZJ56qu4RwOYOYzWiKvqVbUrufB/q0J1x/XgWySh14foNgVJTYzts84Oi5EXpAlBdqm0e+UEkE2GAGrcHV7RsByhbFu2nYK8xYvT/fkXYJwdw3XOYKLmIayBzd/IWIXfH/8A5OTmgvHu5uvME5Bgc/fLJi20ByadF59jZlP07PQEEUUOPBJlpQS3slFxkPkeQ7H95DXJWSc4uPuJ4yafIsiru/Uf8mv0slb1UDV/TBqiSqkLND1g55uRfdP+aEsAl25fwqvquRIA5MMAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;round2 5&quot;
        title=&quot;&quot;
        src=&quot;https://merricx.github.io/static/3de192a96ca7edecdee7444096225c50/fcda8/round2-5.png&quot;
        srcset=&quot;https://merricx.github.io/static/3de192a96ca7edecdee7444096225c50/12f09/round2-5.png 148w,https://merricx.github.io/static/3de192a96ca7edecdee7444096225c50/e4a3f/round2-5.png 295w,https://merricx.github.io/static/3de192a96ca7edecdee7444096225c50/fcda8/round2-5.png 590w,https://merricx.github.io/static/3de192a96ca7edecdee7444096225c50/efc66/round2-5.png 885w,https://merricx.github.io/static/3de192a96ca7edecdee7444096225c50/c83ae/round2-5.png 1180w,https://merricx.github.io/static/3de192a96ca7edecdee7444096225c50/f7171/round2-5.png 3456w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;Thats it! There is no other difference with how we attack half round.&lt;/p&gt;
&lt;h1 id=&quot;3-round-aes&quot;&gt;&lt;a href=&quot;#3-round-aes&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3 Round AES&lt;/h1&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;https://merricx.github.io/static/b7cdc09b99fde544b9e43876dfb13668/efa1a/round3-0.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 68.91891891891892%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAABlElEQVR42p3TSY5CMQwE0Nz/eGxBzNNnnkeB6WcpLHrX/SXjJLaryk4oj8cj1ut1LJfL9Pv9Po7HYzyfzxBj1r9ttVrFdDqNwWAQs9ksNptN3O/3KIKn0ymBmqZJAMnn8zntcrl87Xq9pkfY7/cTZD6fx3a7zZrxeByFqslkkgm9Xi8ZD4dD7Ha7JOEBMOc8AYwyKpkOxYtDDJiYguFw+GVEaL1YLHLNI9GN9Wg0SjBqdVCoEwRMIcBWq5Xq7CWKIVEon5J2u53K5AAF3u12o2BTIJEiLQMBYG8UtS0xxc6A851OJ029TovE2+2WFwDcWmvkS6C03ry5icmlyJm9PLV5ywC1jBGTJF4SlWJma13PFGsPKNXOdGldzEOBDV9nxEuqZMZQyXnEdab2ahHlLWtFgiLvDLO26lOgTGs1R0ydmBcAyLk3XTDaKHBjknnA9WYZALOs6rSszsU5Q+pPUeLncxFUAuNfr9d3zVwQdmf132LPGxVRYu/3O4qf/3zAtEyhOeowb1kQ6F/MR6nZGYc51pY/Pm4lobAgxCcAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;round3 0&quot;
        title=&quot;&quot;
        src=&quot;https://merricx.github.io/static/b7cdc09b99fde544b9e43876dfb13668/fcda8/round3-0.png&quot;
        srcset=&quot;https://merricx.github.io/static/b7cdc09b99fde544b9e43876dfb13668/12f09/round3-0.png 148w,https://merricx.github.io/static/b7cdc09b99fde544b9e43876dfb13668/e4a3f/round3-0.png 295w,https://merricx.github.io/static/b7cdc09b99fde544b9e43876dfb13668/fcda8/round3-0.png 590w,https://merricx.github.io/static/b7cdc09b99fde544b9e43876dfb13668/efc66/round3-0.png 885w,https://merricx.github.io/static/b7cdc09b99fde544b9e43876dfb13668/c83ae/round3-0.png 1180w,https://merricx.github.io/static/b7cdc09b99fde544b9e43876dfb13668/efa1a/round3-0.png 2040w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;Good news! We can actually extend our previous attack to work against 3-round AES. We can think this as “2-round AES with additional round at the beginning”.&lt;/p&gt;
&lt;p&gt;Let $\alpha$ be differential of plaintext $(p_1, p_2)$ where only the &lt;strong&gt;first&lt;/strong&gt; byte has active byte, the rest are inactive. If we illustrate this state and go through first round transformation, the state will end up exactly as the state in the first round of 2-round attack.&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;https://merricx.github.io/static/2fe969fa59e2aed2932e632035b17f88/6fc98/round3-1.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 45.94594594594595%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABqUlEQVR42oWSS2/TUBCF/Zf5AyzZsewCsUFIIAQSqy4QCKrCghRQQ7tASUniR/xI7MSOH0munx9z3UaKUBEjzWLmzpxz5ugaHEVaKVZFhtrv+7qkZRoFmLMZeZ73PSePGU8nhMsldJDLzo1r47seu90OYy/LeXE7fDr5yZsfn3EmArBJGa8DTr6+wzVtXN+jqSqeXp0zuB7i2DZULS9GFzz88pbEDQhXK4woigiCgKZpSJONDDpYlkUcx2ySBMe0sGXZdd1eZegHjEcjJrMpqJonwzMefHzJypwTiGrj+ORMFnzfx/M8tqK8LEtMAbclD6SaSBMuQzm5bvkWWrz6NWCzjCi2W4yu62jbtgdsxAO1XrNxHLLFgr1SaEsOqaTWJHVdU969qd1ttoKjo1fYw0n9+vKM55fn2OPfRPO5nKT4X5hJyIV9QyGep1mG4Yk37iKAJOfx8D2PBqfEc59IDO6KQvOgr7gvdeTbAk/siNcxiXhuaPmqrvrHZ8NPnHz/wMJ2CQOfThQeAP+OQ69UJbko0+f33+Z4qBZFOlsxt05Tujtv7wP8V/8P+iGqq4YtpjEAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;round3 1&quot;
        title=&quot;&quot;
        src=&quot;https://merricx.github.io/static/2fe969fa59e2aed2932e632035b17f88/fcda8/round3-1.png&quot;
        srcset=&quot;https://merricx.github.io/static/2fe969fa59e2aed2932e632035b17f88/12f09/round3-1.png 148w,https://merricx.github.io/static/2fe969fa59e2aed2932e632035b17f88/e4a3f/round3-1.png 295w,https://merricx.github.io/static/2fe969fa59e2aed2932e632035b17f88/fcda8/round3-1.png 590w,https://merricx.github.io/static/2fe969fa59e2aed2932e632035b17f88/efc66/round3-1.png 885w,https://merricx.github.io/static/2fe969fa59e2aed2932e632035b17f88/c83ae/round3-1.png 1180w,https://merricx.github.io/static/2fe969fa59e2aed2932e632035b17f88/6fc98/round3-1.png 2161w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;Okay, so the only problem now is how can we bypass this &lt;code class=&quot;language-text&quot;&gt;SubBytes&lt;/code&gt; in the first round?&lt;/p&gt;
&lt;p&gt;We can guess one byte of $RK_0$ for every possible values denoted by $GK_0$ and then apply 1 round transformation to the plaintext $(p_1, p_2)$ through $ARK$, $SB$, $SR$, and $MC$ independently (note that we apply $ARK$ of round 0, instead of round 1). After that, we create differential of transformed $(p_1, p_2)$ denoted by $\alpha$ and finally we are in the same situation as the previous 2-round attack.&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;https://merricx.github.io/static/4233894c210027914dd18b6c83b4910e/65c7e/round3-2.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 47.2972972972973%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB0ElEQVR42lVSzW6bQBjkPfsIfYn0DXrpG/QSqadIzaGS1UOatqnkqKnTggkYAmYBwwI1YGAxO/12Y8fpSivtzzezszOfka9mYIyh73sAEschqiXWD98RJxkmOm7jb3CsnyjKmsp6JPYnBGGIpml0vZRST8OaX8CyTGw2GYQQ4DzHICYw7xbW3RXCNUPOC0TONcz7W/hhgm3mwLp4BXe1QpZlJOMkxGAJRxRFaNsWchxR1zWmacK26UgBQ5qm2O12qLYdPM9HuuGY+hzh1zcaV1aVJhpJjMIZQgyY9nvUBIpnM4S2jTTPSf50+MbhaXlSoQkI05AINT48zHGzvEeZcxjHAsXOyBPLNPEYBM9AxSNfkB3X4yjAkoSAwOurc3z8dYNtXsDoenkokugoGM45GV1DjCAv5XNQO6ob96e9EHu6H/T60l9g7pj4WxDh5ecAvv+Iqir1ZdM8fWNhFbj+4YHnKYa+xZd5gcVvD1WZkZ8j3r13qTti8rA8qVehuK5LZnuI41i3jlI4DALROoRtLzWoKEqkCaO9jSSJwNItzt4uEAQhpbzRRPLJGxgVpaT6UCX5n+mUeBQxnaTyt+t6OI5LinPt692fTBOqrnjZh/8AyvWouzl5bEIAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;round3 2&quot;
        title=&quot;&quot;
        src=&quot;https://merricx.github.io/static/4233894c210027914dd18b6c83b4910e/fcda8/round3-2.png&quot;
        srcset=&quot;https://merricx.github.io/static/4233894c210027914dd18b6c83b4910e/12f09/round3-2.png 148w,https://merricx.github.io/static/4233894c210027914dd18b6c83b4910e/e4a3f/round3-2.png 295w,https://merricx.github.io/static/4233894c210027914dd18b6c83b4910e/fcda8/round3-2.png 590w,https://merricx.github.io/static/4233894c210027914dd18b6c83b4910e/efc66/round3-2.png 885w,https://merricx.github.io/static/4233894c210027914dd18b6c83b4910e/c83ae/round3-2.png 1180w,https://merricx.github.io/static/4233894c210027914dd18b6c83b4910e/65c7e/round3-2.png 2577w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;From here, the flow is relatively same as 2-round attack where we generate bunch of impossible state from $\alpha$ through second round resulting the list of impossible state.&lt;/p&gt;
&lt;p&gt;Then, we guess another one byte of $RK_3$ denoted by $GK_3$, inverse pair of ciphertext $(c_1, c_2)$ in the third round through $MC^{-1}$, $ARK$, $SR^{-1}$, $SB^{-1}$ independently and create differential from those pair denoted by $\beta$. Compare $\beta$ with the impossible state, if $\beta$ exist in one of the impossible state, we add $GK_3$ to the list of impossible key. &lt;/p&gt;
&lt;p&gt;We can determine whether $GK_0$ is the correct guess or not by looking at the number of $GK_3$ that added to the impossible keys. If in any byte position, impossible keys contain all possible bytes, then $GK_0$ is incorrect, otherwise $GK_0$ is correct.&lt;/p&gt;
&lt;p&gt;After impossible keys of all byte position in $RK_3$ discarded, we enumerate the remaining key, apply $MC$ and perform inverse key schedule to reverse $RK_3$ to $RK_0$ and check if the key is correct via trial encryption/decryption.&lt;/p&gt;
&lt;p&gt;Although the chosen-plaintext required in this attack is the same with the previous attack (~10 $\alpha$), the time complexity in this attack is at least $2^8$ times higher than the previous attack since we guess 2 bytes at a time. Moreover, for each guess of $GK_0$, we need to regenerate the impossible state again. But this attack is still quite fast and running this on my laptop only take less than 5 minutes on average.&lt;/p&gt;
&lt;h1 id=&quot;conclusion&quot;&gt;&lt;a href=&quot;#conclusion&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Conclusion&lt;/h1&gt;
&lt;p&gt;That’s all, we successfully broke 1-round AES until 3-round AES with differential cryptanalysis. We start ourselves looking at the differential property of AES S-Box and then able to exploit those property to recover the key round by round. &lt;/p&gt;
&lt;p&gt;Although there are many of more sophisticated and more advanced attacks on higher round, AES is still remain secure in full round. &lt;/p&gt;
&lt;p&gt;Lastly, all python implementation of these attacks can be found &lt;a href=&quot;https://github.com/Merricx/aes-attack&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;h1 id=&quot;references&quot;&gt;&lt;a href=&quot;#references&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;References&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Daemen, J. &amp;#x26; Rijmen, V. (1998). AES Proposal: Rijndael, NIST AES proposal.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Bouillaguet, C., Derbez, P., Dunkelman, O., Keller, N., Rijmen, V., &amp;#x26; Fouque, P.-A. (2010). Low Data Complexity Attacks on AES. Cryptology ePrint Archive, Paper 2010/633. &lt;a href=&quot;https://eprint.iacr.org/2010/633&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://eprint.iacr.org/2010/633&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
                &lt;div style=&quot;margin-top=55px; font-style: italic;&quot;&gt;You can read it online by &lt;a href=&quot;https://merricx.github.io/adventure-of-aes/&quot;&gt;clicking here&lt;/a&gt;&lt;/div&gt;
              </content:encoded></item><item><title><![CDATA[Don't Roll Your Own Crypto #1]]></title><description><![CDATA[The series of cryptanalyzing encryption scheme from local academic paper or article. This first series will discuss about cryptanalysis of image encryption based on Chaos function.]]></description><link>https://merricx.github.io/dont-roll-your-own-crypto-1/</link><guid isPermaLink="false">https://merricx.github.io/dont-roll-your-own-crypto-1/</guid><pubDate>Wed, 28 Jul 2021 15:42:00 GMT</pubDate><content:encoded>&lt;h1 id=&quot;introduction&quot;&gt;&lt;a href=&quot;#introduction&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Introduction&lt;/h1&gt;
&lt;p&gt;This is a series where I will try to reviewing and cryptanalyzing various cryptosystem schemes that proposed in academic journal, paper, and article from Universities in Indonesia.&lt;/p&gt;
&lt;p&gt;As written in the title, this article tries to emphasize the sentence “Don’t roll your own Crypto”, where we can’t just design or create our own cryptosystem algorithm. We should always use standarized algorithm for Cryptography. &lt;/p&gt;
&lt;p&gt;There’s absolutely no intention or whatsoever about humiliating the research that discussed here. In fact, this is how the process of proposing a cryptosystem scheme is carried out, where some party proposes an idea, and the other parties will try to find the weaknesses of that idea, until finally from these weaknesses, it can be developed into a better scheme and so on. &lt;/p&gt;
&lt;h1 id=&quot;chaos-based-image-encryption&quot;&gt;&lt;a href=&quot;#chaos-based-image-encryption&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Chaos-based Image Encryption&lt;/h1&gt;
&lt;p&gt;Cryptosystem that will be discussed in this first series is the study from article entitled &lt;strong&gt;“ANALISIS KEAMANAN ALGORITMA ENKRIPSI CITRA DIGITAL MENGGUNAKAN KOMBINASI DUA CHAOS MAP DAN PENERAPAN TEKNIK SELEKTIF”&lt;/strong&gt; written by Rinaldi Munir, that published on Jurnal Ilmiah Teknologi Informasi (JUTI) in 2012 &lt;sup&gt;&lt;a href=&quot;#references&quot;&gt;[1]&lt;/a&gt;&lt;/sup&gt;.&lt;/p&gt;
&lt;p&gt;The article discussed about image encryption by using two Chaos-based function, which is &lt;strong&gt;Arnold’s Cat Map&lt;/strong&gt; as permutation and &lt;strong&gt;Logistic Map&lt;/strong&gt; as keystream generator.&lt;/p&gt;
&lt;p&gt;In addition, the article also explained the use of “selective encryption” where the encryption only done on the first 4-bit (Most Significant Byte), while the last 4-bit (Least Significant Byte) of the image (after permutation) never change.&lt;/p&gt;
&lt;h2 id=&quot;arnolds-cat-map&quot;&gt;&lt;a href=&quot;#arnolds-cat-map&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Arnold’s Cat Map&lt;/h2&gt;
&lt;p&gt;Arnold’s Cat Map is Chaos Map function that shuffle pixels position (in &lt;code class=&quot;language-text&quot;&gt;(x,y)&lt;/code&gt; coordinate) of the image.&lt;/p&gt;
&lt;p&gt;The equation that used in the article is as follows.&lt;/p&gt;
$$
    \begin{bmatrix}
    x&apos; \\
    y&apos; \\
    \end{bmatrix}
    =
    \begin{bmatrix}
    1 &amp; p \\
    q &amp; pq + 1 \\
    \end{bmatrix}
    \begin{bmatrix}
    x \\
    y \\
    \end{bmatrix}
    \mod N
$$
&lt;p&gt;Where &lt;code class=&quot;language-text&quot;&gt;(x,y)&lt;/code&gt; is the inital position and &lt;code class=&quot;language-text&quot;&gt;(x&apos;, y&apos;)&lt;/code&gt; is the position after permutation. Meanwhile, &lt;code class=&quot;language-text&quot;&gt;N&lt;/code&gt; is the size of the image and this function will be iterated &lt;code class=&quot;language-text&quot;&gt;m&lt;/code&gt; times.&lt;/p&gt;
&lt;p&gt;So, the secret variables in this ACM function consists of &lt;code class=&quot;language-text&quot;&gt;p&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;q&lt;/code&gt;, and &lt;code class=&quot;language-text&quot;&gt;m&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;The following is the visualization of the image after ACM has been performed several times. It can be seen that the higher the &lt;code class=&quot;language-text&quot;&gt;m&lt;/code&gt; value, the more random-looking the result will be.&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;https://merricx.github.io/static/53cb714c13290142b14c7a0db1ebbb9d/9cab2/acm.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 76.35135135135135%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAAsTAAALEwEAmpwYAAACp0lEQVR42m2Se1MSYRTG/QrN9CH6LtV/zTjjaN7A5bYXQGRxEeUiahgXr4SJQ0y3CZrSaDJGTUlNmJQGL6ihIGmKEpVasu5CR5fGqHZ23nnnfd7fPs85Z0tyLJvP51fDY25T+SMr4jTVD/VaPA79W58jf/6MeB7azW0uu9XVb3XZbQO2jmR8A85zuVwJyzKwW5zzuUzCB1bZC3eX+87As3v9S7NPOdhubpfxyjQE0iwTNBEIKa5ejnyAc5ZlAT5zDkz4SbSqr1Pr6DITdUhtWfn4yxEOdvZaKIxvUKJtlNRAYhqZMLoUKYL9/oCcUBEiTIncEJVev3L5klzI5+DBntukuAYwA4m3qnA1Ube6vFgEv5mYrbopkmOUipB0thDCilKv28nBd7vPYH0DCuZ6JdYkFawt/3ZmmDPY5xu7eo3Hq0S1qkarkVLL8OnxQmyHzUSKqoFsV8t1CjGF8y9gaBrsDtLpueC81/PcP/r6lW94emrq8HuGg3d3tpPxzfD74ExgciseS2zGfv44LnSbu0FnT/Z3d2Lrq8nE5lp0Jb7x8ejwkJO+fc2kD1Kftz9tJ7fS+6n0/l42e8JJhZqD05PQUqOKgNqMjVI1Xuf5XbOz10xhPD2JQcE6haRJiqwsFo8KYJWkpqVe3CwXwQrDfOIevIBRnlYhgfMWgAkk+hccmpkCNwN8G7pK4mqM770/xMFDfeDMh0TAg6qRCv4P65WorkEC8SDnH7DlXMKB1ClRjewf+F1gQiGshBlCKpAVgorHroHCnLtMSlEV/Figgq0KrV2JhIvgyHzIalD3mfTdHVpYLQZqdNjLwRDB0qruuaXrbtf2dOhsRk1sPVqAuRsMw9B09vjoKLywkErtMcwpTdOFKdJZeLcSiVAomMl8OT2lWYbhpF9Tb4v39xdTigAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;acm&quot;
        title=&quot;&quot;
        src=&quot;https://merricx.github.io/static/53cb714c13290142b14c7a0db1ebbb9d/fcda8/acm.png&quot;
        srcset=&quot;https://merricx.github.io/static/53cb714c13290142b14c7a0db1ebbb9d/12f09/acm.png 148w,https://merricx.github.io/static/53cb714c13290142b14c7a0db1ebbb9d/e4a3f/acm.png 295w,https://merricx.github.io/static/53cb714c13290142b14c7a0db1ebbb9d/fcda8/acm.png 590w,https://merricx.github.io/static/53cb714c13290142b14c7a0db1ebbb9d/9cab2/acm.png 864w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;To inverse this process, just multiply &lt;code class=&quot;language-text&quot;&gt;(x&apos;, y&apos;)&lt;/code&gt; with the inverse matrix of $\begin{bmatrix} 1 &amp; p\\ q &amp; pq+1\\ \end{bmatrix}$.&lt;/p&gt;
&lt;h2 id=&quot;logistic-map&quot;&gt;&lt;a href=&quot;#logistic-map&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Logistic Map&lt;/h2&gt;
&lt;p&gt;Logistic Map is Chaos Map function from simple non-linear equation below.&lt;/p&gt;
$$
x_{i+1} = r x_i \left(1 - x_i\right)
$$
&lt;p&gt;Where defined constant &lt;code class=&quot;language-text&quot;&gt;r&lt;/code&gt; as real number in the interval of 0 to 4 and &lt;code class=&quot;language-text&quot;&gt;x0&lt;/code&gt; as random initial value in the interval of 0 to 1. These variables are kept secret.&lt;/p&gt;
&lt;p&gt;To generate keystream with Logistic Map, calculate the above equation which will be resulting &lt;code class=&quot;language-text&quot;&gt;x1, x2, x3, ...&lt;/code&gt; until the required length of keystream is met. Each value of &lt;code class=&quot;language-text&quot;&gt;x1, x2, x3, ...&lt;/code&gt; then will be represented as 4-bit key which is determined from the numbers after decimal point.&lt;/p&gt;
&lt;p&gt;For example, given a sequence of Logistic Map that is &lt;code class=&quot;language-text&quot;&gt;0.5, 0.875, 0.3828125, 0.8269348, ...&lt;/code&gt;, then we take the number after decimal point (with pre-defined precision, 4 in this case) so they become &lt;code class=&quot;language-text&quot;&gt;5, 875, 3828, 8269, ...&lt;/code&gt;. Change each of the number to binary and take the last 4-bit (LSB) resulting keystream as follows: &lt;code class=&quot;language-text&quot;&gt;0101, 1011, 0100, 1101, ...&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&quot;encryption&quot;&gt;&lt;a href=&quot;#encryption&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Encryption&lt;/h2&gt;
&lt;p&gt;The encryption stages are as follows:&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;https://merricx.github.io/static/0542cfc5a2b3327fcba64f6f6a9bd4c2/c1b63/encrypt.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 58.10810810810811%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsTAAALEwEAmpwYAAABp0lEQVR42pVRTUvDQBDtv/PgL9CbUKsIikoxVYk0JkUQqR686aUIinpQwY8olVZNrbbVkyA2lxLaYD6bNts0ralxdDEkIoKP7GbYeW9n3k7IdV2hXDjfTqQPd+7S+22kw4n7/u66+P8ZlJ+f9lIbBzupo92tFjK98xCsfPZ0lRxepcllkmgaiuP0ZFk2TbPZbNq2DYTsxcl0eHB+IkxOjeiaGhCn09eRobFoZHCgv0+oVNq2Lb2+gl5VVbhCkuVL9hiU8ehYYnbS0LWAOJPJj0aiyaXFzfWkhRpeDtDr9WC/z11RM+NriYUVas6o6wFx9+1NUVRJkjRNc7+B03hvtVp8+QUhk+d5x3E8Tsj1AeqIoigIgqIojUajXq9D26CEzmuiCFl4BX9fIa8ORrfbNQwD3AIVYqgDQafdVqtViGu1mr9YoDJGp9NBCHk3QiBXqyWWLRULZyxrWVbAs9+nruvgHNoGPfAw6YbjogRBkiRDM+DldzEATKIvwIShbUzK5W5jsRhFUTRN/yX+ATyqHMcRRIyKUwzD/EOMSeClWCw+PD7C5x/VBx8OhVkNSWO2AAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;encrypt&quot;
        title=&quot;&quot;
        src=&quot;https://merricx.github.io/static/0542cfc5a2b3327fcba64f6f6a9bd4c2/fcda8/encrypt.png&quot;
        srcset=&quot;https://merricx.github.io/static/0542cfc5a2b3327fcba64f6f6a9bd4c2/12f09/encrypt.png 148w,https://merricx.github.io/static/0542cfc5a2b3327fcba64f6f6a9bd4c2/e4a3f/encrypt.png 295w,https://merricx.github.io/static/0542cfc5a2b3327fcba64f6f6a9bd4c2/fcda8/encrypt.png 590w,https://merricx.github.io/static/0542cfc5a2b3327fcba64f6f6a9bd4c2/efc66/encrypt.png 885w,https://merricx.github.io/static/0542cfc5a2b3327fcba64f6f6a9bd4c2/c83ae/encrypt.png 1180w,https://merricx.github.io/static/0542cfc5a2b3327fcba64f6f6a9bd4c2/c1b63/encrypt.png 1200w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Define Plain-image &lt;code class=&quot;language-text&quot;&gt;P&lt;/code&gt;, secret key &lt;code class=&quot;language-text&quot;&gt;p&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;q&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;m&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;r&lt;/code&gt;, and &lt;code class=&quot;language-text&quot;&gt;x0&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;Permutate image &lt;code class=&quot;language-text&quot;&gt;P&lt;/code&gt; using Arnold’s Cat Map with &lt;code class=&quot;language-text&quot;&gt;p&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;q&lt;/code&gt;, and &lt;code class=&quot;language-text&quot;&gt;m&lt;/code&gt; as parameters, resulting image &lt;code class=&quot;language-text&quot;&gt;Px&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;Generate keystream &lt;code class=&quot;language-text&quot;&gt;K&lt;/code&gt; using Logistic Map with constant &lt;code class=&quot;language-text&quot;&gt;r&lt;/code&gt; and inital value &lt;code class=&quot;language-text&quot;&gt;x0&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;Encrypt 4-bit MSB each pixel of image &lt;code class=&quot;language-text&quot;&gt;Px&lt;/code&gt; with keystream &lt;code class=&quot;language-text&quot;&gt;K&lt;/code&gt; using XOR operation, resulting 4-bit &lt;code class=&quot;language-text&quot;&gt;Cx&lt;/code&gt; on each pixel.&lt;/li&gt;
&lt;li&gt;Combine 4-bit &lt;code class=&quot;language-text&quot;&gt;Cx&lt;/code&gt; with 4-bit LSB of image &lt;code class=&quot;language-text&quot;&gt;Px&lt;/code&gt; on each pixel, resulting Cipher-image &lt;code class=&quot;language-text&quot;&gt;C&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Implementation of this algorithm can be accessed in &lt;a href=&quot;https://github.com/Merricx/chaos-image-encryption/blob/main/encryption.py&quot; target=&quot;_blank&quot;&gt;this link&lt;/a&gt;.&lt;/p&gt;
&lt;h1 id=&quot;cryptanalysis&quot;&gt;&lt;a href=&quot;#cryptanalysis&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Cryptanalysis&lt;/h1&gt;
&lt;p&gt;Let’s just try to do the cryptanalysis against this encryption scheme.&lt;/p&gt;
&lt;p&gt;While conducting cryptanalysis, will be assumed some implementation scenario because the article didn’t define a specification of how the implementation should be done.&lt;/p&gt;
&lt;p&gt;Cryptanalysis model which we will use is &lt;strong&gt;Chosen-Plain image Attack&lt;/strong&gt;, where we can encrypt any image as much as we want and receive the coresponding cipher image.&lt;/p&gt;
&lt;h2 id=&quot;static-secret-key&quot;&gt;&lt;a href=&quot;#static-secret-key&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Static Secret Key&lt;/h2&gt;
&lt;p&gt;Let’s assume the implementation where secret key that consist of &lt;code class=&quot;language-text&quot;&gt;p&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;q&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;m&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;r&lt;/code&gt;, and &lt;code class=&quot;language-text&quot;&gt;x0&lt;/code&gt; are static and does not change in different encryption request.&lt;/p&gt;
&lt;h3 id=&quot;recovery-of-keystream&quot;&gt;&lt;a href=&quot;#recovery-of-keystream&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Recovery of Keystream&lt;/h3&gt;
&lt;p&gt;Because the value of &lt;code class=&quot;language-text&quot;&gt;r&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;x0&lt;/code&gt; always same, the result keystream generated from Logistic Map will also be same.&lt;/p&gt;
&lt;p&gt;That means, we can determine keystream &lt;code class=&quot;language-text&quot;&gt;K&lt;/code&gt; easily as long as we know cipher image &lt;code class=&quot;language-text&quot;&gt;C&lt;/code&gt; and the coresponding plain image that has been permutated by ACM (&lt;code class=&quot;language-text&quot;&gt;Px&lt;/code&gt;) because:&lt;/p&gt;
$$
C = Px \oplus K \\
K = C \oplus Px
$$
&lt;p&gt;But, here we still don’t know the value of &lt;code class=&quot;language-text&quot;&gt;Px&lt;/code&gt; (only 4-bit LSB that we know) because we don’t know value of &lt;code class=&quot;language-text&quot;&gt;p&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;q&lt;/code&gt;, and &lt;code class=&quot;language-text&quot;&gt;m&lt;/code&gt; of ACM.&lt;/p&gt;
&lt;p&gt;Well, because this is Chosen-Plain image Attack and we can encrypt any image, we can just use plain image where all of the pixels are same such as full-black image or full-white image.&lt;/p&gt;
&lt;p&gt;Because all of the pixels are same, the permutation from ACM will resulting same image too, so that we know &lt;code class=&quot;language-text&quot;&gt;Px&lt;/code&gt; and we can just find the keystream with XOR ¯\_(ツ)_/¯&lt;/p&gt;
&lt;p&gt;After we got the keystream, let’s find &lt;code class=&quot;language-text&quot;&gt;p&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;q&lt;/code&gt;, and &lt;code class=&quot;language-text&quot;&gt;m&lt;/code&gt;.&lt;/p&gt;
&lt;h3 id=&quot;recovery-of-m&quot;&gt;&lt;a href=&quot;#recovery-of-m&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Recovery of &lt;code class=&quot;language-text&quot;&gt;m&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;It should be noted that ACM process is actually quite costly in terms of hardware, where in one ACM iteration (&lt;code class=&quot;language-text&quot;&gt;m = 1&lt;/code&gt;) takes quite long time to finish, so the time difference in the value of &lt;code class=&quot;language-text&quot;&gt;m&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;m+1&lt;/code&gt; is quite noticable.&lt;/p&gt;
&lt;p&gt;This is actually dangerous because we can find out the value of &lt;code class=&quot;language-text&quot;&gt;m&lt;/code&gt; from &lt;strong&gt;Timing Attack&lt;/strong&gt;. The higher the &lt;code class=&quot;language-text&quot;&gt;m&lt;/code&gt; value is, the longer the ACM operation will take.&lt;/p&gt;
&lt;p&gt;The following is table of test results for the time required for the ACM process using &lt;code class=&quot;language-text&quot;&gt;m = 1&lt;/code&gt; to &lt;code class=&quot;language-text&quot;&gt;m = 5&lt;/code&gt; on a 1024x1024 image using my own laptop.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;m&lt;/th&gt;
&lt;th&gt;Time (s)&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;7.1236&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;13.8878&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;21.7516&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;27.8001&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;5&lt;/td&gt;
&lt;td&gt;35.2292&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;It can be seen on the table that time required for the ACM is relatively consistent on the multiple of 7 seconds. From this time result, we can find &lt;code class=&quot;language-text&quot;&gt;m&lt;/code&gt; only from the time it takes to encrypt an image.&lt;/p&gt;
&lt;p&gt;Actually from the start, keeping &lt;code class=&quot;language-text&quot;&gt;m&lt;/code&gt; secret is irrelevant, because after all, it is impossible that the value &lt;code class=&quot;language-text&quot;&gt;m&lt;/code&gt; would be too high, since it can bring performance issue if the value of &lt;code class=&quot;language-text&quot;&gt;m&lt;/code&gt; is too high. So, we can also just brute-force &lt;code class=&quot;language-text&quot;&gt;m&lt;/code&gt;.&lt;/p&gt;
&lt;h3 id=&quot;recovery-of-p-and-q&quot;&gt;&lt;a href=&quot;#recovery-of-p-and-q&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Recovery of &lt;code class=&quot;language-text&quot;&gt;p&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;q&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;After getting the value of &lt;code class=&quot;language-text&quot;&gt;m&lt;/code&gt;, finding &lt;code class=&quot;language-text&quot;&gt;p&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;q&lt;/code&gt; is trivial.&lt;/p&gt;
&lt;p&gt;The idea is that we will create plain image where all of the pixels contain value of black color (0), except for one pixel that will be white colored (255) or value other than 0.&lt;/p&gt;
&lt;p&gt;For example, we specify the white pixel on &lt;code class=&quot;language-text&quot;&gt;(1, 0)&lt;/code&gt;, then plain image with 4x4 size can be represented as the following matrix.&lt;/p&gt;
$$
\begin{pmatrix}
0 &amp; 255 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 \\
\end{pmatrix}
$$
&lt;p&gt;Enter the plain image into encryption oracle, get the corresponding cipher image, then decrypt it using keystream that we got before, so we have permutated plain-image.&lt;/p&gt;
&lt;p&gt;Lets assume the permutated plain image is as follows.&lt;/p&gt;
$$
\begin{pmatrix}
0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 255 &amp; 0 \\
\end{pmatrix}
$$
&lt;p&gt;Then, we can conclude that our previous pixel on &lt;code class=&quot;language-text&quot;&gt;(1, 0)&lt;/code&gt; move to &lt;code class=&quot;language-text&quot;&gt;(2, 3)&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Lets assume &lt;code class=&quot;language-text&quot;&gt;m = 3&lt;/code&gt;, then the equation of ACM will be as follows.&lt;/p&gt;
$$
    \begin{bmatrix}
    2 \\
    3 \\
    \end{bmatrix}
    =
    \begin{bmatrix}
    1 &amp; p \\
    q &amp; pq + 1 \\
    \end{bmatrix}^3
    \begin{bmatrix}
    1 \\
    0 \\
    \end{bmatrix}
    \mod N
$$
&lt;p&gt;It can be rewritten to:&lt;/p&gt;
$$
\begin{equation}
\begin{aligned}
2 &amp;\equiv \left( \left( p \cdot q + 1 \right) \cdot p + p \right) \cdot q + p \cdot q + 1 \pmod{N} \\ 
3 &amp;\equiv \left( \left( p \cdot q + 1 \right)^2 + p \cdot q \right) \cdot q + \left( p \cdot q + 1 \right) \cdot q + q \pmod{N}
\end{aligned}
\end{equation}
$$
&lt;p&gt;Where &lt;code class=&quot;language-text&quot;&gt;p&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;q&lt;/code&gt; can be found by solving linear equations in two variables (with modulus &lt;code class=&quot;language-text&quot;&gt;N&lt;/code&gt;).&lt;/p&gt;
&lt;p&gt;Finally, with the knowledge of keystream &lt;code class=&quot;language-text&quot;&gt;K&lt;/code&gt;, secret value &lt;code class=&quot;language-text&quot;&gt;p&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;q&lt;/code&gt;, and &lt;code class=&quot;language-text&quot;&gt;m&lt;/code&gt;, we can decrypt any image that was encrypted under this secret key :).&lt;/p&gt;
&lt;h3 id=&quot;proof-of-concept&quot;&gt;&lt;a href=&quot;#proof-of-concept&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Proof of Concept&lt;/h3&gt;
&lt;p&gt;Lets prove it by implementing it into Python.&lt;/p&gt;
&lt;p&gt;First, we define &lt;code class=&quot;language-text&quot;&gt;encryption_oracle()&lt;/code&gt; function which will be acting as a “server” where we can encrypt any image to that “server” and receive the corresponding cipher image.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; random&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; os
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; numpy &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; np
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; encryption
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; PIL &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; Image
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; Crypto&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Util&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;strxor &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; strxor

&lt;span class=&quot;token comment&quot;&gt;# Secret&lt;/span&gt;
p &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; random&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;randint&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;250&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
q &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; random&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;randint&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;250&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
m &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;
init &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; random&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;random&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
r &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; random&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;random&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;encryption_oracle&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;plain_image&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; encryption&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;encrypt&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;plain_image&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; p&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; q&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; m&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; init&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; r&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Then, write function to find keystream from chosen-plain image attack.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;recover_keystream&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;size&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;# Generate full-black image&lt;/span&gt;
    plain_image &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Image&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;new&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;RGB&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;size&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; size&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;# Send image to encryption oracle&lt;/span&gt;
    cipher_image &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; encryption_oracle&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;plain_image&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;# Convert plain_image and cipher_image to bytes&lt;/span&gt;
    plain_image_bytes &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;bytes&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;np&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;array&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;plain_image&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;flatten&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;tolist&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    cipher_image_bytes &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;bytes&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;np&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;array&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;cipher_image&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;flatten&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;tolist&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;# Recover 8-bit keystream&lt;/span&gt;
    k &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;strxor&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;plain_image_bytes&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; cipher_image_bytes&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;# Get 4-bit MSB keystream&lt;/span&gt;
    keystream &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; i &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;size&lt;span class=&quot;token operator&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        bit_len &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;k&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;i&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;bit_length&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; bit_len &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            msb &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; k&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;i&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;bit_len&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            msb &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;
        
        keystream&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;append&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;msb&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    

    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; keystream&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Then, write function to find &lt;code class=&quot;language-text&quot;&gt;m&lt;/code&gt; through Timing Attack.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;recover_m&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# avg. second of one encryption execution time (depends on the machine)&lt;/span&gt;
    one_exec_time &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt; 

    start_time &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; time&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;time&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    payload &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Image&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;new&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;RGB&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    encryption_oracle&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;payload&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    end_time &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; time&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;time&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    elapsed_time &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; end_time &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; start_time
    m &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;elapsed_time &lt;span class=&quot;token operator&quot;&gt;//&lt;/span&gt; one_exec_time&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;# Result could be faster or slower&lt;/span&gt;
    possible_m &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;m&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; m&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; m&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; possible_m&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Lastly, to find &lt;code class=&quot;language-text&quot;&gt;p&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;q&lt;/code&gt;, we will use &lt;strong&gt;Sagemath&lt;/strong&gt; with the &lt;code class=&quot;language-text&quot;&gt;solve_mod()&lt;/code&gt; function to solving linear equations in two variables as we discussed earlier.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;#!/usr/bin/env sage&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;recover_pq&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;m&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; x0&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; y0&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; x1&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; y1&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; N&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;

    var&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;p,q&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    xy &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; matrix&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;x0&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;y0&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    A &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; matrix&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;p&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;q&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; p&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;q &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    pos_result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; solve_mod&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;A&lt;span class=&quot;token operator&quot;&gt;^&lt;/span&gt;m &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; xy&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; x1&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;A&lt;span class=&quot;token operator&quot;&gt;^&lt;/span&gt;m &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; xy&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; y1
        &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; N&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; pos_result

&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; __name__ &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;__main__&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;

    m &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;7&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# ACM iteration&lt;/span&gt;
    x0 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
    y0 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;
    x1 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;489&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# x-coordinate after permutation&lt;/span&gt;
    y2 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;396&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# y-coordinate after permutation&lt;/span&gt;
    N &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;512&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# image size&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Possible p,q: &quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;recover_pq&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;m&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; x0&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; y0&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; x1&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; y2&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; N&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Full implementation of this attack can be found in &lt;a href=&quot;https://github.com/Merricx/chaos-image-encryption&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;this link&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&quot;static-secret-key-with-dynamic-x0&quot;&gt;&lt;a href=&quot;#static-secret-key-with-dynamic-x0&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Static Secret Key with Dynamic &lt;code class=&quot;language-text&quot;&gt;x0&lt;/code&gt;&lt;/h2&gt;
&lt;p&gt;The next implementation scenario is assumed that the variable &lt;code class=&quot;language-text&quot;&gt;p&lt;/code&gt;,&lt;code class=&quot;language-text&quot;&gt;q&lt;/code&gt;,&lt;code class=&quot;language-text&quot;&gt;m&lt;/code&gt;,&lt;code class=&quot;language-text&quot;&gt;r&lt;/code&gt; is static but the variable &lt;code class=&quot;language-text&quot;&gt;x0&lt;/code&gt; is dynamic, where this value will change randomly in different encryption request.&lt;/p&gt;
&lt;p&gt;This is the most ideal scenario that can possibly implemented in this scheme, because static keystream is no longer happened.&lt;/p&gt;
&lt;p&gt;However, the problem is how this &lt;code class=&quot;language-text&quot;&gt;x0&lt;/code&gt; can be associated in each of different images. One possible approach is to treat &lt;code class=&quot;language-text&quot;&gt;x0&lt;/code&gt; as Initialization Vector (IV) as we seen in block cipher. But, this value must still be encrypted again with certain method and listed in every image that has been encrypted using that value.&lt;/p&gt;
&lt;p&gt;Let’s ignore the technical side of how &lt;code class=&quot;language-text&quot;&gt;x0&lt;/code&gt; implemented. Our assumption in this scenario is that for every request to the encryption oracle, the value of &lt;code class=&quot;language-text&quot;&gt;x0&lt;/code&gt; will be arbitrary and random.&lt;/p&gt;
&lt;p&gt;Because repeated keystream can no longer be exploited, it will be difficult for us to finding the keystream from chosen-plain image attack, since this encryption basically becomes &lt;strong&gt;One-Time Pad&lt;/strong&gt;. &lt;/p&gt;
&lt;h3 id=&quot;recover-acm-secret&quot;&gt;&lt;a href=&quot;#recover-acm-secret&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Recover ACM secret&lt;/h3&gt;
&lt;p&gt;Then how can we find &lt;code class=&quot;language-text&quot;&gt;p&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;q&lt;/code&gt; without knowing the &lt;em&gt;keystream&lt;/em&gt; that currently used? &lt;/p&gt;
&lt;p&gt;This is where the security flaw from the use of &lt;strong&gt;“selective encryption”&lt;/strong&gt; occurs, where cipher image leaks information from the LSB of the plain image. &lt;/p&gt;
&lt;p&gt;Lets assume we use plain image that represented as follows:&lt;/p&gt;
$$
\begin{pmatrix}
0 &amp; 255 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 \\
\end{pmatrix}
$$
&lt;p&gt;Enter the plain image into encryption oracle. Then, suppose we get cipher image as follows.&lt;/p&gt;
$$
\begin{pmatrix}
32 &amp; 96 &amp; 176 &amp; 32 \\
112 &amp; 240 &amp; 112 &amp; 144 \\
32 &amp; 95 &amp; 192 &amp; 80 \\
176 &amp; 208 &amp; 48 &amp; 160 \\
\end{pmatrix}
$$
&lt;p&gt;Lets change each of the pixel to binary representation and boom!! &lt;em&gt;LSB oracle goes brrrr!&lt;/em&gt;&lt;/p&gt;
$$
\begin{pmatrix}
00100000 &amp; 01100000 &amp; 10110000 &amp; 00100000 \\
01110000 &amp; 11110000 &amp; 01110000 &amp; 10010000 \\
00100000 &amp; 01011111 &amp; 11000000 &amp; 01010000 \\
10110000 &amp; 11010000 &amp; 00110000 &amp; 10100000 \\
\end{pmatrix}
$$
&lt;p&gt;Because of this selective encryption scheme, we still know the position of our white pixel after the permutation because 4-bit LSB of the plain image never changes (just looks 4-bit LSB that doesn’t have the value &lt;code class=&quot;language-text&quot;&gt;0000&lt;/code&gt;). &lt;/p&gt;
&lt;p&gt;Just continue using the same method as the previous scenario by solving the linear equations of two variables to find &lt;code class=&quot;language-text&quot;&gt;p&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;q&lt;/code&gt; (value of &lt;code class=&quot;language-text&quot;&gt;m&lt;/code&gt; can still be found through Timing Attack). &lt;/p&gt;
&lt;p&gt;Next, how can we find dynamic &lt;em&gt;keystream&lt;/em&gt; value? Meanwhile One-Time Pad is an “unbreakable cipher”. &lt;/p&gt;
&lt;h3 id=&quot;weak-logistic-map&quot;&gt;&lt;a href=&quot;#weak-logistic-map&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Weak Logistic Map&lt;/h3&gt;
&lt;p&gt;The only thing we can try to exploit is from the implementation of Logistic Map. &lt;/p&gt;
&lt;p&gt;Analysis of how Logistic Map works is beautifully explained in &lt;u&gt;geoffboeing.com&lt;/u&gt; &lt;sup&gt;&lt;a href=&quot;#references&quot;&gt;[2]&lt;/a&gt;&lt;/sup&gt;. Interestingly, there are several things that can make the generation results of Logistic Map repetitive and periodic if the constant &lt;code class=&quot;language-text&quot;&gt;r&lt;/code&gt; and the initial value &lt;code class=&quot;language-text&quot;&gt;x0&lt;/code&gt; are not picked carefully. &lt;/p&gt;
&lt;p&gt;Let’s try to do a little experiment using the implemented Logistic Map based on this article in generating keystream. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; random
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; encryption

&lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; i &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    init &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; random&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;random&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    r &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; random&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;randint&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; random&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;random&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;x0:&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; init&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;r :&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; r&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;keystream&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; encryption&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;logistic_map&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;init&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; r&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Running the script and take some interesting result.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;x0: 0.7244972999777215
r : 2.2929146462509595
keystream: [7, 2, 15, 3, 5, 14, 0, 9, 1, 15, 7, 10, 0, 11, 10, 14, 6, 4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]

x0: 0.18893176526337663
r : 1.6653541535673568
keystream: [4, 9, 3, 1, 9, 7, 10, 8, 15, 15, 11, 7, 2, 15, 6, 12, 0, 8, 5, 15, 8, 11, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12]

x0: 0.8927173285063715
r : 3.5157732279084075
keystream: [5, 13, 12, 12, 14, 5, 4, 0, 8, 0, 5, 8, 10, 0, 2, 11, 9, 0, 9, 7, 15, 2, 5, 14, 1, 2, 10, 15, 14, 11, 9, 15, 0, 9, 15, 7, 7, 13, 15, 1, 3, 11, 0, 2, 2, 1, 0, 15, 13, 2, 6, 15, 4, 8, 4, 12, 0, 2, 12, 1, 5, 6, 6, 12, 8, 0, 10, 5, 8, 15, 4, 10, 0, 4, 1, 4, 9, 1, 2, 0, 6, 8, 2, 1, 7, 5, 2, 1, 6, 6, 2, 1, 7, 6, 2, 1, 6, 6, 2, 1, 7, 6, 2, 1, 6, 6, 2, 1, 6, 6, 2, 1, 6, 6, 2, 1, 6, 6, 2, 1, 6, 6, 2, 1, 6, 6, 2, 1, 6, 6, 2, 1, 6, 6, 2, 1, 6, 6, 2, 1, 6, 6, 2, 1, 6, 6, 2, 1, 6, 6, 2, 1]&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;As we can see from the generated keystream above, the Logistic Map produces sequence that is truly repetitive both statically and periodically.&lt;/p&gt;
&lt;p&gt;Based from the experiment, we can note some value in the constant &lt;code class=&quot;language-text&quot;&gt;r&lt;/code&gt; that will potentially cause repetitive keystream.&lt;/p&gt;
&lt;p&gt;The list of constants &lt;code class=&quot;language-text&quot;&gt;r&lt;/code&gt; that potentially generate a static &lt;em&gt;keystream&lt;/em&gt; is: &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;1.1 ~ 2.4
2.6 ~ 2.8
3.3&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Whereas, The list of constants &lt;code class=&quot;language-text&quot;&gt;r&lt;/code&gt; that potentially generate periodic &lt;em&gt;keystream&lt;/em&gt; is: &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;2.5
2.9
3.1
3.2
3.4
3.5&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;From the two phenomena above, it can be concluded that the key space in choosing the constant &lt;code class=&quot;language-text&quot;&gt;r&lt;/code&gt; is increasingly limited to avoid repeated keystream, both statically and periodically. &lt;/p&gt;
&lt;p&gt;So, the constant &lt;code class=&quot;language-text&quot;&gt;r&lt;/code&gt; that might be chosen to avoid repetition is to choose one of the following values. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;1.0~
3.0~
3.6~
3.7~
3.8~
3.9~&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;For the values of 0.9 and below are ignored because after several generation process, the sequence will tend to 0 values, so it can’t generate large keystream.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;So, to get dynamic keystream from the Logistic Map, first we check whether there are repetition in the pixels of the cipher image (especially at the bottom pixels). For static repetition, we simply brute-force 1 out of 16 possible values, while for periodic repetition, we simply brute-force 2 to 4 out of 16 possible values. &lt;/p&gt;
&lt;p&gt;If there is no sign of repetition of the keystream bit, we can brute-force to find the value of the constant &lt;code class=&quot;language-text&quot;&gt;r&lt;/code&gt; from a list of possible values that will not cause repetition previously along with the initial value of &lt;code class=&quot;language-text&quot;&gt;x0&lt;/code&gt;. &lt;/p&gt;
&lt;h3 id=&quot;proof-of-concept-1&quot;&gt;&lt;a href=&quot;#proof-of-concept-1&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Proof of Concept&lt;/h3&gt;
&lt;p&gt;Implementation of this attack can be accessed in &lt;a href=&quot;https://github.com/Merricx/chaos-image-encryption&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;this link&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&quot;conclusion&quot;&gt;&lt;a href=&quot;#conclusion&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Conclusion&lt;/h1&gt;
&lt;p&gt;From the two implementation scenarios that discussed above, it can be concluded that this Chaos-based Image Encryption is truly vulnerable to Chosen-Plain image Attack (Known-Plain image Attack can also viable in some conditions). &lt;/p&gt;
&lt;p&gt;Both the Arnold’s Cat Map, Logistic Map, as well as the use of the selective encryption are vulnerable that can make &lt;em&gt;attacker&lt;/em&gt; decrypt any encrypted image without access to the secret key that is currently used. Lastly, further development needs to be studied to produce even better algorithm, especially in terms of security. &lt;/p&gt;
&lt;h1 id=&quot;references&quot;&gt;&lt;a href=&quot;#references&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;References&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;Munir, Rinaldi. (2012). ANALISIS KEAMANAN ALGORITMA ENKRIPSI CITRA DIGITAL MENGGUNAKAN KOMBINASI DUA CHAOS MAP DAN PENERAPAN TEKNIK SELEKTIF. JUTI: Jurnal Ilmiah Teknologi Informasi. 10. 89. 10.12962/j24068535.v10i2.a310.  &lt;/li&gt;
&lt;li&gt;Boeing, G. (2016). Visual Analysis of Nonlinear Dynamical Systems: Chaos, Fractals, Self-Similarity and the Limits of Prediction. Systems, 4 (4), 37. doi:10.3390/systems4040037&lt;/li&gt;
&lt;/ol&gt;
                &lt;div style=&quot;margin-top=55px; font-style: italic;&quot;&gt;You can read it online by &lt;a href=&quot;https://merricx.github.io/dont-roll-your-own-crypto-1/&quot;&gt;clicking here&lt;/a&gt;&lt;/div&gt;
              </content:encoded></item><item><title><![CDATA[[NahamConCTF 2021] - Elliptical]]></title><description><![CDATA[Write-up Elliptical - NahamConCTF 2021]]></description><link>https://merricx.github.io/nahamconctf-elliptical/</link><guid isPermaLink="false">https://merricx.github.io/nahamconctf-elliptical/</guid><pubDate>Sun, 14 Mar 2021 20:00:00 GMT</pubDate><content:encoded>&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;https://merricx.github.io/static/a01a38a0dcad4599e0852243d8d126fc/39a20/challs.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 39.189189189189186%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABTklEQVR42n2Qy07EMAxF+wuIoemLNkmbtNN2+mTQwPCQeCzYwYol//8Vl9hlYIQEi6N77ViOba9+aPD0/oj+ucfN6x7m1uJsEBBjsDCFCMYQiYPy/hCw/oXXUaO3Par7EtuXGXqfQ+4k8muN9DJFvMswXxl83M04GXz47pP/8FbnAqeJDyEjR4hQxYh0whpwLmKfqIT9IffbH/CyTMGYEnlhURjLXqocZ777UYQM+dVR/JNfVASueRAzXpJmUHkOpRckKcV5gUxphmKp3Qmk+s4teapRCKIYIopYPSoq12sU1qJqava2rFDV9TJxWaJa1zDWbWEMvxFUXzcNv4WxO0f41ZAKx3nCpu1ghURbtximEZuuRz8M2PQ9hnFkP80zeufbrsPFdstvvmt0aEbqVk6hi8Ldza0RZ5ByWeVwAu08TUmelGI6iy4Mx8fTEZ/ZduBOuUBEnQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;challs&quot;
        title=&quot;&quot;
        src=&quot;https://merricx.github.io/static/a01a38a0dcad4599e0852243d8d126fc/fcda8/challs.png&quot;
        srcset=&quot;https://merricx.github.io/static/a01a38a0dcad4599e0852243d8d126fc/12f09/challs.png 148w,https://merricx.github.io/static/a01a38a0dcad4599e0852243d8d126fc/e4a3f/challs.png 295w,https://merricx.github.io/static/a01a38a0dcad4599e0852243d8d126fc/fcda8/challs.png 590w,https://merricx.github.io/static/a01a38a0dcad4599e0852243d8d126fc/39a20/challs.png 859w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;h1 id=&quot;challenge&quot;&gt;&lt;a href=&quot;#challenge&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Challenge&lt;/h1&gt;
&lt;p&gt;Given website where user can sign in with any username, except with username &lt;code class=&quot;language-text&quot;&gt;admin&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;https://merricx.github.io/static/591ea1bf0302fb20cd2300e4931b0ec6/fe9e8/4.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 50.67567567567568%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA3UlEQVR42p1Syw7CIBD0/z/LGGuiZzV6s60HH23tAygUxgWrVm0juslkA8wOswsjdMIY85KHwp4PcUdDRCklGGMQQoAz7rJbc/GfIOMc680WYRwjy3OHU5K4/OD6CKIVNU0DlRdoyhIQNUDOLAy5tWdd7leHlqIrhmy2QDKb4zgJcBhPcQ7mSGlPF+XDnZ9DK0gzk7sIKtrjstogW64hw5j2Qmjr0lfwDk2oqLBsi22kHDhUQN2gbddnhh1hpZSD1hqGUCsDJukybX54lJ5WnusbvL/NO+FT+IY+7j2u3GgUEIqIkD0AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;4&quot;
        title=&quot;&quot;
        src=&quot;https://merricx.github.io/static/591ea1bf0302fb20cd2300e4931b0ec6/fcda8/4.png&quot;
        srcset=&quot;https://merricx.github.io/static/591ea1bf0302fb20cd2300e4931b0ec6/12f09/4.png 148w,https://merricx.github.io/static/591ea1bf0302fb20cd2300e4931b0ec6/e4a3f/4.png 295w,https://merricx.github.io/static/591ea1bf0302fb20cd2300e4931b0ec6/fcda8/4.png 590w,https://merricx.github.io/static/591ea1bf0302fb20cd2300e4931b0ec6/efc66/4.png 885w,https://merricx.github.io/static/591ea1bf0302fb20cd2300e4931b0ec6/fe9e8/4.png 1146w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;After signed in, website will show simple static text and image that shown below and the bottom text that says “Sorry, only admin can see the flag”.&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;https://merricx.github.io/static/c5eeb684cc56b7f78d5e8715d228d346/d5c6f/1.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 70.27027027027026%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAABbklEQVR42o2S2XLCMAxF+/9/xTsvbVPaEmCSgJOULJRmcTb7VnJZXEohmtHIY8vXR5IfQKa1Ns42DAM838dyuYIQIYJgjSiK4fsB0jSDUgp936Prul/3jvHhmmAYRUZksxGI4tis2UUYIgwjc15W1XjBJE2RZhmSJMU2SYzzuiKRtm0hm8bk2UK3BUmAifI8R13XRoi9KAryEmVZ0r68LWhHvsxCUkp6QOHSuH9MeleQG84mhMB0OsVkMsFq4QG9gpY1QKVqGojjOHDn83GENiWXvN8XaErqHZWriJjwDH1D4rg1FFvQ7idT6wM9l6kOZ5cAowSrokZfE0nXGrKOqPgPXsu9K8g7A11uqMyWhBqi42GYvJ/kcYL/mRmY/eA9weNGy00nmoqoOLKXUp7JLNNjPrbMciTPM3w8vSBxXrF1ZogfHTT+Gn0Yn11EUPTJ7fKvE+52+Hp3UbhLiotT/HxzUXvByauVhzbf/Zn2N1oDRaI5fju5AAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;1&quot;
        title=&quot;&quot;
        src=&quot;https://merricx.github.io/static/c5eeb684cc56b7f78d5e8715d228d346/fcda8/1.png&quot;
        srcset=&quot;https://merricx.github.io/static/c5eeb684cc56b7f78d5e8715d228d346/12f09/1.png 148w,https://merricx.github.io/static/c5eeb684cc56b7f78d5e8715d228d346/e4a3f/1.png 295w,https://merricx.github.io/static/c5eeb684cc56b7f78d5e8715d228d346/fcda8/1.png 590w,https://merricx.github.io/static/c5eeb684cc56b7f78d5e8715d228d346/efc66/1.png 885w,https://merricx.github.io/static/c5eeb684cc56b7f78d5e8715d228d346/c83ae/1.png 1180w,https://merricx.github.io/static/c5eeb684cc56b7f78d5e8715d228d346/d5c6f/1.png 1261w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;Based on that observation, we can conclude that in this challenge, we must change our username to &lt;code class=&quot;language-text&quot;&gt;admin&lt;/code&gt; by exploiting “some crypto magic”.&lt;/p&gt;
&lt;p&gt;So, what is the indicator that used by website so that it knows who is currently accessing the page?&lt;/p&gt;
&lt;h1 id=&quot;jwt&quot;&gt;&lt;a href=&quot;#jwt&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;JWT&lt;/h1&gt;
&lt;p&gt;Of course, the most common mechanism to store information about the user that currently accessing a website is called &lt;strong&gt;cookie&lt;/strong&gt;.&lt;br&gt;
In this challenge, cookie is used in the form of JSON Web Token (JWT) to store the information about current user.&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;https://merricx.github.io/static/57c0bedc7300c830ff4f512dc65dc40e/1ddef/3.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 125.67567567567568%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAZCAYAAAAxFw7TAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADNElEQVR42qWUyY4URxCG8yVsmTfgYgn5YMtIfgM/FByRJVuyLfnGK3DGByQLfLOAWXBPd83SSy1dmbV2ZVZVZi2/I5PuGQ9MAxpK/XUulcsfURHBJssMT18c4MXrUzw/uMAyH7DI+ivyLdRfUrsqiPx9/HLE8WQG9vVPHD/8UeLHxznu/Zzg+99SIsG3v6b4jrBz3/yS4P7vKe4+EvjyAcedhxxfbbnjiPHFA4HHf/4L9veE48lfb/Ds1QJP/5nj2UGIEz7gODJEd8W6wxG1h6G5kaOox8ujEzBZJJi+OUQuIsTBAsnaBzDiNs86CsFiLnBweIyTqeewfT+I3JH9MH4U+l1eX1UVWJqmCIIAQgjkeY6yLJFl+V4V4zheQ2vt9ti9nHOwoihQ1zVkJaGo7fuB6N3CdzHGoOt6otvSu8utGHsYJ2uZ7/uYzWbwPM9h+7vxbOZdzk+nU6xWK0gpsdlsiMphx0opJ8qqZPZPSeXst1h1exkGDB/AWseESBBEkTPXmrSP7v9jvWcdzTPrg8YrINcKK6EQcGpjiYuwwjyqECUKi7XEkuZ43rh+lNQIxdt5u9bn0vUFvWe6bbCpBpzFBn7SwI8VbVaY0wUhbfRFjYtIOlpNH6QfHdoMl5iO2i3M0IFpM+KccjUuDU4jhfNQ4iwghXTrOm1QSPPJwc2MbiDkiJno4GcdqerAZQ+eNWRi62JtF3/DOzF4E05hVo+Y0IGct8BSflTF7pK9ClM14pSULYShfKQLNhoxKbQ+TMrWYdUG5M+67a9lzPsHWh+SQj/TkHpAS8nZmt59gIbYOd6O7WE2f68OvEGh3prskcki1YgobHYqPjWfr/mwMy3IOsyp6tZBjaHub1m8tgrLsqAg3eDcTxAnOXpKemNuD+M8QU4lLE8TVzk0pU/bbtFb2utz+gMwKSsoPaLSgGlrctCAz3lY29QoyG9zTim2IrMzhZhCxGaIC5mideGzw4aTjYJ9H4c1TeNeRqnNWQXPr3BKTOala2erDdJSY6MMSkpBWVNh7fdbwWxZolxHSIo82mzz+CJ8WwzOAiK01aTGmpRVdedUClId0Xo7b3FFhFo79x+Lm3KJ8iB2UQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;3&quot;
        title=&quot;&quot;
        src=&quot;https://merricx.github.io/static/57c0bedc7300c830ff4f512dc65dc40e/fcda8/3.png&quot;
        srcset=&quot;https://merricx.github.io/static/57c0bedc7300c830ff4f512dc65dc40e/12f09/3.png 148w,https://merricx.github.io/static/57c0bedc7300c830ff4f512dc65dc40e/e4a3f/3.png 295w,https://merricx.github.io/static/57c0bedc7300c830ff4f512dc65dc40e/fcda8/3.png 590w,https://merricx.github.io/static/57c0bedc7300c830ff4f512dc65dc40e/1ddef/3.png 635w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;Basically, JSON Web Token consists of 3 main parts, which is &lt;strong&gt;header&lt;/strong&gt;, &lt;strong&gt;payload&lt;/strong&gt;, and &lt;strong&gt;signature&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;https://merricx.github.io/static/8e15af8a4abfbf7d8850c3b20b565563/d0fa6/jwt.io.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 65.54054054054055%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAABbUlEQVR42o2TC2+CMBSF/f//b9mWOBM3mYIEgT7o47Znt0URx9SRfJQWenrug5UxBsVhj1b2IMRMBDLzq65rFLsdhmGAcw5ElNdjjDesYgigqkMse2DPlAKoJI8SltecMnmjVhpKqyzmvV8ITYKBBY+tx/eRUJQeReVRVQTTEBrhoXxINoDA9CwuDe5dWZD4tjEBr5oZxrGmiBMLuNmHllPjGLCBe+7GkGeTcGZ25PTOOQ/vOMPJcHgiiBgX1i9Mcw49cATR8Jp/EPK0+Z7Q+fkkJD7rBpKrbKyFMRbWXkndkuqx+i2wdDqG3qoBb43CRyOxPUn0fIBgpBwRQuTqPxc851IMBh+SsFGELw77IDS6tuVW4nZSKoum3vy3w04brKXHYSDsuSuO2mZXWeyR4IKZw3fuyxdBWOuIXafQtqfs8BL2QvDPyuHqcKsJtWV3Lo4O+34KN3GTw2codlhy3hIpf7XU/DuqLHghOfwBZaL8i2fimCsAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;jwt io&quot;
        title=&quot;&quot;
        src=&quot;https://merricx.github.io/static/8e15af8a4abfbf7d8850c3b20b565563/fcda8/jwt.io.png&quot;
        srcset=&quot;https://merricx.github.io/static/8e15af8a4abfbf7d8850c3b20b565563/12f09/jwt.io.png 148w,https://merricx.github.io/static/8e15af8a4abfbf7d8850c3b20b565563/e4a3f/jwt.io.png 295w,https://merricx.github.io/static/8e15af8a4abfbf7d8850c3b20b565563/fcda8/jwt.io.png 590w,https://merricx.github.io/static/8e15af8a4abfbf7d8850c3b20b565563/efc66/jwt.io.png 885w,https://merricx.github.io/static/8e15af8a4abfbf7d8850c3b20b565563/c83ae/jwt.io.png 1180w,https://merricx.github.io/static/8e15af8a4abfbf7d8850c3b20b565563/d0fa6/jwt.io.png 1263w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;header&lt;/strong&gt; contains the information about algorithm that is used to sign and build &lt;strong&gt;signature&lt;/strong&gt; part. &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;payload&lt;/strong&gt; contains main information about the user that currently accessing the web.&lt;/p&gt;
&lt;p&gt;And then, &lt;strong&gt;signature&lt;/strong&gt; is the hash result of &lt;strong&gt;header&lt;/strong&gt; and &lt;strong&gt;payload&lt;/strong&gt; (Base64-encoded and concatenated by dot) using algorithm that defined by &lt;strong&gt;alg&lt;/strong&gt; in &lt;strong&gt;header&lt;/strong&gt; part.&lt;/p&gt;
&lt;p&gt;This &lt;strong&gt;signature&lt;/strong&gt; then is used as verification whether data on &lt;strong&gt;header&lt;/strong&gt; or &lt;strong&gt;payload&lt;/strong&gt; has been modified or not. If data on &lt;strong&gt;header&lt;/strong&gt; or &lt;strong&gt;payload&lt;/strong&gt; has been modified or forged, then the result of &lt;strong&gt;signature&lt;/strong&gt; will not be the same, thus the token will be considered invalid.&lt;/p&gt;
&lt;p&gt;Every part of JWT will be encoded with Base64Url and separated with dot sign (&lt;strong&gt;.&lt;/strong&gt;).&lt;/p&gt;
&lt;p&gt;In this challenge, the hash algorithm use &lt;strong&gt;ES256&lt;/strong&gt; or &lt;strong&gt;ECDSA-SHA256&lt;/strong&gt;. On the &lt;strong&gt;payload&lt;/strong&gt; part, it only contains &lt;code class=&quot;language-text&quot;&gt;username&lt;/code&gt; of the current user.&lt;/p&gt;
&lt;h1 id=&quot;vulnerability-analysis&quot;&gt;&lt;a href=&quot;#vulnerability-analysis&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Vulnerability Analysis&lt;/h1&gt;
&lt;p&gt;If we pay attention to the signing process in this web, there’s an oddity on the resulting &lt;strong&gt;signature&lt;/strong&gt; after we signed in multiple times, as shown below.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;Username: admin1
wN0kGlDUj5n8x6GGptROB2PskEeOHe-ONvXE6VDWevsS2fyKPc817Sox60QP-jgXhlM0kVkjKFhk-VUgMSOYjg


Username: some random username
wN0kGlDUj5n8x6GGptROB2PskEeOHe-ONvXE6VDWevuVkYXwniERimgSFQ2cea0-BUwYCLQ60reeuAIyROAxkw


Username: hehehe
wN0kGlDUj5n8x6GGptROB2PskEeOHe-ONvXE6VDWevsfeMT3XhGF_QCc2Ed1V1V9-F5VPrPSakhNGecWfgQQbw&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Yupp, there’s big repeating signature result even with completely different username.&lt;/p&gt;
&lt;p&gt;A secure hash algorithm when there’s little input difference, even only 1 byte, it should produce a completely different hash result. But in this web, the first 64 byte on the resulting signature never change.&lt;/p&gt;
&lt;p&gt;Other than that, if we repeat the signing process with same username, the resulting signature also never change.&lt;/p&gt;
&lt;p&gt;Whereas, algorithm in ES256 or ECDSA is asymmetric algorithm that even the same message should produce different signature because the random property in it.&lt;/p&gt;
&lt;p&gt;So, we can conclude that there’s something that should be random but it isn’t :/&lt;/p&gt;
&lt;h1 id=&quot;ecdsa&quot;&gt;&lt;a href=&quot;#ecdsa&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;ECDSA&lt;/h1&gt;
&lt;p&gt;We will briefly discuss how ECDSA algorithm signing a message.&lt;/p&gt;
&lt;p&gt;ECDSA (&lt;em&gt;Elliptic-Curve Digital Signature Algorithm&lt;/em&gt;) is the variant of DSA (Digital Signature Algorithm) which uses Elliptic-Curve as its signature calculation.&lt;/p&gt;
&lt;p&gt;In the Elliptic-Curve, there’s some parameters that defined before doing any calculations. Here are the parameters used specifically in ES256.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;G = (0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296, 0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5)
n = 115792089210356248762697446949407573529996955224135760342422259061068512044369
d = random(1, n-1)
Q = d * G&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;where&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;G = Elliptic curve base point
n = integer order of G
d = private key
Q = public key&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Suppose we want to sign message &lt;code class=&quot;language-text&quot;&gt;m&lt;/code&gt;, then we do the following steps:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Calculate &lt;code class=&quot;language-text&quot;&gt;e&lt;/code&gt;, where &lt;code class=&quot;language-text&quot;&gt;e = SHA256(m)&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;Calculate &lt;code class=&quot;language-text&quot;&gt;z&lt;/code&gt; where &lt;code class=&quot;language-text&quot;&gt;z = int(e, 16)&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;Pick random integer &lt;code class=&quot;language-text&quot;&gt;k&lt;/code&gt; from interval &lt;code class=&quot;language-text&quot;&gt;[1, n-1]&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;Calculate the curve point &lt;code class=&quot;language-text&quot;&gt;(x1, x2) = k * G&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Calculate &lt;code class=&quot;language-text&quot;&gt;r = x1 % n&lt;/code&gt;. If &lt;code class=&quot;language-text&quot;&gt;r = 0&lt;/code&gt;, repeat the &lt;code class=&quot;language-text&quot;&gt;k&lt;/code&gt; selection.&lt;/li&gt;
&lt;li&gt;Calculate &lt;code class=&quot;language-text&quot;&gt;s = (inverse_mod(k, n) * (z + (r * d) % n)) % n&lt;/code&gt;. If &lt;code class=&quot;language-text&quot;&gt;s = 0&lt;/code&gt;, repeat the &lt;code class=&quot;language-text&quot;&gt;k&lt;/code&gt; selection.&lt;/li&gt;
&lt;li&gt;The valid signature is the pair &lt;code class=&quot;language-text&quot;&gt;(r, s)&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;not-so-random-k&quot;&gt;&lt;a href=&quot;#not-so-random-k&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Not so random k&lt;/h1&gt;
&lt;p&gt;As we have analyzed previously, there’s possibility that the “random” on the ECDSA in this challenge is not random.&lt;/p&gt;
&lt;p&gt;From the signing calculations that we have discussed above, only &lt;code class=&quot;language-text&quot;&gt;k&lt;/code&gt; that was picked randomly. Therefore, we can assume that in this website, there’s Nonce reuse vulnerability, where integer &lt;code class=&quot;language-text&quot;&gt;k&lt;/code&gt; is static and used repeatedly on the different signing process.&lt;/p&gt;
&lt;p&gt;Then, why the value of &lt;code class=&quot;language-text&quot;&gt;k&lt;/code&gt; that is not random can cause dangerous flaw on this website?&lt;/p&gt;
&lt;p&gt;Given two valid signature &lt;code class=&quot;language-text&quot;&gt;(r, s1)&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;(r, s2)&lt;/code&gt; from the signing message &lt;code class=&quot;language-text&quot;&gt;m1&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;m2&lt;/code&gt; using the same &lt;code class=&quot;language-text&quot;&gt;k&lt;/code&gt;, attacker can trivially calculate &lt;code class=&quot;language-text&quot;&gt;z1&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;z2&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;And because &lt;code class=&quot;language-text&quot;&gt;s1 - s2 = inverse_mod(k, (z1 - z2))&lt;/code&gt;, attacker can find &lt;code class=&quot;language-text&quot;&gt;k&lt;/code&gt; by calculate:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;k = (z1 - z2) / (s1 - s2)&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Then, attacker can easily find &lt;code class=&quot;language-text&quot;&gt;d&lt;/code&gt; with:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;d = (s1 * k - z1) / r&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h1 id=&quot;proof-of-concept&quot;&gt;&lt;a href=&quot;#proof-of-concept&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Proof of Concept&lt;/h1&gt;
&lt;p&gt;Let’s implement the attack in Python to get the private key and generate valid JWT with username &lt;code class=&quot;language-text&quot;&gt;admin&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; Crypto&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Util&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;number &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; requests&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; base64&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; hashlib
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; fastecdsa &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; ecdsa
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; fastecdsa&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;curve &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; P256

&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;auth&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;user&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    session &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; requests&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Session&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    response &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; session&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;post&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;url&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;http://challenge.nahamcon.com:30200/signin&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; data&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;username&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;user&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    token &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; session&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;cookies&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get_dict&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;token&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
    hashed &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; token&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;split&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;.&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;.&apos;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; token&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;split&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;.&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
    signature &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; token&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;split&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;.&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

    raw_signature &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; base64&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;b64decode&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;signature&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;replace&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;-&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;+&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;replace&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;_&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;/&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;==&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;hex&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; hashed&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;encode&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;raw_signature&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;64&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;raw_signature&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;64&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;modinv&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;a&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; modulus&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;pow&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;a&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; modulus &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; modulus&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;divmod&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;a&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; b&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; modulus&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;a &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; modinv&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;b&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; modulus&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt; modulus

m1&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; r&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; s1 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; auth&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;admim&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
m2&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; r&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; s2 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; auth&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;admio&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

order &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; P256&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;q
z1 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;hashlib&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sha256&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;m1&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;hexdigest&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
z2 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;hashlib&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sha256&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;m2&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;hexdigest&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

k &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;divmod&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;z1 &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; z2&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; s1 &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; s2&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; order&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
d &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;divmod&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;k &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; s1 &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; z1&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; r&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; order&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;[+] Private key:&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; d&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

new_token &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;b&apos;eyJhbGciOiAiRVMyNTYiLCAidHlwIjogIkpXVCJ9.&apos;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; base64&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;b64encode&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;b&apos;{&quot;username&quot;:&quot;admin&quot;}&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
r&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; s &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; ecdsa&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sign&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;new_token&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; d&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;[+] Forged signature:&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;r&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; s&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
new_token &lt;span class=&quot;token operator&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;b&quot;.&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; base64&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;b64encode&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;long_to_bytes&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;r&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; long_to_bytes&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;replace&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;b&apos;+&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;b&apos;-&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;replace&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;b&apos;/&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;b&apos;_&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;replace&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;b&apos;=&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;b&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;[+] JWT:&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; new_token&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;decode&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Run the script and we got the valid JWT.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;~$ python solve_elliptic.py
&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;+&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; Private key: &lt;span class=&quot;token number&quot;&gt;76360441104529975103479885636071599682318869381694694853301440181334888705951&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;+&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; Forged signature: &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;66378196147239170843827166360250592759597163597715304772573917957470106804741&lt;/span&gt;, &lt;span class=&quot;token number&quot;&gt;106147551365476994967159598162752611693743616349309630180573719192813726918650&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;+&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; JWT: eyJhbGciOiAiRVMyNTYiLCAidHlwIjogIkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIn0&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;.ksC6RjVxDXfXips96dGXrpC0DoB87qpDSrBrBgn14gXqrWKQDWejXdEUJmwIoIVIcIrt8IuDGIRzZbPzbIjn-g&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Insert the resulting JWT as a cookie and we got the flag :D&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;https://merricx.github.io/static/620c218a063a1ad134d6cac508bdaeb7/d5c6f/flag.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 70.27027027027026%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAABdUlEQVR42pVS2ZaCMAz1/3/LZx90NsUFWRS1gBsFSil3kjLOcXTccs49KSG5vUnaAVnTNBZsuq7heT4838fMdeH7AfwgsN+MxWKBkHA8Hv/UnXznkrAmwjhJkKYp4jghxBAEPud5DqUUyrK0eedEdwmFEIiiCAmRMomU0oJVWWSZjd8lPPeczCoYxrSxc6uqClprKnhAaIyxPgxD9Ho9dLtduFMPNdUWZUMXUAfaYNDvw3GctqYx9xWeztyaEBvsdntSXFHLiuZnYCoN+UrL56SsWOua5tqQNyiL8vffpYCnCIuioHkxGSyKXLWz+yf3ISGDN86LUapFpas2z27jSYW3rGmuL3zqYatKIS9yZDKD5DeYS/vQOc7KeKsvEcpMQqwF1qsNkjhFSpi7HrTSN5Q/INwWe3xEIzhihpGYYriZYJy4hLn1/mGJRbaGf4xwUNnVtq8IE7nFYPmFz5Vjid+j4Y8f4Y3i49iFuw0woQtSyr2s/wZbckUAOuJRpgAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;flag&quot;
        title=&quot;&quot;
        src=&quot;https://merricx.github.io/static/620c218a063a1ad134d6cac508bdaeb7/fcda8/flag.png&quot;
        srcset=&quot;https://merricx.github.io/static/620c218a063a1ad134d6cac508bdaeb7/12f09/flag.png 148w,https://merricx.github.io/static/620c218a063a1ad134d6cac508bdaeb7/e4a3f/flag.png 295w,https://merricx.github.io/static/620c218a063a1ad134d6cac508bdaeb7/fcda8/flag.png 590w,https://merricx.github.io/static/620c218a063a1ad134d6cac508bdaeb7/efc66/flag.png 885w,https://merricx.github.io/static/620c218a063a1ad134d6cac508bdaeb7/c83ae/flag.png 1180w,https://merricx.github.io/static/620c218a063a1ad134d6cac508bdaeb7/d5c6f/flag.png 1261w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
                &lt;div style=&quot;margin-top=55px; font-style: italic;&quot;&gt;You can read it online by &lt;a href=&quot;https://merricx.github.io/nahamconctf-elliptical/&quot;&gt;clicking here&lt;/a&gt;&lt;/div&gt;
              </content:encoded></item><item><title><![CDATA[How I Got Free Movie Tickets by Abusing QR-Code]]></title><description><![CDATA[How I got free movie tickets through partially censored QR code]]></description><link>https://merricx.github.io/how-i-get-free-movie-tickets/</link><guid isPermaLink="false">https://merricx.github.io/how-i-get-free-movie-tickets/</guid><pubDate>Wed, 09 Jan 2019 12:00:00 GMT</pubDate><content:encoded>&lt;p&gt;A few days ago, when I browsing Instagram, I found something that quite catch my eyes.&lt;/p&gt;
&lt;p&gt;I’ve found a post from &lt;strong&gt;@soloinfo&lt;/strong&gt; account that posted about movie ticket giveaway of &lt;strong&gt;How to Train your Dragon 3&lt;/strong&gt; for 2 people. The giveaway was quite simple and same as the commonly giveaway, where user comment and tag other user, then the winner will be determined by randomly selecting those comments.&lt;/p&gt;
&lt;p&gt;Here’s the image of the post.&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;https://merricx.github.io/static/6a872a339ab15c0ed0f2c454ebf6782a/e51a6/instagram-post.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 75.67567567567568%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAABYlAAAWJQFJUiTwAAACoUlEQVR42m1TWU8TURSen+Nv8dEYoxJj4haiL/pC4psxPqJiAykBIkgC4oMPPigFi7aKMTEIZRPLtLN09uXOdu+dpdOZeqZFE4jf3EzuMud83znfHabb7a4sL1deLtSXVqaeTzRZtt/vh2EYDVDM4yT2g8hzi60wJJRmWd4fgCFZVn9aUm/f96/fezNy4/tuY7+xW6/Xa7Xa5uamZZoBISmlcRDQMAop9X0/y7KT4CjPv5Tn0N0x/+ro/LWb24eHe9uN9crax7X1b1+LYEKIj7GmqchSCKEYB55fIE1TJonj8enJ5fJU+fGj0bEHv34feRGRTM2grrHaoAdykvccx1VVxUUakEMujGEEwM+EuvPh2eL70lJ15m219FqsbEU7UrDFk58C+cHTHTEMKHIQx4ssL7GcyB43OXZfVfUkSRh5fLV5fkK49ap9scyPzB1fKh9dmGxenm5emT6+s7B37qFVO8RZrCmKZWqu51mW6bv2Sc2oesC9WBUX662pCj9TFRY+i/M1YWZDnP0kzG4IT975rOaHRJY6liGDC5SQICDQ+DzPGbCqo8htHnQJNrJ101ANXTN0C+aWaXsoiiPHcbh2SxQ7rVbx5lpHuq6laY+Jo0iWJNu24NFU1TKtwgkwMs+LkeXABk2y4LwYpo2QqcsY+70eBMcxz/MIIZAAYmCZnwZs2shpN/cMXYV4Q9chXjcM2C+CBUEAYdkA8PW/yRBwscAb21Sw72EwmoYYisbB4JJEUafT4TjOtm0dStGgrwpI7RfCT5hdx9E0XRBFCfphFp4jS066acEsiqLruqAcvjtDO2T2PB+yYozhVg1Ngn1YFsxACLQQPzw7UzOoAAJKyamUg5+DqVarIJtlWWDO/wcahpAU5KS9FJb9v4Bu/wE21iVU6uiJGAAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Instagram Post&quot;
        title=&quot;&quot;
        src=&quot;https://merricx.github.io/static/6a872a339ab15c0ed0f2c454ebf6782a/fcda8/instagram-post.png&quot;
        srcset=&quot;https://merricx.github.io/static/6a872a339ab15c0ed0f2c454ebf6782a/12f09/instagram-post.png 148w,https://merricx.github.io/static/6a872a339ab15c0ed0f2c454ebf6782a/e4a3f/instagram-post.png 295w,https://merricx.github.io/static/6a872a339ab15c0ed0f2c454ebf6782a/fcda8/instagram-post.png 590w,https://merricx.github.io/static/6a872a339ab15c0ed0f2c454ebf6782a/e51a6/instagram-post.png 783w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;h1 id=&quot;how-to-train-your-dragon-pwn-someone-tickets&quot;&gt;&lt;a href=&quot;#how-to-train-your-dragon-pwn-someone-tickets&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;How to &lt;del&gt;Train your Dragon&lt;/del&gt; Pwn Someone Tickets&lt;/h1&gt;
&lt;p&gt;Because the QR code on that image is quite suspicious, I quickly tried to import the image into &lt;a href=&quot;https://merricx.github.io/qrazybox/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;QRazyBox&lt;/a&gt; and edited some closed parts with manual reconstruction.&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;https://merricx.github.io/static/12535a2feed4a5d81a3aee40685ff4af/29114/reconstructing-qr.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 46.621621621621614%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAACXklEQVR42jWS2U9TURDG+1f57oNGjWvik09i4gOJsrggRTEsFQoW0rCICdiIwQoKChS0oCRFCQItIGtZqm2hBdrbe3tP21sWY36eYnz4Mjkn830z882Y7s1mKPIZmOez5E9nuD2TodD7D8VrcH8dHiweUbH6B/MGlEqUSM5dn8z1GuRPZbg1ncs3jrmm0W0Dd1AwGkjgCmfZUnRSQqBqSTYbnzJZa8c95uFNby8+m03+NaBrGjuqoG4xjc1vYFkxKPGlGAunML3wC8zyUT6XpmLB4FdcRxMpYgmNqXOX6D5xhnZLPR0WC66Tp/l66jxqQiWSPuK5ewpPnY0JayNNLe2MR9KYGqa2qJ8I0rygUjih4I+lELLDHUXD2dZFt7WFIdcwI0PDOB091FXbiUZ32TF+0/XZi3KzgOTVPF5a7XiiUrDTr/NuQ6MvuI95Lsvqno7QBbGkwPGqk35HB66REd5/6KfGbqeqpgYlkWBPCrYOjjFYVcHrgiKampv5HpEjO9d1nIEMPcEDrEtZNmI6em5kNUlH3g0GikvoG3DxyFyG4/IVOlueEZf+RpIG5Z4gTV+8OL7NY/Ws8SkkBfc0wXZCEEno7Ko6CU1CTxGXHi5fvMDHs9coq6zlSVUVbdfzaLU1Eo3FZa7g4eIhbesHvN0U3Jk/ZDQkMKlJuQQJVY74DzqKjIoUDs34CM4t8WNpFf9GgJXwNpuhLelxirAieOxVqZxNUr18QOmcQV9AdqhoOfJ/yO5ygsdRihv7aEYWkTZIpjLSirS8gPRx0dzZDP/UGQ/rTMpluENpZqKCvzCMVanSo5ScAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Reconstructing QR code&quot;
        title=&quot;&quot;
        src=&quot;https://merricx.github.io/static/12535a2feed4a5d81a3aee40685ff4af/fcda8/reconstructing-qr.png&quot;
        srcset=&quot;https://merricx.github.io/static/12535a2feed4a5d81a3aee40685ff4af/12f09/reconstructing-qr.png 148w,https://merricx.github.io/static/12535a2feed4a5d81a3aee40685ff4af/e4a3f/reconstructing-qr.png 295w,https://merricx.github.io/static/12535a2feed4a5d81a3aee40685ff4af/fcda8/reconstructing-qr.png 590w,https://merricx.github.io/static/12535a2feed4a5d81a3aee40685ff4af/efc66/reconstructing-qr.png 885w,https://merricx.github.io/static/12535a2feed4a5d81a3aee40685ff4af/c83ae/reconstructing-qr.png 1180w,https://merricx.github.io/static/12535a2feed4a5d81a3aee40685ff4af/29114/reconstructing-qr.png 1920w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;Then, looked at the specification of the QR code.&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;https://merricx.github.io/static/c0a2b5d5c41824ce7a20575a6fc4d1f9/dba9a/qr-specification.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 31.756756756756754%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABA0lEQVR42p2Py26DMBBF+f+f6b7ddNEuUqkJaUQSILxfCqlpeBYkzKmBH4h6paO59tyxxtqbGaJbLh+GhRGknBTP7xueXl7RbZ96AtFLimF6CO3kRWRRQJrEBJ6La1u4F5vz0cBRXuRXVk08Im17dtTwkYvjYBxPxHFMnCT0/UA/DAwKOU2MUiLltDD7cZRrXe5XVAwtbwZ+u5au62jaVgXHhf9oUi9q5zAjiUI83ye/5kRRhK98EATY9oUoVD3PW5i3z9IUfbfjc7vDNE32e52vw0F5a/1y8tPQVCX3e0mrNqzrmrIsEUIgioK6qpZzpercmzO3W06aZRSqL8T3Umdm/QFAEMccFN6fEQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;QR Specification&quot;
        title=&quot;&quot;
        src=&quot;https://merricx.github.io/static/c0a2b5d5c41824ce7a20575a6fc4d1f9/fcda8/qr-specification.png&quot;
        srcset=&quot;https://merricx.github.io/static/c0a2b5d5c41824ce7a20575a6fc4d1f9/12f09/qr-specification.png 148w,https://merricx.github.io/static/c0a2b5d5c41824ce7a20575a6fc4d1f9/e4a3f/qr-specification.png 295w,https://merricx.github.io/static/c0a2b5d5c41824ce7a20575a6fc4d1f9/fcda8/qr-specification.png 590w,https://merricx.github.io/static/c0a2b5d5c41824ce7a20575a6fc4d1f9/dba9a/qr-specification.png 652w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;Surprisingly, the QR code using &lt;strong&gt;Error Correction Level High&lt;/strong&gt;, where as long as there’s around &lt;strong&gt;40%&lt;/strong&gt; of undamaged part, we can still recover the QR code with &lt;em&gt;Reed-Solomon&lt;/em&gt;. &lt;/p&gt;
&lt;p&gt;As a measurement, damaged QR code like the following image can be still fully read when using Error Correction Level H.&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;https://merricx.github.io/static/5aae64e74fc0658c7add1509dec23bf6/5ff7e/broken-qr.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 375px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAC4jAAAuIwF4pT92AAACLklEQVR42qWUz2v5cRzHnRxclItyn/xIcnFBUsRBmuy8RbkgIgdlSVN+tNnv2dZsFKXERZSkRAnNHyAubttxJ26e397vetcu39n41Kv37dHz+Xo+Py/O1dUVdp3Ly0s62WwW9/f3ODw8BGcfIJvz83OUSiVIpdLdgUzd9fU1EokERqMRNBrNfgoJkFiNx+OYTCYwGo27Ab+rSyaTuLi4QKfTgUgk2s8yeV9eXhAMBuF0OuH3+/8OZOpubm5wdnaGh4cHvL+/YzqdIp/P7wZkNQkEAuBwOHC73Vgul2g0Grvv8Pb2FoPBAAqFAl6vF6enp+Dz+b8Hfi9xLpeD3W7HbDajVonCdrtN1XL+GgIp8evrK8rlMjKZDJrNJk13sVig2+3+zTJRR0Lw+XywWq0QCoWQyWQwm80Ih8NQq9Xbgcwqmbu7Owo7Pj6GRCKhFmOxGH2LxSI8Hs/vgOQl5X1+fkY0GoVYLKYgsjsej0eBRHm/3/8ZyJQxIDkAWq2WJjoej9Hr9WAymfD09ITPz0/I5fLtQLY7lixRc3R0hOFwiEKhAJ1Oh/V6ja+vL1gslv8DGYz9FalUCg6HA61WCzabjYah1+upQpVKhYODA+pgq0ICI/UgYaxWK3x8fNBfrVqt4vHxEZvNBpFIhF6bH88XuybpdBpvb28UGgqFMJ/PaZlrtRoEAgE9qicnJyCfUqn8WSErMUmQy+XS/RFrlUqFVsTlctE+kgNbr9dhMBjwD2W2CHOK1eDxAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Broken QR code&quot;
        title=&quot;&quot;
        src=&quot;https://merricx.github.io/static/5aae64e74fc0658c7add1509dec23bf6/5ff7e/broken-qr.png&quot;
        srcset=&quot;https://merricx.github.io/static/5aae64e74fc0658c7add1509dec23bf6/12f09/broken-qr.png 148w,https://merricx.github.io/static/5aae64e74fc0658c7add1509dec23bf6/e4a3f/broken-qr.png 295w,https://merricx.github.io/static/5aae64e74fc0658c7add1509dec23bf6/5ff7e/broken-qr.png 375w&quot;
        sizes=&quot;(max-width: 375px) 100vw, 375px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;If such QR code like the above image can still be recovered, especially with the QR code from the post that we talked about where the damaged part is only around 40%.&lt;/p&gt;
&lt;p&gt;Let’s quickly use &lt;em&gt;Reed-Solomon Decoder&lt;/em&gt; feature to recover the message.&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;https://merricx.github.io/static/699e1bdec82f2f34e03d0c6d2b6eb737/d1d24/reed-solomon-decoding.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 68.24324324324324%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAABlklEQVR42p1TTW+CQBTk3ze99ND/0XsvjT0CVaMxtVULyreLuGq1EQWcvreKWqP92mQyCzzmzZsFrdPpIkkSDIdDgoAQMYIggN3vYzBwdhjA8zy1d1xXXXO9EEIhor0cj1FrPUObzmY4XdPpFIauo9FswjQM6LqBl3Yb1WoVpmkqrFYrVVsUBfI8V/u3cAQtiiLVzfd95YwRhiH4PrOUEjNqyk1OuYSUEyw/Fnh1Amgs0Kfxer0ebNsmWIp5LOY0TVX3zWazx6XV8wW0OI5VhqPRSPFkMiHH0TYXcieIlWPicoL5/P1Lk5zG5tX1hweHW3c2HMdRDzmXLMsUM8qsGKXLkotjQc6PBS3L2oJGdkl0vliA67n4HC4K8pjcdb1e78G55XlxMavyVM8L0vfz1/WjQ9WVRzk6ye9QOsS5Q5Fy53BDYV/I6xSnh0K7g2AYJ4jpow8WGZZZ8WtRdsW1aZYjpHeTNf0pXgitJea4toGrLolmf44TCU17YwG3LlD3JbRK5RHVWm33jz79C7pholGv4+7+AZ+Royo2SBXo7QAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Reed-Solomon Decoding&quot;
        title=&quot;&quot;
        src=&quot;https://merricx.github.io/static/699e1bdec82f2f34e03d0c6d2b6eb737/fcda8/reed-solomon-decoding.png&quot;
        srcset=&quot;https://merricx.github.io/static/699e1bdec82f2f34e03d0c6d2b6eb737/12f09/reed-solomon-decoding.png 148w,https://merricx.github.io/static/699e1bdec82f2f34e03d0c6d2b6eb737/e4a3f/reed-solomon-decoding.png 295w,https://merricx.github.io/static/699e1bdec82f2f34e03d0c6d2b6eb737/fcda8/reed-solomon-decoding.png 590w,https://merricx.github.io/static/699e1bdec82f2f34e03d0c6d2b6eb737/efc66/reed-solomon-decoding.png 885w,https://merricx.github.io/static/699e1bdec82f2f34e03d0c6d2b6eb737/d1d24/reed-solomon-decoding.png 987w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;Voila! We finally got the value &lt;strong&gt;#6285647329322;83664&lt;/strong&gt;, where &lt;strong&gt;6285647329322&lt;/strong&gt; is the phone number of the person who ordered the ticket and &lt;strong&gt;83664&lt;/strong&gt; is the ticket booking code. Quickly insert that number into M-Tix machine and we got two free tickets :).&lt;/p&gt;
&lt;h1 id=&quot;moral-of-story&quot;&gt;&lt;a href=&quot;#moral-of-story&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Moral of Story&lt;/h1&gt;
&lt;p&gt;So, what message can we take from this story?&lt;/p&gt;
&lt;h3 id=&quot;as-a-user&quot;&gt;&lt;a href=&quot;#as-a-user&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;As a User&lt;/h3&gt;
&lt;p&gt;Please, stop sharing any QR code that contain sensitive data to the Internet like the social media, even if you already censored it.&lt;/p&gt;
&lt;p&gt;Nowadays, almost all tickets, receipts, or ther transaction proof use QR code as a medium to validating these transactions because apart from being simple, QR code also have advantages in fast data reading and quite flexible to store any kind of data.&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;https://merricx.github.io/static/0b380bf751162598cc8321555fa7fa7a/94a05/2qiddz.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 568px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 58.78378378378378%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAABAADBf/EABUBAQEAAAAAAAAAAAAAAAAAAAMC/9oADAMBAAIQAxAAAAEaz7GiLlx1/8QAGxAAAQUBAQAAAAAAAAAAAAAAAgABAxIhBBP/2gAIAQEAAQUCjkJEdTx1zs1PMEWF/8QAFhEBAQEAAAAAAAAAAAAAAAAAABIB/9oACAEDAQE/AaxT/8QAFhEBAQEAAAAAAAAAAAAAAAAAABIB/9oACAECAQE/AZ1D/8QAGxAAAgMAAwAAAAAAAAAAAAAAABEBITEiMkH/2gAIAQEABj8CqajTtxQ2jPTCUf/EABwQAQEBAAIDAQAAAAAAAAAAAAERADFBIVFhcf/aAAgBAQABPyFPhLcDjQnmRnvK6C6jQ/WtLf6uECQvvf/aAAwDAQACAAMAAAAQFD//xAAXEQEBAQEAAAAAAAAAAAAAAAABACFh/9oACAEDAQE/EADTY5v/xAAYEQEAAwEAAAAAAAAAAAAAAAABABEhUf/aAAgBAgEBPxBRxyW7P//EABwQAQEBAQACAwAAAAAAAAAAAAERIQAxQVFhkf/aAAgBAQABPxBAgBRYfOpxGQKFMfTZu83gA8L9Pz2v2trMDiPMQBUJ9vQsSgLv/9k=&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;One Does not Simply&quot;
        title=&quot;&quot;
        src=&quot;https://merricx.github.io/static/0b380bf751162598cc8321555fa7fa7a/94a05/2qiddz.jpg&quot;
        srcset=&quot;https://merricx.github.io/static/0b380bf751162598cc8321555fa7fa7a/a80bd/2qiddz.jpg 148w,https://merricx.github.io/static/0b380bf751162598cc8321555fa7fa7a/1c91a/2qiddz.jpg 295w,https://merricx.github.io/static/0b380bf751162598cc8321555fa7fa7a/94a05/2qiddz.jpg 568w&quot;
        sizes=&quot;(max-width: 568px) 100vw, 568px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;h3 id=&quot;as-a-developer&quot;&gt;&lt;a href=&quot;#as-a-developer&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;As a Developer&lt;/h3&gt;
&lt;p&gt;As a developer who developing system that involve QR code, we should carefully select &lt;em&gt;Error Correction Level&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;QR code with Error Correction Level H on the digital medium like the online ticket is not suitable in my opinion, because Level H intended to QR code that will be distributed in the environment that has the potential to damage the QR code itself (for example QR code that pyshically printed in the public place).&lt;/p&gt;
&lt;p&gt;We should better use Level L or Level M to digital QR code and Level Q to physically printed QR code instead.&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;Anyway, I’ve contacted admin from &lt;strong&gt;@soloinfo&lt;/strong&gt; about this and because I didn’t intend to claim the ticket, the giveaway is still running normally.&lt;/p&gt;
                &lt;div style=&quot;margin-top=55px; font-style: italic;&quot;&gt;You can read it online by &lt;a href=&quot;https://merricx.github.io/how-i-get-free-movie-tickets/&quot;&gt;clicking here&lt;/a&gt;&lt;/div&gt;
              </content:encoded></item></channel></rss>