<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[Merricx personal blog RSS Feed]]></title><description><![CDATA[My personal blog]]></description><link>https://merricx.github.io</link><generator>GatsbyJS</generator><lastBuildDate>Thu, 18 Aug 2022 06:22:38 GMT</lastBuildDate><item><title><![CDATA[Don't Roll Your Own Crypto #1]]></title><description><![CDATA[The series of cryptanalyzing encryption scheme from local academic paper or article. This first series will discuss about cryptanalysis of image encryption based on Chaos function.]]></description><link>https://merricx.github.io/dont-roll-your-own-crypto-1/</link><guid isPermaLink="false">https://merricx.github.io/dont-roll-your-own-crypto-1/</guid><pubDate>Wed, 28 Jul 2021 15:42:00 GMT</pubDate><content:encoded>&lt;h1 id=&quot;introduction&quot;&gt;&lt;a href=&quot;#introduction&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Introduction&lt;/h1&gt;
&lt;p&gt;This is a series where I will try to reviewing and cryptanalyzing various cryptosystem schemes that proposed in academic journal, paper, and article from Universities in Indonesia.&lt;/p&gt;
&lt;p&gt;As written in the title, this article tries to emphasize the sentence “Don’t roll your own Crypto”, where we can’t just design or create our own cryptosystem algorithm. We should always use standarized algorithm for Cryptography. &lt;/p&gt;
&lt;p&gt;There’s absolutely no intention or whatsoever about humiliating the research that discussed here. In fact, this is how the process of proposing a cryptosystem scheme is carried out, where some party proposes an idea, and the other parties will try to find the weaknesses of that idea, until finally from these weaknesses, it can be developed into a better scheme and so on. &lt;/p&gt;
&lt;h1 id=&quot;chaos-based-image-encryption&quot;&gt;&lt;a href=&quot;#chaos-based-image-encryption&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Chaos-based Image Encryption&lt;/h1&gt;
&lt;p&gt;Cryptosystem that will be discussed in this first series is the study from article entitled &lt;strong&gt;“ANALISIS KEAMANAN ALGORITMA ENKRIPSI CITRA DIGITAL MENGGUNAKAN KOMBINASI DUA CHAOS MAP DAN PENERAPAN TEKNIK SELEKTIF”&lt;/strong&gt; written by Rinaldi Munir, that published on Jurnal Ilmiah Teknologi Informasi (JUTI) in 2012 &lt;sup&gt;&lt;a href=&quot;#references&quot;&gt;[1]&lt;/a&gt;&lt;/sup&gt;.&lt;/p&gt;
&lt;p&gt;The article discussed about image encryption by using two Chaos-based function, which is &lt;strong&gt;Arnold’s Cat Map&lt;/strong&gt; as permutation and &lt;strong&gt;Logistic Map&lt;/strong&gt; as keystream generator.&lt;/p&gt;
&lt;p&gt;In addition, the article also explained the use of “selective encryption” where the encryption only done on the first 4-bit (Most Significant Byte), while the last 4-bit (Least Significant Byte) of the image (after permutation) never change.&lt;/p&gt;
&lt;h2 id=&quot;arnolds-cat-map&quot;&gt;&lt;a href=&quot;#arnolds-cat-map&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Arnold’s Cat Map&lt;/h2&gt;
&lt;p&gt;Arnold’s Cat Map is Chaos Map function that shuffle pixels position (in &lt;code class=&quot;language-text&quot;&gt;(x,y)&lt;/code&gt; coordinate) of the image.&lt;/p&gt;
&lt;p&gt;The equation that used in the article is as follows.&lt;/p&gt;
$$
    \begin{bmatrix}
    x&apos; \\
    y&apos; \\
    \end{bmatrix}
    =
    \begin{bmatrix}
    1 &amp; p \\
    q &amp; pq + 1 \\
    \end{bmatrix}
    \begin{bmatrix}
    x \\
    y \\
    \end{bmatrix}
    \mod N
$$
&lt;p&gt;Where &lt;code class=&quot;language-text&quot;&gt;(x,y)&lt;/code&gt; is the inital position and &lt;code class=&quot;language-text&quot;&gt;(x&apos;, y&apos;)&lt;/code&gt; is the position after permutation. Meanwhile, &lt;code class=&quot;language-text&quot;&gt;N&lt;/code&gt; is the size of the image and this function will be iterated &lt;code class=&quot;language-text&quot;&gt;m&lt;/code&gt; times.&lt;/p&gt;
&lt;p&gt;So, the secret variables in this ACM function consists of &lt;code class=&quot;language-text&quot;&gt;p&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;q&lt;/code&gt;, and &lt;code class=&quot;language-text&quot;&gt;m&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;The following is the visualization of the image after ACM has been performed several times. It can be seen that the higher the &lt;code class=&quot;language-text&quot;&gt;m&lt;/code&gt; value, the more random-looking the result will be.&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;https://merricx.github.io/static/53cb714c13290142b14c7a0db1ebbb9d/9cab2/acm.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 76.35135135135135%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAAsTAAALEwEAmpwYAAACp0lEQVR42m2Se1MSYRTG/QrN9CH6LtV/zTjjaN7A5bYXQGRxEeUiahgXr4SJQ0y3CZrSaDJGTUlNmJQGL6ihIGmKEpVasu5CR5fGqHZ23nnnfd7fPs85Z0tyLJvP51fDY25T+SMr4jTVD/VaPA79W58jf/6MeB7azW0uu9XVb3XZbQO2jmR8A85zuVwJyzKwW5zzuUzCB1bZC3eX+87As3v9S7NPOdhubpfxyjQE0iwTNBEIKa5ejnyAc5ZlAT5zDkz4SbSqr1Pr6DITdUhtWfn4yxEOdvZaKIxvUKJtlNRAYhqZMLoUKYL9/oCcUBEiTIncEJVev3L5klzI5+DBntukuAYwA4m3qnA1Ube6vFgEv5mYrbopkmOUipB0thDCilKv28nBd7vPYH0DCuZ6JdYkFawt/3ZmmDPY5xu7eo3Hq0S1qkarkVLL8OnxQmyHzUSKqoFsV8t1CjGF8y9gaBrsDtLpueC81/PcP/r6lW94emrq8HuGg3d3tpPxzfD74ExgciseS2zGfv44LnSbu0FnT/Z3d2Lrq8nE5lp0Jb7x8ejwkJO+fc2kD1Kftz9tJ7fS+6n0/l42e8JJhZqD05PQUqOKgNqMjVI1Xuf5XbOz10xhPD2JQcE6haRJiqwsFo8KYJWkpqVe3CwXwQrDfOIevIBRnlYhgfMWgAkk+hccmpkCNwN8G7pK4mqM770/xMFDfeDMh0TAg6qRCv4P65WorkEC8SDnH7DlXMKB1ClRjewf+F1gQiGshBlCKpAVgorHroHCnLtMSlEV/Figgq0KrV2JhIvgyHzIalD3mfTdHVpYLQZqdNjLwRDB0qruuaXrbtf2dOhsRk1sPVqAuRsMw9B09vjoKLywkErtMcwpTdOFKdJZeLcSiVAomMl8OT2lWYbhpF9Tb4v39xdTigAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;acm&quot;
        title=&quot;&quot;
        src=&quot;https://merricx.github.io/static/53cb714c13290142b14c7a0db1ebbb9d/fcda8/acm.png&quot;
        srcset=&quot;https://merricx.github.io/static/53cb714c13290142b14c7a0db1ebbb9d/12f09/acm.png 148w,https://merricx.github.io/static/53cb714c13290142b14c7a0db1ebbb9d/e4a3f/acm.png 295w,https://merricx.github.io/static/53cb714c13290142b14c7a0db1ebbb9d/fcda8/acm.png 590w,https://merricx.github.io/static/53cb714c13290142b14c7a0db1ebbb9d/9cab2/acm.png 864w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;To inverse this process, just multiply &lt;code class=&quot;language-text&quot;&gt;(x&apos;, y&apos;)&lt;/code&gt; with the inverse matrix of $\begin{bmatrix} 1 &amp; p\\ q &amp; pq+1\\ \end{bmatrix}$.&lt;/p&gt;
&lt;h2 id=&quot;logistic-map&quot;&gt;&lt;a href=&quot;#logistic-map&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Logistic Map&lt;/h2&gt;
&lt;p&gt;Logistic Map is Chaos Map function from simple non-linear equation below.&lt;/p&gt;
$$
x_{i+1} = r x_i \left(1 - x_i\right)
$$
&lt;p&gt;Where defined constant &lt;code class=&quot;language-text&quot;&gt;r&lt;/code&gt; as real number in the interval of 0 to 4 and &lt;code class=&quot;language-text&quot;&gt;x0&lt;/code&gt; as random initial value in the interval of 0 to 1. These variables are kept secret.&lt;/p&gt;
&lt;p&gt;To generate keystream with Logistic Map, calculate the above equation which will be resulting &lt;code class=&quot;language-text&quot;&gt;x1, x2, x3, ...&lt;/code&gt; until the required length of keystream is met. Each value of &lt;code class=&quot;language-text&quot;&gt;x1, x2, x3, ...&lt;/code&gt; then will be represented as 4-bit key which is determined from the numbers after decimal point.&lt;/p&gt;
&lt;p&gt;For example, given a sequence of Logistic Map that is &lt;code class=&quot;language-text&quot;&gt;0.5, 0.875, 0.3828125, 0.8269348, ...&lt;/code&gt;, then we take the number after decimal point (with pre-defined precision, 4 in this case) so they become &lt;code class=&quot;language-text&quot;&gt;5, 875, 3828, 8269, ...&lt;/code&gt;. Change each of the number to binary and take the last 4-bit (LSB) resulting keystream as follows: &lt;code class=&quot;language-text&quot;&gt;0101, 1011, 0100, 1101, ...&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&quot;encryption&quot;&gt;&lt;a href=&quot;#encryption&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Encryption&lt;/h2&gt;
&lt;p&gt;The encryption stages are as follows:&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;https://merricx.github.io/static/0542cfc5a2b3327fcba64f6f6a9bd4c2/c1b63/encrypt.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 58.10810810810811%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsTAAALEwEAmpwYAAABp0lEQVR42pVRTUvDQBDtv/PgL9CbUKsIikoxVYk0JkUQqR686aUIinpQwY8olVZNrbbVkyA2lxLaYD6bNts0ralxdDEkIoKP7GbYeW9n3k7IdV2hXDjfTqQPd+7S+22kw4n7/u66+P8ZlJ+f9lIbBzupo92tFjK98xCsfPZ0lRxepcllkmgaiuP0ZFk2TbPZbNq2DYTsxcl0eHB+IkxOjeiaGhCn09eRobFoZHCgv0+oVNq2Lb2+gl5VVbhCkuVL9hiU8ehYYnbS0LWAOJPJj0aiyaXFzfWkhRpeDtDr9WC/z11RM+NriYUVas6o6wFx9+1NUVRJkjRNc7+B03hvtVp8+QUhk+d5x3E8Tsj1AeqIoigIgqIojUajXq9D26CEzmuiCFl4BX9fIa8ORrfbNQwD3AIVYqgDQafdVqtViGu1mr9YoDJGp9NBCHk3QiBXqyWWLRULZyxrWVbAs9+nruvgHNoGPfAw6YbjogRBkiRDM+DldzEATKIvwIShbUzK5W5jsRhFUTRN/yX+ATyqHMcRRIyKUwzD/EOMSeClWCw+PD7C5x/VBx8OhVkNSWO2AAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;encrypt&quot;
        title=&quot;&quot;
        src=&quot;https://merricx.github.io/static/0542cfc5a2b3327fcba64f6f6a9bd4c2/fcda8/encrypt.png&quot;
        srcset=&quot;https://merricx.github.io/static/0542cfc5a2b3327fcba64f6f6a9bd4c2/12f09/encrypt.png 148w,https://merricx.github.io/static/0542cfc5a2b3327fcba64f6f6a9bd4c2/e4a3f/encrypt.png 295w,https://merricx.github.io/static/0542cfc5a2b3327fcba64f6f6a9bd4c2/fcda8/encrypt.png 590w,https://merricx.github.io/static/0542cfc5a2b3327fcba64f6f6a9bd4c2/efc66/encrypt.png 885w,https://merricx.github.io/static/0542cfc5a2b3327fcba64f6f6a9bd4c2/c83ae/encrypt.png 1180w,https://merricx.github.io/static/0542cfc5a2b3327fcba64f6f6a9bd4c2/c1b63/encrypt.png 1200w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Define Plain-image &lt;code class=&quot;language-text&quot;&gt;P&lt;/code&gt;, secret key &lt;code class=&quot;language-text&quot;&gt;p&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;q&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;m&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;r&lt;/code&gt;, and &lt;code class=&quot;language-text&quot;&gt;x0&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;Permutate image &lt;code class=&quot;language-text&quot;&gt;P&lt;/code&gt; using Arnold’s Cat Map with &lt;code class=&quot;language-text&quot;&gt;p&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;q&lt;/code&gt;, and &lt;code class=&quot;language-text&quot;&gt;m&lt;/code&gt; as parameters, resulting image &lt;code class=&quot;language-text&quot;&gt;Px&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;Generate keystream &lt;code class=&quot;language-text&quot;&gt;K&lt;/code&gt; using Logistic Map with constant &lt;code class=&quot;language-text&quot;&gt;r&lt;/code&gt; and inital value &lt;code class=&quot;language-text&quot;&gt;x0&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;Encrypt 4-bit MSB each pixel of image &lt;code class=&quot;language-text&quot;&gt;Px&lt;/code&gt; with keystream &lt;code class=&quot;language-text&quot;&gt;K&lt;/code&gt; using XOR operation, resulting 4-bit &lt;code class=&quot;language-text&quot;&gt;Cx&lt;/code&gt; on each pixel.&lt;/li&gt;
&lt;li&gt;Combine 4-bit &lt;code class=&quot;language-text&quot;&gt;Cx&lt;/code&gt; with 4-bit LSB of image &lt;code class=&quot;language-text&quot;&gt;Px&lt;/code&gt; on each pixel, resulting Cipher-image &lt;code class=&quot;language-text&quot;&gt;C&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Implementation of this algorithm can be accessed in &lt;a href=&quot;https://github.com/Merricx/chaos-image-encryption/blob/main/encryption.py&quot; target=&quot;_blank&quot;&gt;this link&lt;/a&gt;.&lt;/p&gt;
&lt;h1 id=&quot;cryptanalysis&quot;&gt;&lt;a href=&quot;#cryptanalysis&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Cryptanalysis&lt;/h1&gt;
&lt;p&gt;Let’s just try to do the cryptanalysis against this encryption scheme.&lt;/p&gt;
&lt;p&gt;While conducting cryptanalysis, will be assumed some implementation scenario because the article didn’t define a specification of how the implementation should be done.&lt;/p&gt;
&lt;p&gt;Cryptanalysis model which we will use is &lt;strong&gt;Chosen-Plain image Attack&lt;/strong&gt;, where we can encrypt any image as much as we want and receive the coresponding cipher image.&lt;/p&gt;
&lt;h2 id=&quot;static-secret-key&quot;&gt;&lt;a href=&quot;#static-secret-key&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Static Secret Key&lt;/h2&gt;
&lt;p&gt;Let’s assume the implementation where secret key that consist of &lt;code class=&quot;language-text&quot;&gt;p&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;q&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;m&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;r&lt;/code&gt;, and &lt;code class=&quot;language-text&quot;&gt;x0&lt;/code&gt; are static and does not change in different encryption request.&lt;/p&gt;
&lt;h3 id=&quot;recovery-of-keystream&quot;&gt;&lt;a href=&quot;#recovery-of-keystream&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Recovery of Keystream&lt;/h3&gt;
&lt;p&gt;Because the value of &lt;code class=&quot;language-text&quot;&gt;r&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;x0&lt;/code&gt; always same, the result keystream generated from Logistic Map will also be same.&lt;/p&gt;
&lt;p&gt;That means, we can determine keystream &lt;code class=&quot;language-text&quot;&gt;K&lt;/code&gt; easily as long as we know cipher image &lt;code class=&quot;language-text&quot;&gt;C&lt;/code&gt; and the coresponding plain image that has been permutated by ACM (&lt;code class=&quot;language-text&quot;&gt;Px&lt;/code&gt;) because:&lt;/p&gt;
$$
C = Px \oplus K \\
K = C \oplus Px
$$
&lt;p&gt;But, here we still don’t know the value of &lt;code class=&quot;language-text&quot;&gt;Px&lt;/code&gt; (only 4-bit LSB that we know) because we don’t know value of &lt;code class=&quot;language-text&quot;&gt;p&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;q&lt;/code&gt;, and &lt;code class=&quot;language-text&quot;&gt;m&lt;/code&gt; of ACM.&lt;/p&gt;
&lt;p&gt;Well, because this is Chosen-Plain image Attack and we can encrypt any image, we can just use plain image where all of the pixels are same such as full-black image or full-white image.&lt;/p&gt;
&lt;p&gt;Because all of the pixels are same, the permutation from ACM will resulting same image too, so that we know &lt;code class=&quot;language-text&quot;&gt;Px&lt;/code&gt; and we can just find the keystream with XOR ¯\_(ツ)_/¯&lt;/p&gt;
&lt;p&gt;After we got the keystream, let’s find &lt;code class=&quot;language-text&quot;&gt;p&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;q&lt;/code&gt;, and &lt;code class=&quot;language-text&quot;&gt;m&lt;/code&gt;.&lt;/p&gt;
&lt;h3 id=&quot;recovery-of-m&quot;&gt;&lt;a href=&quot;#recovery-of-m&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Recovery of &lt;code class=&quot;language-text&quot;&gt;m&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;It should be noted that ACM process is actually quite costly in terms of hardware, where in one ACM iteration (&lt;code class=&quot;language-text&quot;&gt;m = 1&lt;/code&gt;) takes quite long time to finish, so the time difference in the value of &lt;code class=&quot;language-text&quot;&gt;m&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;m+1&lt;/code&gt; is quite noticable.&lt;/p&gt;
&lt;p&gt;This is actually dangerous because we can find out the value of &lt;code class=&quot;language-text&quot;&gt;m&lt;/code&gt; from &lt;strong&gt;Timing Attack&lt;/strong&gt;. The higher the &lt;code class=&quot;language-text&quot;&gt;m&lt;/code&gt; value is, the longer the ACM operation will take.&lt;/p&gt;
&lt;p&gt;The following is table of test results for the time required for the ACM process using &lt;code class=&quot;language-text&quot;&gt;m = 1&lt;/code&gt; to &lt;code class=&quot;language-text&quot;&gt;m = 5&lt;/code&gt; on a 1024x1024 image using my own laptop.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;m&lt;/th&gt;
&lt;th&gt;Time (s)&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;7.1236&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;13.8878&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;21.7516&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;27.8001&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;5&lt;/td&gt;
&lt;td&gt;35.2292&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;It can be seen on the table that time required for the ACM is relatively consistent on the multiple of 7 seconds. From this time result, we can find &lt;code class=&quot;language-text&quot;&gt;m&lt;/code&gt; only from the time it takes to encrypt an image.&lt;/p&gt;
&lt;p&gt;Actually from the start, keeping &lt;code class=&quot;language-text&quot;&gt;m&lt;/code&gt; secret is irrelevant, because after all, it is impossible that the value &lt;code class=&quot;language-text&quot;&gt;m&lt;/code&gt; would be too high, since it can bring performance issue if the value of &lt;code class=&quot;language-text&quot;&gt;m&lt;/code&gt; is too high. So, we can also just brute-force &lt;code class=&quot;language-text&quot;&gt;m&lt;/code&gt;.&lt;/p&gt;
&lt;h3 id=&quot;recovery-of-p-and-q&quot;&gt;&lt;a href=&quot;#recovery-of-p-and-q&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Recovery of &lt;code class=&quot;language-text&quot;&gt;p&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;q&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;After getting the value of &lt;code class=&quot;language-text&quot;&gt;m&lt;/code&gt;, finding &lt;code class=&quot;language-text&quot;&gt;p&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;q&lt;/code&gt; is trivial.&lt;/p&gt;
&lt;p&gt;The idea is that we will create plain image where all of the pixels contain value of black color (0), except for one pixel that will be white colored (255) or value other than 0.&lt;/p&gt;
&lt;p&gt;For example, we specify the white pixel on &lt;code class=&quot;language-text&quot;&gt;(1, 0)&lt;/code&gt;, then plain image with 4x4 size can be represented as the following matrix.&lt;/p&gt;
$$
\begin{pmatrix}
0 &amp; 255 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 \\
\end{pmatrix}
$$
&lt;p&gt;Enter the plain image into encryption oracle, get the corresponding cipher image, then decrypt it using keystream that we got before, so we have permutated plain-image.&lt;/p&gt;
&lt;p&gt;Lets assume the permutated plain image is as follows.&lt;/p&gt;
$$
\begin{pmatrix}
0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 255 &amp; 0 \\
\end{pmatrix}
$$
&lt;p&gt;Then, we can conclude that our previous pixel on &lt;code class=&quot;language-text&quot;&gt;(1, 0)&lt;/code&gt; move to &lt;code class=&quot;language-text&quot;&gt;(2, 3)&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Lets assume &lt;code class=&quot;language-text&quot;&gt;m = 3&lt;/code&gt;, then the equation of ACM will be as follows.&lt;/p&gt;
$$
    \begin{bmatrix}
    2 \\
    3 \\
    \end{bmatrix}
    =
    \begin{bmatrix}
    1 &amp; p \\
    q &amp; pq + 1 \\
    \end{bmatrix}^3
    \begin{bmatrix}
    1 \\
    0 \\
    \end{bmatrix}
    \mod N
$$
&lt;p&gt;It can be rewritten to:&lt;/p&gt;
$$
\begin{equation}
\begin{aligned}
2 &amp;\equiv \left( \left( p \cdot q + 1 \right) \cdot p + p \right) \cdot q + p \cdot q + 1 \pmod{N} \\ 
3 &amp;\equiv \left( \left( p \cdot q + 1 \right)^2 + p \cdot q \right) \cdot q + \left( p \cdot q + 1 \right) \cdot q + q \pmod{N}
\end{aligned}
\end{equation}
$$
&lt;p&gt;Where &lt;code class=&quot;language-text&quot;&gt;p&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;q&lt;/code&gt; can be found by solving linear equations in two variables (with modulus &lt;code class=&quot;language-text&quot;&gt;N&lt;/code&gt;).&lt;/p&gt;
&lt;p&gt;Finally, with the knowledge of keystream &lt;code class=&quot;language-text&quot;&gt;K&lt;/code&gt;, secret value &lt;code class=&quot;language-text&quot;&gt;p&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;q&lt;/code&gt;, and &lt;code class=&quot;language-text&quot;&gt;m&lt;/code&gt;, we can decrypt any image that was encrypted under this secret key :).&lt;/p&gt;
&lt;h3 id=&quot;proof-of-concept&quot;&gt;&lt;a href=&quot;#proof-of-concept&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Proof of Concept&lt;/h3&gt;
&lt;p&gt;Lets prove it by implementing it into Python.&lt;/p&gt;
&lt;p&gt;First, we define &lt;code class=&quot;language-text&quot;&gt;encryption_oracle()&lt;/code&gt; function which will be acting as a “server” where we can encrypt any image to that “server” and receive the corresponding cipher image.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; random&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; os
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; numpy &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; np
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; encryption
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; PIL &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; Image
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; Crypto&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Util&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;strxor &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; strxor

&lt;span class=&quot;token comment&quot;&gt;# Secret&lt;/span&gt;
p &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; random&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;randint&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;250&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
q &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; random&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;randint&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;250&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
m &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;
init &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; random&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;random&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
r &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; random&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;random&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;encryption_oracle&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;plain_image&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; encryption&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;encrypt&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;plain_image&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; p&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; q&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; m&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; init&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; r&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Then, write function to find keystream from chosen-plain image attack.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;recover_keystream&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;size&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;# Generate full-black image&lt;/span&gt;
    plain_image &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Image&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;new&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;RGB&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;size&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; size&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;# Send image to encryption oracle&lt;/span&gt;
    cipher_image &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; encryption_oracle&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;plain_image&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;# Convert plain_image and cipher_image to bytes&lt;/span&gt;
    plain_image_bytes &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;bytes&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;np&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;array&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;plain_image&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;flatten&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;tolist&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    cipher_image_bytes &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;bytes&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;np&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;array&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;cipher_image&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;flatten&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;tolist&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;# Recover 8-bit keystream&lt;/span&gt;
    k &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;strxor&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;plain_image_bytes&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; cipher_image_bytes&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;# Get 4-bit MSB keystream&lt;/span&gt;
    keystream &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; i &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;size&lt;span class=&quot;token operator&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        bit_len &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;k&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;i&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;bit_length&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; bit_len &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            msb &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; k&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;i&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;bit_len&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            msb &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;
        
        keystream&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;append&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;msb&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    

    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; keystream&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Then, write function to find &lt;code class=&quot;language-text&quot;&gt;m&lt;/code&gt; through Timing Attack.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;recover_m&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# avg. second of one encryption execution time (depends on the machine)&lt;/span&gt;
    one_exec_time &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt; 

    start_time &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; time&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;time&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    payload &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Image&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;new&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;RGB&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    encryption_oracle&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;payload&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    end_time &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; time&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;time&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    elapsed_time &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; end_time &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; start_time
    m &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;elapsed_time &lt;span class=&quot;token operator&quot;&gt;//&lt;/span&gt; one_exec_time&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;# Result could be faster or slower&lt;/span&gt;
    possible_m &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;m&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; m&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; m&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; possible_m&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Lastly, to find &lt;code class=&quot;language-text&quot;&gt;p&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;q&lt;/code&gt;, we will use &lt;strong&gt;Sagemath&lt;/strong&gt; with the &lt;code class=&quot;language-text&quot;&gt;solve_mod()&lt;/code&gt; function to solving linear equations in two variables as we discussed earlier.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;#!/usr/bin/env sage&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;recover_pq&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;m&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; x0&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; y0&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; x1&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; y1&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; N&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;

    var&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;p,q&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    xy &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; matrix&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;x0&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;y0&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    A &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; matrix&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;p&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;q&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; p&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;q &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    pos_result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; solve_mod&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;A&lt;span class=&quot;token operator&quot;&gt;^&lt;/span&gt;m &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; xy&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; x1&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;A&lt;span class=&quot;token operator&quot;&gt;^&lt;/span&gt;m &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; xy&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; y1
        &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; N&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; pos_result

&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; __name__ &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;__main__&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;

    m &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;7&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# ACM iteration&lt;/span&gt;
    x0 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
    y0 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;
    x1 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;489&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# x-coordinate after permutation&lt;/span&gt;
    y2 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;396&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# y-coordinate after permutation&lt;/span&gt;
    N &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;512&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# image size&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Possible p,q: &quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;recover_pq&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;m&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; x0&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; y0&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; x1&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; y2&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; N&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Full implementation of this attack can be found in &lt;a href=&quot;https://github.com/Merricx/chaos-image-encryption&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;this link&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&quot;static-secret-key-with-dynamic-x0&quot;&gt;&lt;a href=&quot;#static-secret-key-with-dynamic-x0&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Static Secret Key with Dynamic &lt;code class=&quot;language-text&quot;&gt;x0&lt;/code&gt;&lt;/h2&gt;
&lt;p&gt;The next implementation scenario is assumed that the variable &lt;code class=&quot;language-text&quot;&gt;p&lt;/code&gt;,&lt;code class=&quot;language-text&quot;&gt;q&lt;/code&gt;,&lt;code class=&quot;language-text&quot;&gt;m&lt;/code&gt;,&lt;code class=&quot;language-text&quot;&gt;r&lt;/code&gt; is static but the variable &lt;code class=&quot;language-text&quot;&gt;x0&lt;/code&gt; is dynamic, where this value will change randomly in different encryption request.&lt;/p&gt;
&lt;p&gt;This is the most ideal scenario that can possibly implemented in this scheme, because static keystream is no longer happened.&lt;/p&gt;
&lt;p&gt;However, the problem is how this &lt;code class=&quot;language-text&quot;&gt;x0&lt;/code&gt; can be associated in each of different images. One possible approach is to treat &lt;code class=&quot;language-text&quot;&gt;x0&lt;/code&gt; as Initialization Vector (IV) as we seen in block cipher. But, this value must still be encrypted again with certain method and listed in every image that has been encrypted using that value.&lt;/p&gt;
&lt;p&gt;Let’s ignore the technical side of how &lt;code class=&quot;language-text&quot;&gt;x0&lt;/code&gt; implemented. Our assumption in this scenario is that for every request to the encryption oracle, the value of &lt;code class=&quot;language-text&quot;&gt;x0&lt;/code&gt; will be arbitrary and random.&lt;/p&gt;
&lt;p&gt;Because repeated keystream can no longer be exploited, it will be difficult for us to finding the keystream from chosen-plain image attack, since this encryption basically becomes &lt;strong&gt;One-Time Pad&lt;/strong&gt;. &lt;/p&gt;
&lt;h3 id=&quot;recover-acm-secret&quot;&gt;&lt;a href=&quot;#recover-acm-secret&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Recover ACM secret&lt;/h3&gt;
&lt;p&gt;Then how can we find &lt;code class=&quot;language-text&quot;&gt;p&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;q&lt;/code&gt; without knowing the &lt;em&gt;keystream&lt;/em&gt; that currently used? &lt;/p&gt;
&lt;p&gt;This is where the security flaw from the use of &lt;strong&gt;“selective encryption”&lt;/strong&gt; occurs, where cipher image leaks information from the LSB of the plain image. &lt;/p&gt;
&lt;p&gt;Lets assume we use plain image that represented as follows:&lt;/p&gt;
$$
\begin{pmatrix}
0 &amp; 255 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 \\
\end{pmatrix}
$$
&lt;p&gt;Enter the plain image into encryption oracle. Then, suppose we get cipher image as follows.&lt;/p&gt;
$$
\begin{pmatrix}
32 &amp; 96 &amp; 176 &amp; 32 \\
112 &amp; 240 &amp; 112 &amp; 144 \\
32 &amp; 95 &amp; 192 &amp; 80 \\
176 &amp; 208 &amp; 48 &amp; 160 \\
\end{pmatrix}
$$
&lt;p&gt;Lets change each of the pixel to binary representation and boom!! &lt;em&gt;LSB oracle goes brrrr!&lt;/em&gt;&lt;/p&gt;
$$
\begin{pmatrix}
00100000 &amp; 01100000 &amp; 10110000 &amp; 00100000 \\
01110000 &amp; 11110000 &amp; 01110000 &amp; 10010000 \\
00100000 &amp; 01011111 &amp; 11000000 &amp; 01010000 \\
10110000 &amp; 11010000 &amp; 00110000 &amp; 10100000 \\
\end{pmatrix}
$$
&lt;p&gt;Because of this selective encryption scheme, we still know the position of our white pixel after the permutation because 4-bit LSB of the plain image never changes (just looks 4-bit LSB that doesn’t have the value &lt;code class=&quot;language-text&quot;&gt;0000&lt;/code&gt;). &lt;/p&gt;
&lt;p&gt;Just continue using the same method as the previous scenario by solving the linear equations of two variables to find &lt;code class=&quot;language-text&quot;&gt;p&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;q&lt;/code&gt; (value of &lt;code class=&quot;language-text&quot;&gt;m&lt;/code&gt; can still be found through Timing Attack). &lt;/p&gt;
&lt;p&gt;Next, how can we find dynamic &lt;em&gt;keystream&lt;/em&gt; value? Meanwhile One-Time Pad is an “unbreakable cipher”. &lt;/p&gt;
&lt;h3 id=&quot;weak-logistic-map&quot;&gt;&lt;a href=&quot;#weak-logistic-map&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Weak Logistic Map&lt;/h3&gt;
&lt;p&gt;The only thing we can try to exploit is from the implementation of Logistic Map. &lt;/p&gt;
&lt;p&gt;Analysis of how Logistic Map works is beautifully explained in &lt;u&gt;geoffboeing.com&lt;/u&gt; &lt;sup&gt;&lt;a href=&quot;#references&quot;&gt;[2]&lt;/a&gt;&lt;/sup&gt;. Interestingly, there are several things that can make the generation results of Logistic Map repetitive and periodic if the constant &lt;code class=&quot;language-text&quot;&gt;r&lt;/code&gt; and the initial value &lt;code class=&quot;language-text&quot;&gt;x0&lt;/code&gt; are not picked carefully. &lt;/p&gt;
&lt;p&gt;Let’s try to do a little experiment using the implemented Logistic Map based on this article in generating keystream. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; random
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; encryption

&lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; i &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    init &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; random&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;random&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    r &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; random&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;randint&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; random&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;random&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;x0:&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; init&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;r :&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; r&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;keystream&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; encryption&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;logistic_map&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;init&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; r&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Running the script and take some interesting result.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;x0: 0.7244972999777215
r : 2.2929146462509595
keystream: [7, 2, 15, 3, 5, 14, 0, 9, 1, 15, 7, 10, 0, 11, 10, 14, 6, 4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]

x0: 0.18893176526337663
r : 1.6653541535673568
keystream: [4, 9, 3, 1, 9, 7, 10, 8, 15, 15, 11, 7, 2, 15, 6, 12, 0, 8, 5, 15, 8, 11, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12]

x0: 0.8927173285063715
r : 3.5157732279084075
keystream: [5, 13, 12, 12, 14, 5, 4, 0, 8, 0, 5, 8, 10, 0, 2, 11, 9, 0, 9, 7, 15, 2, 5, 14, 1, 2, 10, 15, 14, 11, 9, 15, 0, 9, 15, 7, 7, 13, 15, 1, 3, 11, 0, 2, 2, 1, 0, 15, 13, 2, 6, 15, 4, 8, 4, 12, 0, 2, 12, 1, 5, 6, 6, 12, 8, 0, 10, 5, 8, 15, 4, 10, 0, 4, 1, 4, 9, 1, 2, 0, 6, 8, 2, 1, 7, 5, 2, 1, 6, 6, 2, 1, 7, 6, 2, 1, 6, 6, 2, 1, 7, 6, 2, 1, 6, 6, 2, 1, 6, 6, 2, 1, 6, 6, 2, 1, 6, 6, 2, 1, 6, 6, 2, 1, 6, 6, 2, 1, 6, 6, 2, 1, 6, 6, 2, 1, 6, 6, 2, 1, 6, 6, 2, 1, 6, 6, 2, 1, 6, 6, 2, 1]&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;As we can see from the generated keystream above, the Logistic Map produces sequence that is truly repetitive both statically and periodically.&lt;/p&gt;
&lt;p&gt;Based from the experiment, we can note some value in the constant &lt;code class=&quot;language-text&quot;&gt;r&lt;/code&gt; that will potentially cause repetitive keystream.&lt;/p&gt;
&lt;p&gt;The list of constants &lt;code class=&quot;language-text&quot;&gt;r&lt;/code&gt; that potentially generate a static &lt;em&gt;keystream&lt;/em&gt; is: &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;1.1 ~ 2.4
2.6 ~ 2.8
3.3&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Whereas, The list of constants &lt;code class=&quot;language-text&quot;&gt;r&lt;/code&gt; that potentially generate periodic &lt;em&gt;keystream&lt;/em&gt; is: &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;2.5
2.9
3.1
3.2
3.4
3.5&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;From the two phenomena above, it can be concluded that the key space in choosing the constant &lt;code class=&quot;language-text&quot;&gt;r&lt;/code&gt; is increasingly limited to avoid repeated keystream, both statically and periodically. &lt;/p&gt;
&lt;p&gt;So, the constant &lt;code class=&quot;language-text&quot;&gt;r&lt;/code&gt; that might be chosen to avoid repetition is to choose one of the following values. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;1.0~
3.0~
3.6~
3.7~
3.8~
3.9~&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;For the values of 0.9 and below are ignored because after several generation process, the sequence will tend to 0 values, so it can’t generate large keystream.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;So, to get dynamic keystream from the Logistic Map, first we check whether there are repetition in the pixels of the cipher image (especially at the bottom pixels). For static repetition, we simply brute-force 1 out of 16 possible values, while for periodic repetition, we simply brute-force 2 to 4 out of 16 possible values. &lt;/p&gt;
&lt;p&gt;If there is no sign of repetition of the keystream bit, we can brute-force to find the value of the constant &lt;code class=&quot;language-text&quot;&gt;r&lt;/code&gt; from a list of possible values that will not cause repetition previously along with the initial value of &lt;code class=&quot;language-text&quot;&gt;x0&lt;/code&gt;. &lt;/p&gt;
&lt;h3 id=&quot;proof-of-concept-1&quot;&gt;&lt;a href=&quot;#proof-of-concept-1&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Proof of Concept&lt;/h3&gt;
&lt;p&gt;Implementation of this attack can be accessed in &lt;a href=&quot;https://github.com/Merricx/chaos-image-encryption&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;this link&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&quot;conclusion&quot;&gt;&lt;a href=&quot;#conclusion&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Conclusion&lt;/h1&gt;
&lt;p&gt;From the two implementation scenarios that discussed above, it can be concluded that this Chaos-based Image Encryption is truly vulnerable to Chosen-Plain image Attack (Known-Plain image Attack can also viable in some conditions). &lt;/p&gt;
&lt;p&gt;Both the Arnold’s Cat Map, Logistic Map, as well as the use of the selective encryption are vulnerable that can make &lt;em&gt;attacker&lt;/em&gt; decrypt any encrypted image without access to the secret key that is currently used. Lastly, further development needs to be studied to produce even better algorithm, especially in terms of security. &lt;/p&gt;
&lt;h1 id=&quot;references&quot;&gt;&lt;a href=&quot;#references&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;References&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;Munir, Rinaldi. (2012). ANALISIS KEAMANAN ALGORITMA ENKRIPSI CITRA DIGITAL MENGGUNAKAN KOMBINASI DUA CHAOS MAP DAN PENERAPAN TEKNIK SELEKTIF. JUTI: Jurnal Ilmiah Teknologi Informasi. 10. 89. 10.12962/j24068535.v10i2.a310.  &lt;/li&gt;
&lt;li&gt;Boeing, G. (2016). Visual Analysis of Nonlinear Dynamical Systems: Chaos, Fractals, Self-Similarity and the Limits of Prediction. Systems, 4 (4), 37. doi:10.3390/systems4040037&lt;/li&gt;
&lt;/ol&gt;
                &lt;div style=&quot;margin-top=55px; font-style: italic;&quot;&gt;You can read it online by &lt;a href=&quot;https://merricx.github.io/dont-roll-your-own-crypto-1/&quot;&gt;clicking here&lt;/a&gt;&lt;/div&gt;
              </content:encoded></item><item><title><![CDATA[[NahamConCTF 2021] - Elliptical]]></title><description><![CDATA[Write-up Elliptical - NahamConCTF 2021]]></description><link>https://merricx.github.io/nahamconctf-elliptical/</link><guid isPermaLink="false">https://merricx.github.io/nahamconctf-elliptical/</guid><pubDate>Sun, 14 Mar 2021 20:00:00 GMT</pubDate><content:encoded>&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;https://merricx.github.io/static/a01a38a0dcad4599e0852243d8d126fc/39a20/challs.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 39.189189189189186%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABTklEQVR42n2Qy07EMAxF+wuIoemLNkmbtNN2+mTQwPCQeCzYwYol//8Vl9hlYIQEi6N77ViOba9+aPD0/oj+ucfN6x7m1uJsEBBjsDCFCMYQiYPy/hCw/oXXUaO3Par7EtuXGXqfQ+4k8muN9DJFvMswXxl83M04GXz47pP/8FbnAqeJDyEjR4hQxYh0whpwLmKfqIT9IffbH/CyTMGYEnlhURjLXqocZ777UYQM+dVR/JNfVASueRAzXpJmUHkOpRckKcV5gUxphmKp3Qmk+s4teapRCKIYIopYPSoq12sU1qJqava2rFDV9TJxWaJa1zDWbWEMvxFUXzcNv4WxO0f41ZAKx3nCpu1ghURbtximEZuuRz8M2PQ9hnFkP80zeufbrsPFdstvvmt0aEbqVk6hi8Ldza0RZ5ByWeVwAu08TUmelGI6iy4Mx8fTEZ/ZduBOuUBEnQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;challs&quot;
        title=&quot;&quot;
        src=&quot;https://merricx.github.io/static/a01a38a0dcad4599e0852243d8d126fc/fcda8/challs.png&quot;
        srcset=&quot;https://merricx.github.io/static/a01a38a0dcad4599e0852243d8d126fc/12f09/challs.png 148w,https://merricx.github.io/static/a01a38a0dcad4599e0852243d8d126fc/e4a3f/challs.png 295w,https://merricx.github.io/static/a01a38a0dcad4599e0852243d8d126fc/fcda8/challs.png 590w,https://merricx.github.io/static/a01a38a0dcad4599e0852243d8d126fc/39a20/challs.png 859w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;h1 id=&quot;challenge&quot;&gt;&lt;a href=&quot;#challenge&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Challenge&lt;/h1&gt;
&lt;p&gt;Given website where user can sign in with any username, except with username &lt;code class=&quot;language-text&quot;&gt;admin&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;https://merricx.github.io/static/591ea1bf0302fb20cd2300e4931b0ec6/fe9e8/4.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 50.67567567567568%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA3UlEQVR42p1Syw7CIBD0/z/LGGuiZzV6s60HH23tAygUxgWrVm0juslkA8wOswsjdMIY85KHwp4PcUdDRCklGGMQQoAz7rJbc/GfIOMc680WYRwjy3OHU5K4/OD6CKIVNU0DlRdoyhIQNUDOLAy5tWdd7leHlqIrhmy2QDKb4zgJcBhPcQ7mSGlPF+XDnZ9DK0gzk7sIKtrjstogW64hw5j2Qmjr0lfwDk2oqLBsi22kHDhUQN2gbddnhh1hpZSD1hqGUCsDJukybX54lJ5WnusbvL/NO+FT+IY+7j2u3GgUEIqIkD0AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;4&quot;
        title=&quot;&quot;
        src=&quot;https://merricx.github.io/static/591ea1bf0302fb20cd2300e4931b0ec6/fcda8/4.png&quot;
        srcset=&quot;https://merricx.github.io/static/591ea1bf0302fb20cd2300e4931b0ec6/12f09/4.png 148w,https://merricx.github.io/static/591ea1bf0302fb20cd2300e4931b0ec6/e4a3f/4.png 295w,https://merricx.github.io/static/591ea1bf0302fb20cd2300e4931b0ec6/fcda8/4.png 590w,https://merricx.github.io/static/591ea1bf0302fb20cd2300e4931b0ec6/efc66/4.png 885w,https://merricx.github.io/static/591ea1bf0302fb20cd2300e4931b0ec6/fe9e8/4.png 1146w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;After signed in, website will show simple static text and image that shown below and the bottom text that says “Sorry, only admin can see the flag”.&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;https://merricx.github.io/static/c5eeb684cc56b7f78d5e8715d228d346/d5c6f/1.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 70.27027027027026%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAABbklEQVR42o2S2XLCMAxF+/9/xTsvbVPaEmCSgJOULJRmcTb7VnJZXEohmtHIY8vXR5IfQKa1Ns42DAM838dyuYIQIYJgjSiK4fsB0jSDUgp936Prul/3jvHhmmAYRUZksxGI4tis2UUYIgwjc15W1XjBJE2RZhmSJMU2SYzzuiKRtm0hm8bk2UK3BUmAifI8R13XRoi9KAryEmVZ0r68LWhHvsxCUkp6QOHSuH9MeleQG84mhMB0OsVkMsFq4QG9gpY1QKVqGojjOHDn83GENiWXvN8XaErqHZWriJjwDH1D4rg1FFvQ7idT6wM9l6kOZ5cAowSrokZfE0nXGrKOqPgPXsu9K8g7A11uqMyWhBqi42GYvJ/kcYL/mRmY/eA9weNGy00nmoqoOLKXUp7JLNNjPrbMciTPM3w8vSBxXrF1ZogfHTT+Gn0Yn11EUPTJ7fKvE+52+Hp3UbhLiotT/HxzUXvByauVhzbf/Zn2N1oDRaI5fju5AAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;1&quot;
        title=&quot;&quot;
        src=&quot;https://merricx.github.io/static/c5eeb684cc56b7f78d5e8715d228d346/fcda8/1.png&quot;
        srcset=&quot;https://merricx.github.io/static/c5eeb684cc56b7f78d5e8715d228d346/12f09/1.png 148w,https://merricx.github.io/static/c5eeb684cc56b7f78d5e8715d228d346/e4a3f/1.png 295w,https://merricx.github.io/static/c5eeb684cc56b7f78d5e8715d228d346/fcda8/1.png 590w,https://merricx.github.io/static/c5eeb684cc56b7f78d5e8715d228d346/efc66/1.png 885w,https://merricx.github.io/static/c5eeb684cc56b7f78d5e8715d228d346/c83ae/1.png 1180w,https://merricx.github.io/static/c5eeb684cc56b7f78d5e8715d228d346/d5c6f/1.png 1261w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;Based on that observation, we can conclude that in this challenge, we must change our username to &lt;code class=&quot;language-text&quot;&gt;admin&lt;/code&gt; by exploiting “some crypto magic”.&lt;/p&gt;
&lt;p&gt;So, what is the indicator that used by website so that it knows who is currently accessing the page?&lt;/p&gt;
&lt;h1 id=&quot;jwt&quot;&gt;&lt;a href=&quot;#jwt&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;JWT&lt;/h1&gt;
&lt;p&gt;Of course, the most common mechanism to store information about the user that currently accessing a website is called &lt;strong&gt;cookie&lt;/strong&gt;.&lt;br&gt;
In this challenge, cookie is used in the form of JSON Web Token (JWT) to store the information about current user.&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;https://merricx.github.io/static/57c0bedc7300c830ff4f512dc65dc40e/1ddef/3.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 125.67567567567568%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAZCAYAAAAxFw7TAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADNElEQVR42qWUyY4URxCG8yVsmTfgYgn5YMtIfgM/FByRJVuyLfnGK3DGByQLfLOAWXBPd83SSy1dmbV2ZVZVZi2/I5PuGQ9MAxpK/XUulcsfURHBJssMT18c4MXrUzw/uMAyH7DI+ivyLdRfUrsqiPx9/HLE8WQG9vVPHD/8UeLHxznu/Zzg+99SIsG3v6b4jrBz3/yS4P7vKe4+EvjyAcedhxxfbbnjiPHFA4HHf/4L9veE48lfb/Ds1QJP/5nj2UGIEz7gODJEd8W6wxG1h6G5kaOox8ujEzBZJJi+OUQuIsTBAsnaBzDiNs86CsFiLnBweIyTqeewfT+I3JH9MH4U+l1eX1UVWJqmCIIAQgjkeY6yLJFl+V4V4zheQ2vt9ti9nHOwoihQ1zVkJaGo7fuB6N3CdzHGoOt6otvSu8utGHsYJ2uZ7/uYzWbwPM9h+7vxbOZdzk+nU6xWK0gpsdlsiMphx0opJ8qqZPZPSeXst1h1exkGDB/AWseESBBEkTPXmrSP7v9jvWcdzTPrg8YrINcKK6EQcGpjiYuwwjyqECUKi7XEkuZ43rh+lNQIxdt5u9bn0vUFvWe6bbCpBpzFBn7SwI8VbVaY0wUhbfRFjYtIOlpNH6QfHdoMl5iO2i3M0IFpM+KccjUuDU4jhfNQ4iwghXTrOm1QSPPJwc2MbiDkiJno4GcdqerAZQ+eNWRi62JtF3/DOzF4E05hVo+Y0IGct8BSflTF7pK9ClM14pSULYShfKQLNhoxKbQ+TMrWYdUG5M+67a9lzPsHWh+SQj/TkHpAS8nZmt59gIbYOd6O7WE2f68OvEGh3prskcki1YgobHYqPjWfr/mwMy3IOsyp6tZBjaHub1m8tgrLsqAg3eDcTxAnOXpKemNuD+M8QU4lLE8TVzk0pU/bbtFb2utz+gMwKSsoPaLSgGlrctCAz3lY29QoyG9zTim2IrMzhZhCxGaIC5mideGzw4aTjYJ9H4c1TeNeRqnNWQXPr3BKTOala2erDdJSY6MMSkpBWVNh7fdbwWxZolxHSIo82mzz+CJ8WwzOAiK01aTGmpRVdedUClId0Xo7b3FFhFo79x+Lm3KJ8iB2UQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;3&quot;
        title=&quot;&quot;
        src=&quot;https://merricx.github.io/static/57c0bedc7300c830ff4f512dc65dc40e/fcda8/3.png&quot;
        srcset=&quot;https://merricx.github.io/static/57c0bedc7300c830ff4f512dc65dc40e/12f09/3.png 148w,https://merricx.github.io/static/57c0bedc7300c830ff4f512dc65dc40e/e4a3f/3.png 295w,https://merricx.github.io/static/57c0bedc7300c830ff4f512dc65dc40e/fcda8/3.png 590w,https://merricx.github.io/static/57c0bedc7300c830ff4f512dc65dc40e/1ddef/3.png 635w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;Basically, JSON Web Token consists of 3 main parts, which is &lt;strong&gt;header&lt;/strong&gt;, &lt;strong&gt;payload&lt;/strong&gt;, and &lt;strong&gt;signature&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;https://merricx.github.io/static/8e15af8a4abfbf7d8850c3b20b565563/d0fa6/jwt.io.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 65.54054054054055%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAABbUlEQVR42o2TC2+CMBSF/f//b9mWOBM3mYIEgT7o47Znt0URx9SRfJQWenrug5UxBsVhj1b2IMRMBDLzq65rFLsdhmGAcw5ElNdjjDesYgigqkMse2DPlAKoJI8SltecMnmjVhpKqyzmvV8ITYKBBY+tx/eRUJQeReVRVQTTEBrhoXxINoDA9CwuDe5dWZD4tjEBr5oZxrGmiBMLuNmHllPjGLCBe+7GkGeTcGZ25PTOOQ/vOMPJcHgiiBgX1i9Mcw49cATR8Jp/EPK0+Z7Q+fkkJD7rBpKrbKyFMRbWXkndkuqx+i2wdDqG3qoBb43CRyOxPUn0fIBgpBwRQuTqPxc851IMBh+SsFGELw77IDS6tuVW4nZSKoum3vy3w04brKXHYSDsuSuO2mZXWeyR4IKZw3fuyxdBWOuIXafQtqfs8BL2QvDPyuHqcKsJtWV3Lo4O+34KN3GTw2codlhy3hIpf7XU/DuqLHghOfwBZaL8i2fimCsAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;jwt io&quot;
        title=&quot;&quot;
        src=&quot;https://merricx.github.io/static/8e15af8a4abfbf7d8850c3b20b565563/fcda8/jwt.io.png&quot;
        srcset=&quot;https://merricx.github.io/static/8e15af8a4abfbf7d8850c3b20b565563/12f09/jwt.io.png 148w,https://merricx.github.io/static/8e15af8a4abfbf7d8850c3b20b565563/e4a3f/jwt.io.png 295w,https://merricx.github.io/static/8e15af8a4abfbf7d8850c3b20b565563/fcda8/jwt.io.png 590w,https://merricx.github.io/static/8e15af8a4abfbf7d8850c3b20b565563/efc66/jwt.io.png 885w,https://merricx.github.io/static/8e15af8a4abfbf7d8850c3b20b565563/c83ae/jwt.io.png 1180w,https://merricx.github.io/static/8e15af8a4abfbf7d8850c3b20b565563/d0fa6/jwt.io.png 1263w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;header&lt;/strong&gt; contains the information about algorithm that is used to sign and build &lt;strong&gt;signature&lt;/strong&gt; part. &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;payload&lt;/strong&gt; contains main information about the user that currently accessing the web.&lt;/p&gt;
&lt;p&gt;And then, &lt;strong&gt;signature&lt;/strong&gt; is the hash result of &lt;strong&gt;header&lt;/strong&gt; and &lt;strong&gt;payload&lt;/strong&gt; (Base64-encoded and concatenated by dot) using algorithm that defined by &lt;strong&gt;alg&lt;/strong&gt; in &lt;strong&gt;header&lt;/strong&gt; part.&lt;/p&gt;
&lt;p&gt;This &lt;strong&gt;signature&lt;/strong&gt; then is used as verification whether data on &lt;strong&gt;header&lt;/strong&gt; or &lt;strong&gt;payload&lt;/strong&gt; has been modified or not. If data on &lt;strong&gt;header&lt;/strong&gt; or &lt;strong&gt;payload&lt;/strong&gt; has been modified or forged, then the result of &lt;strong&gt;signature&lt;/strong&gt; will not be the same, thus the token will be considered invalid.&lt;/p&gt;
&lt;p&gt;Every part of JWT will be encoded with Base64Url and separated with dot sign (&lt;strong&gt;.&lt;/strong&gt;).&lt;/p&gt;
&lt;p&gt;In this challenge, the hash algorithm use &lt;strong&gt;ES256&lt;/strong&gt; or &lt;strong&gt;ECDSA-SHA256&lt;/strong&gt;. On the &lt;strong&gt;payload&lt;/strong&gt; part, it only contains &lt;code class=&quot;language-text&quot;&gt;username&lt;/code&gt; of the current user.&lt;/p&gt;
&lt;h1 id=&quot;vulnerability-analysis&quot;&gt;&lt;a href=&quot;#vulnerability-analysis&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Vulnerability Analysis&lt;/h1&gt;
&lt;p&gt;If we pay attention to the signing process in this web, there’s an oddity on the resulting &lt;strong&gt;signature&lt;/strong&gt; after we signed in multiple times, as shown below.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;Username: admin1
wN0kGlDUj5n8x6GGptROB2PskEeOHe-ONvXE6VDWevsS2fyKPc817Sox60QP-jgXhlM0kVkjKFhk-VUgMSOYjg


Username: some random username
wN0kGlDUj5n8x6GGptROB2PskEeOHe-ONvXE6VDWevuVkYXwniERimgSFQ2cea0-BUwYCLQ60reeuAIyROAxkw


Username: hehehe
wN0kGlDUj5n8x6GGptROB2PskEeOHe-ONvXE6VDWevsfeMT3XhGF_QCc2Ed1V1V9-F5VPrPSakhNGecWfgQQbw&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Yupp, there’s big repeating signature result even with completely different username.&lt;/p&gt;
&lt;p&gt;A secure hash algorithm when there’s little input difference, even only 1 byte, it should produce a completely different hash result. But in this web, the first 64 byte on the resulting signature never change.&lt;/p&gt;
&lt;p&gt;Other than that, if we repeat the signing process with same username, the resulting signature also never change.&lt;/p&gt;
&lt;p&gt;Whereas, algorithm in ES256 or ECDSA is asymmetric algorithm that even the same message should produce different signature because the random property in it.&lt;/p&gt;
&lt;p&gt;So, we can conclude that there’s something that should be random but it isn’t :/&lt;/p&gt;
&lt;h1 id=&quot;ecdsa&quot;&gt;&lt;a href=&quot;#ecdsa&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;ECDSA&lt;/h1&gt;
&lt;p&gt;We will briefly discuss how ECDSA algorithm signing a message.&lt;/p&gt;
&lt;p&gt;ECDSA (&lt;em&gt;Elliptic-Curve Digital Signature Algorithm&lt;/em&gt;) is the variant of DSA (Digital Signature Algorithm) which uses Elliptic-Curve as its signature calculation.&lt;/p&gt;
&lt;p&gt;In the Elliptic-Curve, there’s some parameters that defined before doing any calculations. Here are the parameters used specifically in ES256.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;G = (0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296, 0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5)
n = 115792089210356248762697446949407573529996955224135760342422259061068512044369
d = random(1, n-1)
Q = d * G&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;where&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;G = Elliptic curve base point
n = integer order of G
d = private key
Q = public key&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Suppose we want to sign message &lt;code class=&quot;language-text&quot;&gt;m&lt;/code&gt;, then we do the following steps:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Calculate &lt;code class=&quot;language-text&quot;&gt;e&lt;/code&gt;, where &lt;code class=&quot;language-text&quot;&gt;e = SHA256(m)&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;Calculate &lt;code class=&quot;language-text&quot;&gt;z&lt;/code&gt; where &lt;code class=&quot;language-text&quot;&gt;z = int(e, 16)&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;Pick random integer &lt;code class=&quot;language-text&quot;&gt;k&lt;/code&gt; from interval &lt;code class=&quot;language-text&quot;&gt;[1, n-1]&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;Calculate the curve point &lt;code class=&quot;language-text&quot;&gt;(x1, x2) = k * G&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Calculate &lt;code class=&quot;language-text&quot;&gt;r = x1 % n&lt;/code&gt;. If &lt;code class=&quot;language-text&quot;&gt;r = 0&lt;/code&gt;, repeat the &lt;code class=&quot;language-text&quot;&gt;k&lt;/code&gt; selection.&lt;/li&gt;
&lt;li&gt;Calculate &lt;code class=&quot;language-text&quot;&gt;s = (inverse_mod(k, n) * (z + (r * d) % n)) % n&lt;/code&gt;. If &lt;code class=&quot;language-text&quot;&gt;s = 0&lt;/code&gt;, repeat the &lt;code class=&quot;language-text&quot;&gt;k&lt;/code&gt; selection.&lt;/li&gt;
&lt;li&gt;The valid signature is the pair &lt;code class=&quot;language-text&quot;&gt;(r, s)&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;not-so-random-k&quot;&gt;&lt;a href=&quot;#not-so-random-k&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Not so random k&lt;/h1&gt;
&lt;p&gt;As we have analyzed previously, there’s possibility that the “random” on the ECDSA in this challenge is not random.&lt;/p&gt;
&lt;p&gt;From the signing calculations that we have discussed above, only &lt;code class=&quot;language-text&quot;&gt;k&lt;/code&gt; that was picked randomly. Therefore, we can assume that in this website, there’s Nonce reuse vulnerability, where integer &lt;code class=&quot;language-text&quot;&gt;k&lt;/code&gt; is static and used repeatedly on the different signing process.&lt;/p&gt;
&lt;p&gt;Then, why the value of &lt;code class=&quot;language-text&quot;&gt;k&lt;/code&gt; that is not random can cause dangerous flaw on this website?&lt;/p&gt;
&lt;p&gt;Given two valid signature &lt;code class=&quot;language-text&quot;&gt;(r, s1)&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;(r, s2)&lt;/code&gt; from the signing message &lt;code class=&quot;language-text&quot;&gt;m1&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;m2&lt;/code&gt; using the same &lt;code class=&quot;language-text&quot;&gt;k&lt;/code&gt;, attacker can trivially calculate &lt;code class=&quot;language-text&quot;&gt;z1&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;z2&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;And because &lt;code class=&quot;language-text&quot;&gt;s1 - s2 = inverse_mod(k, (z1 - z2))&lt;/code&gt;, attacker can find &lt;code class=&quot;language-text&quot;&gt;k&lt;/code&gt; by calculate:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;k = (z1 - z2) / (s1 - s2)&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Then, attacker can easily find &lt;code class=&quot;language-text&quot;&gt;d&lt;/code&gt; with:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;d = (s1 * k - z1) / r&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h1 id=&quot;proof-of-concept&quot;&gt;&lt;a href=&quot;#proof-of-concept&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Proof of Concept&lt;/h1&gt;
&lt;p&gt;Let’s implement the attack in Python to get the private key and generate valid JWT with username &lt;code class=&quot;language-text&quot;&gt;admin&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; Crypto&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Util&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;number &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; requests&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; base64&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; hashlib
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; fastecdsa &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; ecdsa
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; fastecdsa&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;curve &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; P256

&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;auth&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;user&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    session &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; requests&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Session&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    response &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; session&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;post&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;url&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;http://challenge.nahamcon.com:30200/signin&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; data&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;username&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;user&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    token &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; session&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;cookies&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get_dict&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;token&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
    hashed &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; token&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;split&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;.&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;.&apos;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; token&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;split&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;.&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
    signature &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; token&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;split&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;.&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

    raw_signature &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; base64&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;b64decode&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;signature&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;replace&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;-&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;+&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;replace&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;_&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;/&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;==&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;hex&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; hashed&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;encode&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;raw_signature&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;64&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;raw_signature&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;64&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;modinv&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;a&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; modulus&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;pow&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;a&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; modulus &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; modulus&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;divmod&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;a&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; b&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; modulus&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;a &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; modinv&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;b&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; modulus&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt; modulus

m1&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; r&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; s1 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; auth&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;admim&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
m2&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; r&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; s2 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; auth&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;admio&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

order &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; P256&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;q
z1 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;hashlib&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sha256&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;m1&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;hexdigest&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
z2 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;hashlib&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sha256&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;m2&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;hexdigest&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

k &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;divmod&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;z1 &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; z2&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; s1 &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; s2&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; order&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
d &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;divmod&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;k &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; s1 &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; z1&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; r&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; order&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;[+] Private key:&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; d&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

new_token &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;b&apos;eyJhbGciOiAiRVMyNTYiLCAidHlwIjogIkpXVCJ9.&apos;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; base64&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;b64encode&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;b&apos;{&quot;username&quot;:&quot;admin&quot;}&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
r&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; s &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; ecdsa&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sign&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;new_token&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; d&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;[+] Forged signature:&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;r&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; s&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
new_token &lt;span class=&quot;token operator&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;b&quot;.&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; base64&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;b64encode&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;long_to_bytes&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;r&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; long_to_bytes&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;replace&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;b&apos;+&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;b&apos;-&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;replace&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;b&apos;/&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;b&apos;_&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;replace&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;b&apos;=&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;b&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;[+] JWT:&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; new_token&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;decode&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Run the script and we got the valid JWT.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;~$ python solve_elliptic.py
&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;+&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; Private key: &lt;span class=&quot;token number&quot;&gt;76360441104529975103479885636071599682318869381694694853301440181334888705951&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;+&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; Forged signature: &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;66378196147239170843827166360250592759597163597715304772573917957470106804741&lt;/span&gt;, &lt;span class=&quot;token number&quot;&gt;106147551365476994967159598162752611693743616349309630180573719192813726918650&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;+&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; JWT: eyJhbGciOiAiRVMyNTYiLCAidHlwIjogIkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIn0&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;.ksC6RjVxDXfXips96dGXrpC0DoB87qpDSrBrBgn14gXqrWKQDWejXdEUJmwIoIVIcIrt8IuDGIRzZbPzbIjn-g&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Insert the resulting JWT as a cookie and we got the flag :D&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;https://merricx.github.io/static/620c218a063a1ad134d6cac508bdaeb7/d5c6f/flag.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 70.27027027027026%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAABdUlEQVR42pVS2ZaCMAz1/3/LZx90NsUFWRS1gBsFSil3kjLOcXTccs49KSG5vUnaAVnTNBZsuq7heT4838fMdeH7AfwgsN+MxWKBkHA8Hv/UnXznkrAmwjhJkKYp4jghxBAEPud5DqUUyrK0eedEdwmFEIiiCAmRMomU0oJVWWSZjd8lPPeczCoYxrSxc6uqClprKnhAaIyxPgxD9Ho9dLtduFMPNdUWZUMXUAfaYNDvw3GctqYx9xWeztyaEBvsdntSXFHLiuZnYCoN+UrL56SsWOua5tqQNyiL8vffpYCnCIuioHkxGSyKXLWz+yf3ISGDN86LUapFpas2z27jSYW3rGmuL3zqYatKIS9yZDKD5DeYS/vQOc7KeKsvEcpMQqwF1qsNkjhFSpi7HrTSN5Q/INwWe3xEIzhihpGYYriZYJy4hLn1/mGJRbaGf4xwUNnVtq8IE7nFYPmFz5Vjid+j4Y8f4Y3i49iFuw0woQtSyr2s/wZbckUAOuJRpgAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;flag&quot;
        title=&quot;&quot;
        src=&quot;https://merricx.github.io/static/620c218a063a1ad134d6cac508bdaeb7/fcda8/flag.png&quot;
        srcset=&quot;https://merricx.github.io/static/620c218a063a1ad134d6cac508bdaeb7/12f09/flag.png 148w,https://merricx.github.io/static/620c218a063a1ad134d6cac508bdaeb7/e4a3f/flag.png 295w,https://merricx.github.io/static/620c218a063a1ad134d6cac508bdaeb7/fcda8/flag.png 590w,https://merricx.github.io/static/620c218a063a1ad134d6cac508bdaeb7/efc66/flag.png 885w,https://merricx.github.io/static/620c218a063a1ad134d6cac508bdaeb7/c83ae/flag.png 1180w,https://merricx.github.io/static/620c218a063a1ad134d6cac508bdaeb7/d5c6f/flag.png 1261w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
                &lt;div style=&quot;margin-top=55px; font-style: italic;&quot;&gt;You can read it online by &lt;a href=&quot;https://merricx.github.io/nahamconctf-elliptical/&quot;&gt;clicking here&lt;/a&gt;&lt;/div&gt;
              </content:encoded></item><item><title><![CDATA[How I Got Free Movie Tickets by Abusing QR-Code]]></title><description><![CDATA[How I got free movie tickets through partially censored QR code]]></description><link>https://merricx.github.io/how-i-get-free-movie-tickets/</link><guid isPermaLink="false">https://merricx.github.io/how-i-get-free-movie-tickets/</guid><pubDate>Wed, 09 Jan 2019 12:00:00 GMT</pubDate><content:encoded>&lt;p&gt;A few days ago, when I browsing Instagram, I found something that quite catch my eyes.&lt;/p&gt;
&lt;p&gt;I’ve found a post from &lt;strong&gt;@soloinfo&lt;/strong&gt; account that posted about movie ticket giveaway of &lt;strong&gt;How to Train your Dragon 3&lt;/strong&gt; for 2 people. The giveaway was quite simple and same as the commonly giveaway, where user comment and tag other user, then the winner will be determined by randomly selecting those comments.&lt;/p&gt;
&lt;p&gt;Here’s the image of the post.&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;https://merricx.github.io/static/6a872a339ab15c0ed0f2c454ebf6782a/e51a6/instagram-post.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 75.67567567567568%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAABYlAAAWJQFJUiTwAAACoUlEQVR42m1TWU8TURSen+Nv8dEYoxJj4haiL/pC4psxPqJiAykBIkgC4oMPPigFi7aKMTEIZRPLtLN09uXOdu+dpdOZeqZFE4jf3EzuMud83znfHabb7a4sL1deLtSXVqaeTzRZtt/vh2EYDVDM4yT2g8hzi60wJJRmWd4fgCFZVn9aUm/f96/fezNy4/tuY7+xW6/Xa7Xa5uamZZoBISmlcRDQMAop9X0/y7KT4CjPv5Tn0N0x/+ro/LWb24eHe9uN9crax7X1b1+LYEKIj7GmqchSCKEYB55fIE1TJonj8enJ5fJU+fGj0bEHv34feRGRTM2grrHaoAdykvccx1VVxUUakEMujGEEwM+EuvPh2eL70lJ15m219FqsbEU7UrDFk58C+cHTHTEMKHIQx4ssL7GcyB43OXZfVfUkSRh5fLV5fkK49ap9scyPzB1fKh9dmGxenm5emT6+s7B37qFVO8RZrCmKZWqu51mW6bv2Sc2oesC9WBUX662pCj9TFRY+i/M1YWZDnP0kzG4IT975rOaHRJY6liGDC5SQICDQ+DzPGbCqo8htHnQJNrJ101ANXTN0C+aWaXsoiiPHcbh2SxQ7rVbx5lpHuq6laY+Jo0iWJNu24NFU1TKtwgkwMs+LkeXABk2y4LwYpo2QqcsY+70eBMcxz/MIIZAAYmCZnwZs2shpN/cMXYV4Q9chXjcM2C+CBUEAYdkA8PW/yRBwscAb21Sw72EwmoYYisbB4JJEUafT4TjOtm0dStGgrwpI7RfCT5hdx9E0XRBFCfphFp4jS066acEsiqLruqAcvjtDO2T2PB+yYozhVg1Ngn1YFsxACLQQPzw7UzOoAAJKyamUg5+DqVarIJtlWWDO/wcahpAU5KS9FJb9v4Bu/wE21iVU6uiJGAAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Instagram Post&quot;
        title=&quot;&quot;
        src=&quot;https://merricx.github.io/static/6a872a339ab15c0ed0f2c454ebf6782a/fcda8/instagram-post.png&quot;
        srcset=&quot;https://merricx.github.io/static/6a872a339ab15c0ed0f2c454ebf6782a/12f09/instagram-post.png 148w,https://merricx.github.io/static/6a872a339ab15c0ed0f2c454ebf6782a/e4a3f/instagram-post.png 295w,https://merricx.github.io/static/6a872a339ab15c0ed0f2c454ebf6782a/fcda8/instagram-post.png 590w,https://merricx.github.io/static/6a872a339ab15c0ed0f2c454ebf6782a/e51a6/instagram-post.png 783w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;h1 id=&quot;how-to-train-your-dragon-pwn-someone-tickets&quot;&gt;&lt;a href=&quot;#how-to-train-your-dragon-pwn-someone-tickets&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;How to &lt;del&gt;Train your Dragon&lt;/del&gt; Pwn Someone Tickets&lt;/h1&gt;
&lt;p&gt;Because the QR code on that image is quite suspicious, I quickly tried to import the image into &lt;a href=&quot;https://merricx.github.io/qrazybox/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;QRazyBox&lt;/a&gt; and edited some closed parts with manual reconstruction.&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;https://merricx.github.io/static/12535a2feed4a5d81a3aee40685ff4af/29114/reconstructing-qr.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 46.621621621621614%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAACXklEQVR42jWS2U9TURDG+1f57oNGjWvik09i4gOJsrggRTEsFQoW0rCICdiIwQoKChS0oCRFCQItIGtZqm2hBdrbe3tP21sWY36eYnz4Mjkn830z882Y7s1mKPIZmOez5E9nuD2TodD7D8VrcH8dHiweUbH6B/MGlEqUSM5dn8z1GuRPZbg1ncs3jrmm0W0Dd1AwGkjgCmfZUnRSQqBqSTYbnzJZa8c95uFNby8+m03+NaBrGjuqoG4xjc1vYFkxKPGlGAunML3wC8zyUT6XpmLB4FdcRxMpYgmNqXOX6D5xhnZLPR0WC66Tp/l66jxqQiWSPuK5ewpPnY0JayNNLe2MR9KYGqa2qJ8I0rygUjih4I+lELLDHUXD2dZFt7WFIdcwI0PDOB091FXbiUZ32TF+0/XZi3KzgOTVPF5a7XiiUrDTr/NuQ6MvuI95Lsvqno7QBbGkwPGqk35HB66REd5/6KfGbqeqpgYlkWBPCrYOjjFYVcHrgiKampv5HpEjO9d1nIEMPcEDrEtZNmI6em5kNUlH3g0GikvoG3DxyFyG4/IVOlueEZf+RpIG5Z4gTV+8OL7NY/Ws8SkkBfc0wXZCEEno7Ko6CU1CTxGXHi5fvMDHs9coq6zlSVUVbdfzaLU1Eo3FZa7g4eIhbesHvN0U3Jk/ZDQkMKlJuQQJVY74DzqKjIoUDs34CM4t8WNpFf9GgJXwNpuhLelxirAieOxVqZxNUr18QOmcQV9AdqhoOfJ/yO5ygsdRihv7aEYWkTZIpjLSirS8gPRx0dzZDP/UGQ/rTMpluENpZqKCvzCMVanSo5ScAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Reconstructing QR code&quot;
        title=&quot;&quot;
        src=&quot;https://merricx.github.io/static/12535a2feed4a5d81a3aee40685ff4af/fcda8/reconstructing-qr.png&quot;
        srcset=&quot;https://merricx.github.io/static/12535a2feed4a5d81a3aee40685ff4af/12f09/reconstructing-qr.png 148w,https://merricx.github.io/static/12535a2feed4a5d81a3aee40685ff4af/e4a3f/reconstructing-qr.png 295w,https://merricx.github.io/static/12535a2feed4a5d81a3aee40685ff4af/fcda8/reconstructing-qr.png 590w,https://merricx.github.io/static/12535a2feed4a5d81a3aee40685ff4af/efc66/reconstructing-qr.png 885w,https://merricx.github.io/static/12535a2feed4a5d81a3aee40685ff4af/c83ae/reconstructing-qr.png 1180w,https://merricx.github.io/static/12535a2feed4a5d81a3aee40685ff4af/29114/reconstructing-qr.png 1920w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;Then, looked at the specification of the QR code.&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;https://merricx.github.io/static/c0a2b5d5c41824ce7a20575a6fc4d1f9/dba9a/qr-specification.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 31.756756756756754%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABA0lEQVR42p2Py26DMBBF+f+f6b7ddNEuUqkJaUQSILxfCqlpeBYkzKmBH4h6paO59tyxxtqbGaJbLh+GhRGknBTP7xueXl7RbZ96AtFLimF6CO3kRWRRQJrEBJ6La1u4F5vz0cBRXuRXVk08Im17dtTwkYvjYBxPxHFMnCT0/UA/DAwKOU2MUiLltDD7cZRrXe5XVAwtbwZ+u5au62jaVgXHhf9oUi9q5zAjiUI83ye/5kRRhK98EATY9oUoVD3PW5i3z9IUfbfjc7vDNE32e52vw0F5a/1y8tPQVCX3e0mrNqzrmrIsEUIgioK6qpZzpercmzO3W06aZRSqL8T3Umdm/QFAEMccFN6fEQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;QR Specification&quot;
        title=&quot;&quot;
        src=&quot;https://merricx.github.io/static/c0a2b5d5c41824ce7a20575a6fc4d1f9/fcda8/qr-specification.png&quot;
        srcset=&quot;https://merricx.github.io/static/c0a2b5d5c41824ce7a20575a6fc4d1f9/12f09/qr-specification.png 148w,https://merricx.github.io/static/c0a2b5d5c41824ce7a20575a6fc4d1f9/e4a3f/qr-specification.png 295w,https://merricx.github.io/static/c0a2b5d5c41824ce7a20575a6fc4d1f9/fcda8/qr-specification.png 590w,https://merricx.github.io/static/c0a2b5d5c41824ce7a20575a6fc4d1f9/dba9a/qr-specification.png 652w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;Surprisingly, the QR code using &lt;strong&gt;Error Correction Level High&lt;/strong&gt;, where as long as there’s around &lt;strong&gt;40%&lt;/strong&gt; of undamaged part, we can still recover the QR code with &lt;em&gt;Reed-Solomon&lt;/em&gt;. &lt;/p&gt;
&lt;p&gt;As a measurement, damaged QR code like the following image can be still fully read when using Error Correction Level H.&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;https://merricx.github.io/static/5aae64e74fc0658c7add1509dec23bf6/5ff7e/broken-qr.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 375px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAC4jAAAuIwF4pT92AAACLklEQVR42qWUz2v5cRzHnRxclItyn/xIcnFBUsRBmuy8RbkgIgdlSVN+tNnv2dZsFKXERZSkRAnNHyAubttxJ26e397vetcu39n41Kv37dHz+Xo+Py/O1dUVdp3Ly0s62WwW9/f3ODw8BGcfIJvz83OUSiVIpdLdgUzd9fU1EokERqMRNBrNfgoJkFiNx+OYTCYwGo27Ab+rSyaTuLi4QKfTgUgk2s8yeV9eXhAMBuF0OuH3+/8OZOpubm5wdnaGh4cHvL+/YzqdIp/P7wZkNQkEAuBwOHC73Vgul2g0Grvv8Pb2FoPBAAqFAl6vF6enp+Dz+b8Hfi9xLpeD3W7HbDajVonCdrtN1XL+GgIp8evrK8rlMjKZDJrNJk13sVig2+3+zTJRR0Lw+XywWq0QCoWQyWQwm80Ih8NQq9Xbgcwqmbu7Owo7Pj6GRCKhFmOxGH2LxSI8Hs/vgOQl5X1+fkY0GoVYLKYgsjsej0eBRHm/3/8ZyJQxIDkAWq2WJjoej9Hr9WAymfD09ITPz0/I5fLtQLY7lixRc3R0hOFwiEKhAJ1Oh/V6ja+vL1gslv8DGYz9FalUCg6HA61WCzabjYah1+upQpVKhYODA+pgq0ICI/UgYaxWK3x8fNBfrVqt4vHxEZvNBpFIhF6bH88XuybpdBpvb28UGgqFMJ/PaZlrtRoEAgE9qicnJyCfUqn8WSErMUmQy+XS/RFrlUqFVsTlctE+kgNbr9dhMBjwD2W2CHOK1eDxAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Broken QR code&quot;
        title=&quot;&quot;
        src=&quot;https://merricx.github.io/static/5aae64e74fc0658c7add1509dec23bf6/5ff7e/broken-qr.png&quot;
        srcset=&quot;https://merricx.github.io/static/5aae64e74fc0658c7add1509dec23bf6/12f09/broken-qr.png 148w,https://merricx.github.io/static/5aae64e74fc0658c7add1509dec23bf6/e4a3f/broken-qr.png 295w,https://merricx.github.io/static/5aae64e74fc0658c7add1509dec23bf6/5ff7e/broken-qr.png 375w&quot;
        sizes=&quot;(max-width: 375px) 100vw, 375px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;If such QR code like the above image can still be recovered, especially with the QR code from the post that we talked about where the damaged part is only around 40%.&lt;/p&gt;
&lt;p&gt;Let’s quickly use &lt;em&gt;Reed-Solomon Decoder&lt;/em&gt; feature to recover the message.&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;https://merricx.github.io/static/699e1bdec82f2f34e03d0c6d2b6eb737/d1d24/reed-solomon-decoding.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 68.24324324324324%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAABlklEQVR42p1TTW+CQBTk3ze99ND/0XsvjT0CVaMxtVULyreLuGq1EQWcvreKWqP92mQyCzzmzZsFrdPpIkkSDIdDgoAQMYIggN3vYzBwdhjA8zy1d1xXXXO9EEIhor0cj1FrPUObzmY4XdPpFIauo9FswjQM6LqBl3Yb1WoVpmkqrFYrVVsUBfI8V/u3cAQtiiLVzfd95YwRhiH4PrOUEjNqyk1OuYSUEyw/Fnh1Amgs0Kfxer0ebNsmWIp5LOY0TVX3zWazx6XV8wW0OI5VhqPRSPFkMiHH0TYXcieIlWPicoL5/P1Lk5zG5tX1hweHW3c2HMdRDzmXLMsUM8qsGKXLkotjQc6PBS3L2oJGdkl0vliA67n4HC4K8pjcdb1e78G55XlxMavyVM8L0vfz1/WjQ9WVRzk6ye9QOsS5Q5Fy53BDYV/I6xSnh0K7g2AYJ4jpow8WGZZZ8WtRdsW1aZYjpHeTNf0pXgitJea4toGrLolmf44TCU17YwG3LlD3JbRK5RHVWm33jz79C7pholGv4+7+AZ+Royo2SBXo7QAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Reed-Solomon Decoding&quot;
        title=&quot;&quot;
        src=&quot;https://merricx.github.io/static/699e1bdec82f2f34e03d0c6d2b6eb737/fcda8/reed-solomon-decoding.png&quot;
        srcset=&quot;https://merricx.github.io/static/699e1bdec82f2f34e03d0c6d2b6eb737/12f09/reed-solomon-decoding.png 148w,https://merricx.github.io/static/699e1bdec82f2f34e03d0c6d2b6eb737/e4a3f/reed-solomon-decoding.png 295w,https://merricx.github.io/static/699e1bdec82f2f34e03d0c6d2b6eb737/fcda8/reed-solomon-decoding.png 590w,https://merricx.github.io/static/699e1bdec82f2f34e03d0c6d2b6eb737/efc66/reed-solomon-decoding.png 885w,https://merricx.github.io/static/699e1bdec82f2f34e03d0c6d2b6eb737/d1d24/reed-solomon-decoding.png 987w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;Voila! We finally got the value &lt;strong&gt;#6285647329322;83664&lt;/strong&gt;, where &lt;strong&gt;6285647329322&lt;/strong&gt; is the phone number of the person who ordered the ticket and &lt;strong&gt;83664&lt;/strong&gt; is the ticket booking code. Quickly insert that number into M-Tix machine and we got two free tickets :).&lt;/p&gt;
&lt;h1 id=&quot;moral-of-story&quot;&gt;&lt;a href=&quot;#moral-of-story&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Moral of Story&lt;/h1&gt;
&lt;p&gt;So, what message can we take from this story?&lt;/p&gt;
&lt;h3 id=&quot;as-a-user&quot;&gt;&lt;a href=&quot;#as-a-user&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;As a User&lt;/h3&gt;
&lt;p&gt;Please, stop sharing any QR code that contain sensitive data to the Internet like the social media, even if you already censored it.&lt;/p&gt;
&lt;p&gt;Nowadays, almost all tickets, receipts, or ther transaction proof use QR code as a medium to validating these transactions because apart from being simple, QR code also have advantages in fast data reading and quite flexible to store any kind of data.&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;https://merricx.github.io/static/0b380bf751162598cc8321555fa7fa7a/94a05/2qiddz.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 568px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 58.78378378378378%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAABAADBf/EABUBAQEAAAAAAAAAAAAAAAAAAAMC/9oADAMBAAIQAxAAAAEaz7GiLlx1/8QAGxAAAQUBAQAAAAAAAAAAAAAAAgABAxIhBBP/2gAIAQEAAQUCjkJEdTx1zs1PMEWF/8QAFhEBAQEAAAAAAAAAAAAAAAAAABIB/9oACAEDAQE/AaxT/8QAFhEBAQEAAAAAAAAAAAAAAAAAABIB/9oACAECAQE/AZ1D/8QAGxAAAgMAAwAAAAAAAAAAAAAAABEBITEiMkH/2gAIAQEABj8CqajTtxQ2jPTCUf/EABwQAQEBAAIDAQAAAAAAAAAAAAERADFBIVFhcf/aAAgBAQABPyFPhLcDjQnmRnvK6C6jQ/WtLf6uECQvvf/aAAwDAQACAAMAAAAQFD//xAAXEQEBAQEAAAAAAAAAAAAAAAABACFh/9oACAEDAQE/EADTY5v/xAAYEQEAAwEAAAAAAAAAAAAAAAABABEhUf/aAAgBAgEBPxBRxyW7P//EABwQAQEBAQACAwAAAAAAAAAAAAERIQAxQVFhkf/aAAgBAQABPxBAgBRYfOpxGQKFMfTZu83gA8L9Pz2v2trMDiPMQBUJ9vQsSgLv/9k=&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;One Does not Simply&quot;
        title=&quot;&quot;
        src=&quot;https://merricx.github.io/static/0b380bf751162598cc8321555fa7fa7a/94a05/2qiddz.jpg&quot;
        srcset=&quot;https://merricx.github.io/static/0b380bf751162598cc8321555fa7fa7a/a80bd/2qiddz.jpg 148w,https://merricx.github.io/static/0b380bf751162598cc8321555fa7fa7a/1c91a/2qiddz.jpg 295w,https://merricx.github.io/static/0b380bf751162598cc8321555fa7fa7a/94a05/2qiddz.jpg 568w&quot;
        sizes=&quot;(max-width: 568px) 100vw, 568px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;h3 id=&quot;as-a-developer&quot;&gt;&lt;a href=&quot;#as-a-developer&quot; aria-hidden class=&quot;anchor&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;As a Developer&lt;/h3&gt;
&lt;p&gt;As a developer who developing system that involve QR code, we should carefully select &lt;em&gt;Error Correction Level&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;QR code with Error Correction Level H on the digital medium like the online ticket is not suitable in my opinion, because Level H intended to QR code that will be distributed in the environment that has the potential to damage the QR code itself (for example QR code that pyshically printed in the public place).&lt;/p&gt;
&lt;p&gt;We should better use Level L or Level M to digital QR code and Level Q to physically printed QR code instead.&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;Anyway, I’ve contacted admin from &lt;strong&gt;@soloinfo&lt;/strong&gt; about this and because I didn’t intend to claim the ticket, the giveaway is still running normally.&lt;/p&gt;
                &lt;div style=&quot;margin-top=55px; font-style: italic;&quot;&gt;You can read it online by &lt;a href=&quot;https://merricx.github.io/how-i-get-free-movie-tickets/&quot;&gt;clicking here&lt;/a&gt;&lt;/div&gt;
              </content:encoded></item></channel></rss>