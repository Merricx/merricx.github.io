{"componentChunkName":"component---src-templates-blog-post-js","path":"/id/dont-roll-your-own-crypto-1/","result":{"data":{"site":{"siteMetadata":{"title":"Merricx","author":"merricx"}},"markdownRemark":{"id":"8a5d0b81-d791-5e41-9c64-202b5e8095fa","html":"<h1 id=\"introduction\"><a href=\"#introduction\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Introduction</h1>\n<p>Ini adalah sebuah <em>series</em> dimana saya akan mencoba melakukan kriptanalisis terhadap skema kriptosistem yang diusulkan pada berbagai jurnal, <em>paper</em>, maupun artikel akademis dari beberapa Universitas di Indonesia.</p>\n<p>Tulisan ini hanya berusaha menekankan pada kalimat <em>“Don’t roll your own Crypto”</em>, dimana lebih baik kita menggunakan algoritma kriptografi yang sudah distandarisasi dibandingkan merancang algoritma sendiri yang belum terbukti keamanannya.</p>\n<p>Ini bukan berarti saya meng-<em>encourage</em> akademisi untuk tidak mengusulkan algoritma sendiri ya, tapi ini lebih ditargetkan kepada <em>developer</em> atau pelaksana dalam IT <em>security</em> untuk tidak sembarangan memilih atau merancang sebuah kriptosistem. </p>\n<p>Selain itu, tulisan ini juga tidak ada niatan sama sekali untuk merendahkan penelitian-penelitian yang berkaitan. Bagaimanapun juga, memang seperti inilah proses pengusulan sebuah skema kriptosistem dilakukan, dimana ada satu pihak mengusulkan ide, pihak-pihak lainnya akan mencoba mencari kelemahan dari ide tersebut, hingga akhirnya dari kelemahan-kelemahan tersebut dapat dikembangkan menjadi skema yang lebih baik lagi dan begitu seterusnya.</p>\n<h1 id=\"chaos-based-image-encryption\"><a href=\"#chaos-based-image-encryption\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Chaos-based Image Encryption</h1>\n<p>Skema kriptosistem yang akan dibahas di seri pertama kali ini adalah penelitian dari artikel yang berjudul <strong>“ANALISIS KEAMANAN ALGORITMA ENKRIPSI CITRA DIGITAL MENGGUNAKAN KOMBINASI DUA CHAOS MAP DAN PENERAPAN TEKNIK SELEKTIF”</strong> oleh Rinaldi Munir, yang dipublikasikan oleh Jurnal Ilmiah Teknologi Informasi (JUTI) pada tahun 2012 <sup><a href=\"#references\">[1]</a></sup>.</p>\n<p>Artikel tersebut membahas mengenai algoritma enkripsi gambar dengan memanfaatkan dua fungsi <em>Chaos</em>, yaitu <em>Arnold Cat Map</em> sebagai fungsi permutasi dan <em>Logistic Map</em> sebagai pembangkit <em>keystream</em>.</p>\n<p>Selain itu, dijelaskan juga penggunaan <strong>“enkripsi selektif”</strong> dimana enkripsi hanya dilakukan pada 4-bit awal (<em>Most Significant Byte</em>) saja, sedangkan 4-bit akhir (<em>Least Significant Byte</em>) pada gambar (setelah dipermutasi) tidak akan berubah.</p>\n<h2 id=\"arnolds-cat-map\"><a href=\"#arnolds-cat-map\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Arnold’s Cat Map</h2>\n<p><strong>Arnold’s Cat Map</strong> (ACM) adalah fungsi <em>Chaos Map</em> untuk mengacak posisi pixel-pixel (dalam koordinat <code class=\"language-text\">x</code> dan <code class=\"language-text\">y</code>) pada sebuah gambar.</p>\n<p>Persamaan ACM yang dipakai dalam artikel tersebut adalah sebagai berikut.</p>\n$$\n    \\begin{bmatrix}\n    x' \\\\\n    y' \\\\\n    \\end{bmatrix}\n    =\n    \\begin{bmatrix}\n    1 & p \\\\\n    q & pq + 1 \\\\\n    \\end{bmatrix}\n    \\begin{bmatrix}\n    x \\\\\n    y \\\\\n    \\end{bmatrix}\n    \\mod N\n$$\n<p>Dimana <code class=\"language-text\">(x,y)</code> adalah posisi pixel awal dan <code class=\"language-text\">(x&#39;,y&#39;)</code> adalah posisi pixel setelah dipermutasi. Sementara itu, nilai <code class=\"language-text\">N</code> adalah ukuran panjang dari gambar. Fungsi ini akan dijalankan sebanyak <code class=\"language-text\">m</code> kali.</p>\n<p>Jadi, <em>secret variable</em> yang ada pada fungsi ACM terdiri dari <code class=\"language-text\">p</code>, <code class=\"language-text\">q</code>, dan <code class=\"language-text\">m</code>.</p>\n<p>Berikut adalah visualisasi gambar setelah dilakukan fungsi ACM beberapa kali, terlihat semakin tinggi nilai <code class=\"language-text\">m</code>, semakin terlihat acak hasil posisi pixel-nya.</p>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/53cb714c13290142b14c7a0db1ebbb9d/9cab2/acm.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 76.35135135135135%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAAsTAAALEwEAmpwYAAACnUlEQVQoz2WSa1MSYRTH/QjN9B36Hr6uVzXTOPYCFbnswi67ywLLbbkooFgpjVqSCZY6Y1njtcuMTBOIQaKmASY1UynS1JBBGEWy0IFFEzuz++wzzzm/c/Y5/9PAccVyuRwPz4/YBV5H6/SwbdztnvH2RhbvlKs21NtFtDUZCTFLSAyEWIMIYhvrcM5xXAO8sAst+awqsWfAOTHiNlA0Q9KRZT8Pe2+69Liok8EdetLG4CyFxN+8roN9vgCGkBSKMkiT+NL5c2fPKJF2HvYM9jIyYacG62QUNq1CrxBtRTfr4ID/lQylVaRJg0l7WKzl4gXPoOtfZUxo0xJ2eHSESYlux47gYrECzy/4GhubBc1SLUk5zUq1TPL8ySMeHrhqx1suG3ChmUK08lZKdCW2sVaDS6US7HZ2k7Nzi6Oeibnp6YWZqafzc19Sn3h4Ox5dDQeDL3y+Z4/XV5bXwsHs9304B7Ch+qkE/crn3iXeJnd3YtHoXnKXv06lQvGwxHHpdDr1OXVYtVKp5qrdeSMS7jLQ/d0Wl93U77Q4WfXs/XE+YtLrtuuoPrvRZTdes2q7japEPFrXsJVlPyNrZSmpkZSAGGpEAMxRt69r5W1mGoVzWKHbp3VeDS0ZCQmI2VGVxKAQTY3VhmT0lsugEHdoFFY1Bt6Kzpv1OkdCSwCAz6qSd2hwHdb+4O7wkVR9erzdqsYtKjnwLCmNb9ZXjrwMaDGhmZZBYotKxsjbJkdvn4SBNCtRWOEHT8NroSCkdOjIHlbt0FMQ8XBshIfvDd2ARnSzdJdBCaNiotGt4/HkIwqF39nM/rf015VwaOfjh1w28/Mgx7sOcj9A2PeJ7WDAn9pLgutPoVCTqnzCIFkmkwUly/9ZPp/P5XLH4vP2FzUBl+7GsUYWAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"acm\"\n        title=\"\"\n        src=\"/static/53cb714c13290142b14c7a0db1ebbb9d/fcda8/acm.png\"\n        srcset=\"/static/53cb714c13290142b14c7a0db1ebbb9d/12f09/acm.png 148w,\n/static/53cb714c13290142b14c7a0db1ebbb9d/e4a3f/acm.png 295w,\n/static/53cb714c13290142b14c7a0db1ebbb9d/fcda8/acm.png 590w,\n/static/53cb714c13290142b14c7a0db1ebbb9d/9cab2/acm.png 864w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>Untuk membalik proses ACM, kita cukup mengkalikan <code class=\"language-text\">(x&#39;,y&#39;)</code> dengan invers matriks $\\begin{bmatrix} 1 & p\\\\ q & pq+1\\\\ \\end{bmatrix}$.</p>\n<h2 id=\"logistic-map\"><a href=\"#logistic-map\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Logistic Map</h2>\n<p><strong>Logistic Map</strong> adalah fungsi <em>Chaos Map</em> yang dihasilkan dari persamaan non-linear sederhana berikut.</p>\n$$\nx_{i+1} = r x_i \\left(1 - x_i\\right)\n$$\n<p>Dimana didefinisikan <code class=\"language-text\">r</code> sebagai konstanta bilangan real dalam interval 0 hingga 4 dan <code class=\"language-text\">x0</code> sebagai nilai awal acak dalam interval 0 hingga 1. Kedua variabel ini dirahasiakan nilainya.</p>\n<p>Untuk membangkitkan <em>keystream</em> menggunakan <em>Logistic Map</em>, cukup kalkulasikan persamaan diatas yang menghasilkan <code class=\"language-text\">x1, x2, x3, ...</code> hingga panjang <em>keystream</em> yang dibutuhkan terpenuhi. Nilai pada <code class=\"language-text\">x1, x2, x3, ...</code> masing-masing merepresentasikan 4-bit kunci yang diambil dari nilai dibelakang koma.</p>\n<p>Misalnya dihasilkan deretan dari Logistic Map yaitu <code class=\"language-text\">0.5, 0.875, 0.3828125, 0.8269348, ...</code>, maka diambil beberapa angka dibelakang koma menjadi <code class=\"language-text\">5, 875, 3828, 8269, ...</code>, ubah masing-masing ke <em>binary</em> dan ambil 4-bit terakhir (LSB) menghasilkan <em>keystream</em> <code class=\"language-text\">0101, 1011, 0100, 1101, ...</code>.</p>\n<h2 id=\"encryption\"><a href=\"#encryption\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Encryption</h2>\n<p>Tahapan enkripsinya secara singkat adalah sebagai berikut.</p>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/0542cfc5a2b3327fcba64f6f6a9bd4c2/c1b63/encrypt.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 58.10810810810811%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsTAAALEwEAmpwYAAABhklEQVQoz5WQ60vCUBjG/Qv7BwwiiCjWhYjaUhdkISSBqIuiErGrWwUGfqkECQpJIQLJb6ngdLqt4aZzXrfemi3z8qHnwznbed/feZ/nmFRV1TTtLR6+DTrvQuTrU1jttLQe6Q3xxwfq+Oj6zH8fDhklk167udj32uccFtTn3gZYqdc5jq18q9lsdjqdc9/e8rQZRSZdW7Z+OOAPIlOziHkMmRiXZVmSpGKxyLKsIAgVSSoUGDJwaJ2fwpdmdp32AThwtYCsuhzrl6c+7a+61siTTWxxZ2PtwO38hfVNrtVYlmNLJZhpAL3wB89nMxlRLKfT7/2woUajkc/nc7kcGBaht1yG2BAkR9O8IMBFiqIMgfUJ7XYbeIZhAIBveC1YoSCLosTz8MtxnNFsGpoQzAPTe5JNpV4ikVgsFo1GR9qGu4UfVatVcKGfkxS1gmJWi4UgiJEwDISxEAyiwtpqtfTJFEVhKGbDbR6PZyQ8qC5MfsE4jhOE998wnaef4/FEIpFMJo3SJ8nEheLM5TteAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"encrypt\"\n        title=\"\"\n        src=\"/static/0542cfc5a2b3327fcba64f6f6a9bd4c2/fcda8/encrypt.png\"\n        srcset=\"/static/0542cfc5a2b3327fcba64f6f6a9bd4c2/12f09/encrypt.png 148w,\n/static/0542cfc5a2b3327fcba64f6f6a9bd4c2/e4a3f/encrypt.png 295w,\n/static/0542cfc5a2b3327fcba64f6f6a9bd4c2/fcda8/encrypt.png 590w,\n/static/0542cfc5a2b3327fcba64f6f6a9bd4c2/efc66/encrypt.png 885w,\n/static/0542cfc5a2b3327fcba64f6f6a9bd4c2/c83ae/encrypt.png 1180w,\n/static/0542cfc5a2b3327fcba64f6f6a9bd4c2/c1b63/encrypt.png 1200w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<ol>\n<li>Inisialisasi <em>Plain image</em> <code class=\"language-text\">P</code>, variabel <code class=\"language-text\">p</code>, <code class=\"language-text\">q</code>, <code class=\"language-text\">m</code>, <code class=\"language-text\">r</code>, dan <code class=\"language-text\">x0</code> sebagai kunci rahasia.</li>\n<li>Permutasi gambar <code class=\"language-text\">P</code> dengan fungsi <strong><em>Arnold Cat Map</em></strong> bersama parameter <code class=\"language-text\">p</code>, <code class=\"language-text\">q</code>, dan <code class=\"language-text\">m</code>, menghasilkan gambar <code class=\"language-text\">Px</code>.</li>\n<li>Gunakan <strong><em>Logistic Map</em></strong> untuk membangkitkan <em>keystream</em> <code class=\"language-text\">K</code> menggunakan konstanta <code class=\"language-text\">r</code> dan nilai awal <code class=\"language-text\">x0</code>.</li>\n<li>Enkripsi 4-bit MSB tiap pixel pada <code class=\"language-text\">Px</code> dengan <em>keystream</em> <code class=\"language-text\">K</code> menggunakan operasi XOR, menghasilkan 4-bit <code class=\"language-text\">Cx</code> setiap pixelnya.</li>\n<li><em>Cipher image</em> <code class=\"language-text\">C</code> yang didapatkan adalah gabungan hasil enkripsi 4-bit <code class=\"language-text\">Cx</code> dengan 4-bit LSB pada gambar <code class=\"language-text\">Px</code>.</li>\n</ol>\n<p>Implementasi enkripsi ini menggunakan Python dapat dilihat pada <a href=\"https://github.com/Merricx/chaos-image-encryption/blob/main/encryption.py\" target=\"_blank\">source disini</a></p>\n<h1 id=\"cryptanalysis\"><a href=\"#cryptanalysis\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Cryptanalysis</h1>\n<p>Langsung saja kita coba lakukan kriptanalisis pada skema enkripsi gambar ini :D.</p>\n<p>Dalam melakukan kriptanalisis, akan diasumsikan beberapa skenario implementasi dikarenakan dalam artikel tersebut tidak didefinisikan spesifikasi bagaimana implementasi seharusnya dilakukan. </p>\n<p>Model kriptanalisis yang akan kita gunakan adalah <em>Chosen-Plain image Attack</em>, dimana kita dapat mengenkripsi gambar apapun yang kita mau sebanyak-banyaknya dan mendapatkan hasil <em>Cipher image</em> dari gambar tersebut.</p>\n<h2 id=\"static-secret-key\"><a href=\"#static-secret-key\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Static Secret Key</h2>\n<p>Diasumsikan skenario implementasi dimana <em>secret key</em> yang terdiri variabel <code class=\"language-text\">p</code>, <code class=\"language-text\">q</code>, <code class=\"language-text\">m</code>, <code class=\"language-text\">r</code>, dan <code class=\"language-text\">x0</code> bersifat statis dimana nilainya tidak berubah dalam eksekusi enkripsi yang berbeda. </p>\n<h3 id=\"recovery-of-keystream\"><a href=\"#recovery-of-keystream\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recovery of Keystream</h3>\n<p>Dikarenakan nilai <code class=\"language-text\">r</code> dan <code class=\"language-text\">x0</code> selalu sama, hasil dari <em>Logistic Map</em> juga akan menghasilkan <em>keystream</em> yang sama juga.</p>\n<p>Seperti pada <em>stream cipher</em> dimana <em>keystream</em> tidak boleh digunakan berulang kali, disini <em>keystream</em> (<code class=\"language-text\">K</code>) dapat di-<em>extract</em> dengan mudah selama kita mengetahui <em>plain image</em> yang telah dipermutasi dengan ACM (<code class=\"language-text\">Px</code>) dan <em>cipher image</em>-nya (<code class=\"language-text\">C</code>).</p>\n$$\nC = Px \\oplus K \\\\\nK = C \\oplus Px\n$$\n<p>Namun disini kita tidak mengetahui nilai dari <code class=\"language-text\">Px</code> (hanya 4-bit LSB-nya saja yang diketahui) karena kita tidak diberikan parameter <code class=\"language-text\">p</code>, <code class=\"language-text\">q</code>, dan <code class=\"language-text\">m</code> pada ACM.</p>\n<p><em>Well</em>, karena ini adalah <em>Chosen-Plain image Attack</em> dan kita dapat mengenkripsi gambar apapun, kita tinggal gunakan <em>Plain image</em> yang mempunyai nilai sama disemua pixel-nya seperti gambar full hitam atau gambar full putih. </p>\n<p>Karena semua nilai pixel pada gambar tersebut sama, maka permutasi ACM akan menghasilkan gambar yang sama juga, sehingga otomatis kita mengetahui nilai <code class=\"language-text\">Px</code>, lalu tinggal cari nilai <em>keystream</em> dengan operasi XOR ¯\\_(ツ)_/¯</p>\n<p>Setelah <em>keystream</em> didapatkan, mari kita cari nilai <code class=\"language-text\">p</code>, <code class=\"language-text\">q</code>, dan <code class=\"language-text\">m</code>.</p>\n<h3 id=\"recovery-of-m\"><a href=\"#recovery-of-m\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recovery of <code class=\"language-text\">m</code></h3>\n<p>Perlu diketahui jika proses fungsi ACM sebenarnya cukup <em>costly</em> dalam sisi hardware, dimana dalam satu iterasi ACM saja (<code class=\"language-text\">m=1</code>) membutuhkan waktu yang tidak sebentar, sehingga perbedaan nilai <code class=\"language-text\">m</code> dengan <code class=\"language-text\">m+1</code> cukup <em>noticable</em>. </p>\n<p>Hal ini cukup berbahaya karena kita dapat mengetahui nilai <code class=\"language-text\">m</code> dari <strong><em>Timing Attack</em></strong>. Semakin tinggi nilai <code class=\"language-text\">m</code> yang digunakan, maka waktu yang dibutuhkan dalam operasi ACM akan memakan waktu lebih lama.</p>\n<p>Terlebih, <em>Timing Attack</em> pada nilai <code class=\"language-text\">m</code> dapat dibuat sangat akurat dengan memakai ukuran gambar yang sangat besar, sehingga proses ACM pada satu iterasi <code class=\"language-text\">m</code> sangat besar.</p>\n<p>Berikut adalah tabel hasil tes waktu yang dibutuhkan pada proses ACM menggunakan <code class=\"language-text\">m = 1</code> hingga <code class=\"language-text\">m = 5</code> pada gambar berukuran 1024x1024 menggunakan Laptop saya.</p>\n<table>\n<thead>\n<tr>\n<th>m</th>\n<th>Waktu (detik)</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1</td>\n<td>7.1236</td>\n</tr>\n<tr>\n<td>2</td>\n<td>13.8878</td>\n</tr>\n<tr>\n<td>3</td>\n<td>21.7516</td>\n</tr>\n<tr>\n<td>4</td>\n<td>27.8001</td>\n</tr>\n<tr>\n<td>5</td>\n<td>35.2292</td>\n</tr>\n</tbody>\n</table>\n<p>Dapat dilihat pada tabel tersebut bahwa waktu yang dibutuhkan relatif konsisten pada kelipatan 7 detik. Dari hal ini kita dapat menebak nilai <code class=\"language-text\">m</code> hanya dari waktu yang dibutuhkan dalam mengenkripsi gambar.</p>\n<p>Sebenarnya dari awal, merahasiakan nilai <code class=\"language-text\">m</code> disini tidak relevan, karena bagaimanapun rentang nilai <code class=\"language-text\">m</code> tidak mungkin terlalu tinggi karena akan membawa <em>performance issue</em> pada enkripsinya jika terlalu tinggi. Jadi, kita pun dapat melakukan <em>simple brute-force</em> pada nilai <code class=\"language-text\">m</code>.</p>\n<h3 id=\"recovery-of-p-and-q\"><a href=\"#recovery-of-p-and-q\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recovery of <code class=\"language-text\">p</code> and <code class=\"language-text\">q</code></h3>\n<p>Dengan didapatkannya nilai <code class=\"language-text\">m</code>, maka mencari <code class=\"language-text\">p</code> dan <code class=\"language-text\">q</code> cukup <em>trivial</em>.</p>\n<p>Idenya adalah kita akan membuat sebuah <em>Plain image</em> yang semua pixelnya memiliki nilai warna hitam (0), kecuali pada satu koordinat saja memiliki warna putih (255) atau nilai selain 0. </p>\n<p>Misalnya, kita tentukan pada koordinat <code class=\"language-text\">(1, 0)</code>, maka <em>Plain image</em> yang berukuran 4x4 dapat direpresentasikan sebagai matrik berikut.</p>\n$$\n\\begin{pmatrix}\n0 & 255 & 0 & 0 \\\\\n0 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 0 \\\\\n\\end{pmatrix}\n$$\n<p>Masukkan <em>plain image</em> tersebut ke <em>encryption oracle</em>, didapatkan <em>cipher image</em>, dekripsi menggunakan <em>keystream</em> yang sudah kita dapatkan sebelumnya, sehingga kita memiliki <em>plain-image</em> yang telah dipermutasi.</p>\n<p>Misalnya <em>plain image</em> yang dipermutasi tersebut adalah berikut.</p>\n$$\n\\begin{pmatrix}\n0 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 0 \\\\\n0 & 0 & 255 & 0 \\\\\n\\end{pmatrix}\n$$\n<p>Maka dapat kita simpulkan koordinat kita sebelumnya dari <code class=\"language-text\">(1, 0)</code> berpindah ke koordinat <code class=\"language-text\">(2, 3)</code>.</p>\n<p>Mari kita asumsikan nilai <code class=\"language-text\">m = 3</code>, maka persamaan ACM seperti yang dijelaskan sebelumnya menjadi berikut.</p>\n$$\n    \\begin{bmatrix}\n    2 \\\\\n    3 \\\\\n    \\end{bmatrix}\n    =\n    \\begin{bmatrix}\n    1 & p \\\\\n    q & pq + 1 \\\\\n    \\end{bmatrix}^3\n    \\begin{bmatrix}\n    1 \\\\\n    0 \\\\\n    \\end{bmatrix}\n    \\mod N\n$$\n<p>Kemudian dapat kita tuliskan menjadi:</p>\n$$\n\\begin{equation}\n\\begin{aligned}\n2 &\\equiv \\left( \\left( p \\cdot q + 1 \\right) \\cdot p + p \\right) \\cdot q + p \\cdot q + 1 \\pmod{N} \\\\ \n3 &\\equiv \\left( \\left( p \\cdot q + 1 \\right)^2 + p \\cdot q \\right) \\cdot q + \\left( p \\cdot q + 1 \\right) \\cdot q + q \\pmod{N}\n\\end{aligned}\n\\end{equation}\n$$\n<p>Dimana nilai <code class=\"language-text\">p</code> dan <code class=\"language-text\">q</code> dapat dicari dengan menyelesaikan sistem persamaan linear dua variabel (dengan modulus <code class=\"language-text\">N</code>).</p>\n<p>Akhirnya, dengan diketahui <em>keystream</em> <code class=\"language-text\">K</code>, nilai <code class=\"language-text\">p</code>, <code class=\"language-text\">q</code>, dan <code class=\"language-text\">m</code> pada ACM, kita dapat mendekripsi gambar apapun yang terenkripsi dibawah <em>secret key</em> ini :).</p>\n<h3 id=\"proof-of-concept\"><a href=\"#proof-of-concept\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Proof of Concept</h3>\n<p>Mari kita buktikan dengan mengimplementasikannya kedalam Python.</p>\n<p>Pertama, kita buat fungsi <code class=\"language-text\">encryption_oracle()</code> yang seolah-olah akan berperan sebagai “server” dimana kita dapat mengenkripsi gambar apapun ke “server” tersebut dan menerima <em>cipher image</em>-nya.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> random<span class=\"token punctuation\">,</span> os\n<span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np\n<span class=\"token keyword\">import</span> encryption\n<span class=\"token keyword\">from</span> PIL <span class=\"token keyword\">import</span> Image\n<span class=\"token keyword\">from</span> Crypto<span class=\"token punctuation\">.</span>Util<span class=\"token punctuation\">.</span>strxor <span class=\"token keyword\">import</span> strxor\n\n<span class=\"token comment\"># Secret</span>\np <span class=\"token operator\">=</span> random<span class=\"token punctuation\">.</span>randint<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">250</span><span class=\"token punctuation\">)</span>\nq <span class=\"token operator\">=</span> random<span class=\"token punctuation\">.</span>randint<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">250</span><span class=\"token punctuation\">)</span>\nm <span class=\"token operator\">=</span> <span class=\"token number\">3</span>\ninit <span class=\"token operator\">=</span> random<span class=\"token punctuation\">.</span>random<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nr <span class=\"token operator\">=</span> <span class=\"token number\">3</span> <span class=\"token operator\">+</span> random<span class=\"token punctuation\">.</span>random<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">encryption_oracle</span><span class=\"token punctuation\">(</span>plain_image<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n\n    <span class=\"token keyword\">return</span> encryption<span class=\"token punctuation\">.</span>encrypt<span class=\"token punctuation\">(</span>plain_image<span class=\"token punctuation\">,</span> p<span class=\"token punctuation\">,</span> q<span class=\"token punctuation\">,</span> m<span class=\"token punctuation\">,</span> init<span class=\"token punctuation\">,</span> r<span class=\"token punctuation\">)</span></code></pre></div>\n<p>Lalu, buat fungsi <code class=\"language-text\">recover_keystream</code> untuk mendapatkan <em>keystream</em> dari <em>chosen-plain image attack</em>.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">recover_keystream</span><span class=\"token punctuation\">(</span>size<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n\n    <span class=\"token comment\"># Generate full-black image</span>\n    plain_image <span class=\"token operator\">=</span> Image<span class=\"token punctuation\">.</span>new<span class=\"token punctuation\">(</span><span class=\"token string\">\"RGB\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>size<span class=\"token punctuation\">,</span> size<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># Send image to encryption oracle</span>\n    cipher_image <span class=\"token operator\">=</span> encryption_oracle<span class=\"token punctuation\">(</span>plain_image<span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># Convert plain_image and cipher_image to bytes</span>\n    plain_image_bytes <span class=\"token operator\">=</span> <span class=\"token builtin\">bytes</span><span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span>plain_image<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>flatten<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>tolist<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    cipher_image_bytes <span class=\"token operator\">=</span> <span class=\"token builtin\">bytes</span><span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span>cipher_image<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>flatten<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>tolist<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># Recover 8-bit keystream</span>\n    k <span class=\"token operator\">=</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span>strxor<span class=\"token punctuation\">(</span>plain_image_bytes<span class=\"token punctuation\">,</span> cipher_image_bytes<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># Get 4-bit MSB keystream</span>\n    keystream <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>size<span class=\"token operator\">**</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        bit_len <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>k<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>bit_length<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">if</span> bit_len <span class=\"token operator\">></span> <span class=\"token number\">4</span><span class=\"token punctuation\">:</span>\n            msb <span class=\"token operator\">=</span> k<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">>></span> <span class=\"token number\">4</span> <span class=\"token operator\">&amp;</span> <span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token operator\">**</span><span class=\"token punctuation\">(</span>bit_len<span class=\"token operator\">-</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n            msb <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n        \n        keystream<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>msb<span class=\"token punctuation\">)</span>\n    \n\n    <span class=\"token keyword\">return</span> keystream</code></pre></div>\n<p>Lalu, buat fungsi untuk mendapatkan <code class=\"language-text\">m</code> melalui <em>Timing Attack</em>.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">recover_m</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># avg. second of one encryption execution time (depends on the machine)</span>\n    one_exec_time <span class=\"token operator\">=</span> <span class=\"token number\">10</span> \n\n    start_time <span class=\"token operator\">=</span> time<span class=\"token punctuation\">.</span>time<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    payload <span class=\"token operator\">=</span> Image<span class=\"token punctuation\">.</span>new<span class=\"token punctuation\">(</span><span class=\"token string\">\"RGB\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1024</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1024</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n    encryption_oracle<span class=\"token punctuation\">(</span>payload<span class=\"token punctuation\">)</span>\n\n    end_time <span class=\"token operator\">=</span> time<span class=\"token punctuation\">.</span>time<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    elapsed_time <span class=\"token operator\">=</span> end_time <span class=\"token operator\">-</span> start_time\n    m <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>elapsed_time <span class=\"token operator\">//</span> one_exec_time<span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># Result could be faster or slower</span>\n    possible_m <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>m<span class=\"token punctuation\">,</span> m<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> m<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>\n\n    <span class=\"token keyword\">return</span> possible_m</code></pre></div>\n<p>Terakhir, untuk mendapatkan nilai <code class=\"language-text\">p</code> dan <code class=\"language-text\">q</code>, kita akan menggunakan <strong><em>Sagemath</em></strong> dan menggunakan fungsi <code class=\"language-text\">solve_mod()</code> untuk menyelesaikan sistem persamaan yang dijelaskan sebelumnya.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\">#!/usr/bin/env sage</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">recover_pq</span><span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">,</span> x0<span class=\"token punctuation\">,</span> y0<span class=\"token punctuation\">,</span> x1<span class=\"token punctuation\">,</span> y1<span class=\"token punctuation\">,</span> N<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n\n    var<span class=\"token punctuation\">(</span><span class=\"token string\">'p,q'</span><span class=\"token punctuation\">)</span>\n    xy <span class=\"token operator\">=</span> matrix<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span>x0<span class=\"token punctuation\">,</span>y0<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n    A <span class=\"token operator\">=</span> matrix<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span>p<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span>q<span class=\"token punctuation\">,</span> p<span class=\"token operator\">*</span>q <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\n    pos_result <span class=\"token operator\">=</span> solve_mod<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n        <span class=\"token punctuation\">(</span>A<span class=\"token operator\">^</span>m <span class=\"token operator\">*</span> xy<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> x1<span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">(</span>A<span class=\"token operator\">^</span>m <span class=\"token operator\">*</span> xy<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> y1\n        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> N<span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">return</span> pos_result\n\n<span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">\"__main__\"</span><span class=\"token punctuation\">:</span>\n\n    m <span class=\"token operator\">=</span> <span class=\"token number\">7</span> <span class=\"token comment\"># ACM iteration</span>\n    x0 <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n    y0 <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n    x1 <span class=\"token operator\">=</span> <span class=\"token number\">489</span> <span class=\"token comment\"># x-coordinate after permutation</span>\n    y2 <span class=\"token operator\">=</span> <span class=\"token number\">396</span> <span class=\"token comment\"># y-coordinate after permutation</span>\n    N <span class=\"token operator\">=</span> <span class=\"token number\">512</span> <span class=\"token comment\"># image size</span>\n\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Possible p,q: \"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>recover_pq<span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">,</span> x0<span class=\"token punctuation\">,</span> y0<span class=\"token punctuation\">,</span> x1<span class=\"token punctuation\">,</span> y2<span class=\"token punctuation\">,</span> N<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Implementasi lengkapnya dapat diakses di <a href=\"https://github.com/Merricx/chaos-image-encryption\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">link ini</a>.</p>\n<h2 id=\"static-secret-key-with-dynamic-x0\"><a href=\"#static-secret-key-with-dynamic-x0\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Static Secret Key with Dynamic <code class=\"language-text\">x0</code></h2>\n<p>Skenario implementasi berikutnya adalah jika diasumsikan variabel <code class=\"language-text\">p</code>,<code class=\"language-text\">q</code>,<code class=\"language-text\">m</code>,<code class=\"language-text\">r</code> bersifat statis namun variabel <code class=\"language-text\">x0</code> dinamis, dimana nilai ini akan berubah-ubah dalam eksekusi enkripsi yang berbeda. </p>\n<p>Skenario ini adalah skenario yang paling ideal yang dapat diimplementasikan pada skema kriptosistem ini, karena <em>repeated keystream</em> sudah tidak terjadi.</p>\n<p>Namun, yang menjadi masalah adalah bagaimana nilai <code class=\"language-text\">x0</code> ini dapat terbentuk dan terasosiasi disetiap gambar yang berbeda. Salah satu pendekatan yang mungkin dilakukan adalah dengan memperlakukan <code class=\"language-text\">x0</code> ini seperti <em>Initialization Vector</em> (IV) seperti pada <em>block cipher</em>. Tapi, nilai ini harus tetap dienkripsi lagi dengan metode tertentu dan dicantumkan di setiap gambar yang telah terenkripsi menggunakan nilai tersebut. </p>\n<p>Kita abaikan saja teknis bagaimana nilai <code class=\"language-text\">x0</code> didistribusikan. Asumsi kita pada skenario ini adalah untuk setiap <em>request</em> ke <em>encryption oracle</em>, nilai <code class=\"language-text\">x0</code> akan berubah-ubah dan bersifat acak.</p>\n<p>Karena <em>repeated keystream</em> sudah tidak bisa dieksploitasi, maka akan sulit untuk kita mendapatkan <em>keystream</em> dari <em>chosen-plain image attack</em>, karena <em>basically</em> enkripsi ini menjadi <em>One-Time Pad</em>.  </p>\n<h3 id=\"recover-acm-secret\"><a href=\"#recover-acm-secret\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recover ACM secret</h3>\n<p>Lalu bagaimana kita dapat mencari nilai <code class=\"language-text\">p</code> dan <code class=\"language-text\">q</code> tanpa mengetahui <em>keystream</em> yang digunakan?</p>\n<p>Disinilah celah keamanan dari penggunaan ”<strong>enkripsi selektif</strong>” terjadi, dimana <em>cipher image</em> membocorkan informasi dari LSB <em>plain image</em>-nya.</p>\n<p>Asumsikan kita menggunakan <em>chosen-plain image</em> yang direpresentasikan sebagai berikut.</p>\n$$\n\\begin{pmatrix}\n0 & 255 & 0 & 0 \\\\\n0 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 0 \\\\\n\\end{pmatrix}\n$$\n<p>Masukkan <em>plain image</em> tersebut ke <em>encryption oracle</em>. Kemudian, dimisalkan didapatkan <em>cipher image</em> sebagai berikut.</p>\n$$\n\\begin{pmatrix}\n32 & 96 & 176 & 32 \\\\\n112 & 240 & 112 & 144 \\\\\n32 & 95 & 192 & 80 \\\\\n176 & 208 & 48 & 160 \\\\\n\\end{pmatrix}\n$$\n<p>Kita ubah masing-masing pixel ke representasi <em>binary</em> dan boom!! <em>LSB oracle goes brrrr!</em></p>\n$$\n\\begin{pmatrix}\n00100000 & 01100000 & 10110000 & 00100000 \\\\\n01110000 & 11110000 & 01110000 & 10010000 \\\\\n00100000 & 01011111 & 11000000 & 01010000 \\\\\n10110000 & 11010000 & 00110000 & 10100000 \\\\\n\\end{pmatrix}\n$$\n<p>Karena skema enkripsi selektif tersebut, kita masih mengetahui posisi koordinat pixel kita setelah dipermutasi karena 4-bit LSB dari <em>plain image</em> tidak pernah berubah (cukup perhatikan 4-bit LSB yang tidak bernilai <code class=\"language-text\">0000</code>).</p>\n<p>Tinggal lanjutkan menggunakan metode yang sama seperti skenario sebelumnya dengan menyelesaikan sistem persamaan dua variabel untuk mendapatkan nilai <code class=\"language-text\">p</code> dan <code class=\"language-text\">q</code> (nilai <code class=\"language-text\">m</code> masih bisa didapatkan melalui <em>Timing Attack</em>).</p>\n<p>Selanjutnya, bagaimana kita dapat mencari nilai <em>keystream</em> yang dinamis? Sedangkan <em>One-Time Pad</em> merupakan <em>unbreakable cipher</em>.</p>\n<h3 id=\"weak-logistic-map\"><a href=\"#weak-logistic-map\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Weak Logistic Map</h3>\n<p>Satu-satunya hal yang bisa kita coba eksploitasi adalah dari implementasi <em>Logistic Map</em>-nya.</p>\n<p>Analisis mengenai bagaimana <em>Logistic Map</em> bekerja dijelaskan secara detail oleh blog dari <u>geoffboeing.com</u> <sup><a href=\"#references\">[2]</a></sup>. Menariknya, ada beberapa hal yang dapat membuat hasil distribusi dari <em>Logistic Map</em> repititif dan periodik jika konstanta <code class=\"language-text\">r</code> dan nilai awal <code class=\"language-text\">x0</code> tidak dipilih secara hati-hati.</p>\n<p>Mari kita coba lakukan sedikit eksperimen menggunakan implementasi <em>Logistic Map</em> dari artikel ini dalam membangkitkan <em>keystream</em>.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> random\n<span class=\"token keyword\">import</span> encryption\n\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    init <span class=\"token operator\">=</span> random<span class=\"token punctuation\">.</span>random<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    r <span class=\"token operator\">=</span> random<span class=\"token punctuation\">.</span>randint<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> random<span class=\"token punctuation\">.</span>random<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'x0:'</span><span class=\"token punctuation\">,</span> init<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'r :'</span><span class=\"token punctuation\">,</span> r<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'keystream'</span><span class=\"token punctuation\">,</span> encryption<span class=\"token punctuation\">.</span>logistic_map<span class=\"token punctuation\">(</span>init<span class=\"token punctuation\">,</span> r<span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Jalankan script diatas dan kita coba ambil beberapa sampel hasil yang menarik.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">x0: 0.7244972999777215\nr : 2.2929146462509595\nkeystream: [7, 2, 15, 3, 5, 14, 0, 9, 1, 15, 7, 10, 0, 11, 10, 14, 6, 4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]\n\nx0: 0.18893176526337663\nr : 1.6653541535673568\nkeystream: [4, 9, 3, 1, 9, 7, 10, 8, 15, 15, 11, 7, 2, 15, 6, 12, 0, 8, 5, 15, 8, 11, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12]\n\nx0: 0.8927173285063715\nr : 3.5157732279084075\nkeystream: [5, 13, 12, 12, 14, 5, 4, 0, 8, 0, 5, 8, 10, 0, 2, 11, 9, 0, 9, 7, 15, 2, 5, 14, 1, 2, 10, 15, 14, 11, 9, 15, 0, 9, 15, 7, 7, 13, 15, 1, 3, 11, 0, 2, 2, 1, 0, 15, 13, 2, 6, 15, 4, 8, 4, 12, 0, 2, 12, 1, 5, 6, 6, 12, 8, 0, 10, 5, 8, 15, 4, 10, 0, 4, 1, 4, 9, 1, 2, 0, 6, 8, 2, 1, 7, 5, 2, 1, 6, 6, 2, 1, 7, 6, 2, 1, 6, 6, 2, 1, 7, 6, 2, 1, 6, 6, 2, 1, 6, 6, 2, 1, 6, 6, 2, 1, 6, 6, 2, 1, 6, 6, 2, 1, 6, 6, 2, 1, 6, 6, 2, 1, 6, 6, 2, 1, 6, 6, 2, 1, 6, 6, 2, 1, 6, 6, 2, 1, 6, 6, 2, 1]</code></pre></div>\n<p>Dapat kita lihat, dari generasi <em>keystream</em> hasil diatas, hasil dari <em>Logistic Map</em> menghasilkan deret yang benar-benar repetitif secara statis dan periodik.</p>\n<p>Dari eksperimen tersebut, dapat kita catat nilai mana saja pada konstanta <code class=\"language-text\">r</code> yang menyebabkan <em>keystream</em> yang repetitif.</p>\n<p>Daftar konstanta <code class=\"language-text\">r</code> yang berpotensi menghasilkan <em>keystream</em> statis adalah:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">1.1 ~ 2.4\n2.6 ~ 2.8\n3.3</code></pre></div>\n<p>Sedangkan, daftar konstanta <code class=\"language-text\">r</code> yang berpotensi menghasilkan <em>keystream</em> periodik adalah:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">2.5\n2.9\n3.1\n3.2\n3.4\n3.5</code></pre></div>\n<p>Dari dua fenomena diatas, dapat disimpulkan bahwa ruang kunci dalam memilih konstanta <code class=\"language-text\">r</code> semakin terbatas untuk menghindari adanya repetisi <em>keystream</em> tersebut baik repetisi statis maupun periodik.</p>\n<p>Sehingga konstanta <code class=\"language-text\">r</code> yang mungkin dipilih untuk menghindari repetisi adalah dengan memilih salah satu dari nilai berikut.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">1.0~\n3.0~\n3.6~\n3.7~\n3.8~\n3.9~</code></pre></div>\n<blockquote>\n<p>Untuk nilai 0.9 kebawah diabaikan karena setelah beberapa proses generasi, nilainya akan cenderung menuju 0, sehingga tidak mampu membangkitkan <em>keystream</em> dengan ukuran besar.</p>\n</blockquote>\n<p>Jadi, untuk mendapatkan <em>keystream</em> dinamis dari <em>Logistic Map</em>, pertama kita cek apakah terdapat repetisi pada pixel-pixel <em>cipher image</em>-nya (terutama pada koordinat bawah). Untuk repetisi statis, kita cukup melakukan <em>brute-force</em> 1 dari 16 kemungkinan nilai saja, sedangkan untuk repetisi periodik, kita cukup melakukan <em>brute-force</em> 2 sampai 4 dari 16 kemungkinan nilai.</p>\n<p>Sedangkan jika tidak terdapat tanda adanya repetisi bit <em>keystream</em>, kita dapat melakukan <em>brute-force</em> untuk mencari nilai konstanta <code class=\"language-text\">r</code> dari kemungkinan daftar nilai yang tidak mengakibatkan repetisi tadi beserta nilai awal <code class=\"language-text\">x0</code>.</p>\n<h3 id=\"proof-of-concept-1\"><a href=\"#proof-of-concept-1\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Proof of Concept</h3>\n<p>Implementasi lengkap dari skenario ini dapat dilihat di <a href=\"https://github.com/Merricx/chaos-image-encryption\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">link ini</a></p>\n<h1 id=\"conclusion\"><a href=\"#conclusion\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Conclusion</h1>\n<p>Dari kedua skenario implementasi diatas, dapat disimpulkan bahwa skema kriptosistem berbasis <em>chaos</em> ini benar-benar rentan terhadap <em>Chosen-Plain image Attack</em> (<em>Known-Plain image Attack</em> juga dapat dilakukan di beberapa kondisi). </p>\n<p>Baik fungsi <em>Arnold’s Cat Map</em>, <em>Logistic Map</em>, maupun penggunaan enkripsi selektif yang digunakan terdapat celah keamanan yang dapat membuat <em>attacker</em> mendekripsi gambar apapun yang terenkripsi tanpa akses ke <em>secret key</em> yang digunakan. Sehingga pengembangan lebih lanjut perlu dilakukan untuk dapat menghasilkan algoritma yang lebih baik lagi, khususnya dalam segi keamanan.</p>\n<h1 id=\"references\"><a href=\"#references\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>References</h1>\n<ol>\n<li>Munir, Rinaldi. (2012). ANALISIS KEAMANAN ALGORITMA ENKRIPSI CITRA DIGITAL MENGGUNAKAN KOMBINASI DUA CHAOS MAP DAN PENERAPAN TEKNIK SELEKTIF. JUTI: Jurnal Ilmiah Teknologi Informasi. 10. 89. 10.12962/j24068535.v10i2.a310.  </li>\n<li><a href=\"https://geoffboeing.com/2015/03/chaos-theory-logistic-map/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://geoffboeing.com/2015/03/chaos-theory-logistic-map/</a></li>\n</ol>","timeToRead":16,"frontmatter":{"title":"Don't Roll Your Own Crypto #1","date":"July 28, 2021","spoiler":"The series of cryptanalyzing encryption scheme from local academic paper or article. This first series will discuss about cryptanalysis of image encryption based on Chaos function.","cta":null},"fields":{"slug":"/id/dont-roll-your-own-crypto-1/","langKey":"id"}}},"pageContext":{"slug":"/id/dont-roll-your-own-crypto-1/","translations":["id"],"translatedLinks":[]}},"staticQueryHashes":["336482444"]}